
if(typeof DayPilot==='undefined'){var DayPilot={};};if(typeof DayPilotScheduler==='undefined'){var DayPilotScheduler=DayPilot.SchedulerVisible={};};(function(){if(typeof DayPilot.Scheduler!=='undefined'){return;};var DayPilotScheduler={};var $a=function(){};DayPilotScheduler.moving=null;DayPilotScheduler.originalTop=null;DayPilotScheduler.originalMouse=null;DayPilotScheduler.originalWidth=null;DayPilotScheduler.originalLeft=null;DayPilotScheduler.resizing=null;DayPilotScheduler.globalHandlers=false;DayPilotScheduler.selectedCells=null;DayPilotScheduler.dragStart=function(element,$b,id,$c,$d){DayPilot.us(element);var $e=DayPilotScheduler.drag={};$e.element=element;$e.duration=$b;$e.text=$c;$e.id=id;$e.shadowType=$d?$d:'Fill';return false;};DayPilotScheduler.dragStop=function(){if(DayPilotScheduler.gShadow){document.body.removeChild(DayPilotScheduler.gShadow);DayPilotScheduler.gShadow=null;};DayPilotScheduler.drag=null;};DayPilotScheduler.register=function($f){if(!DayPilotScheduler.registered){DayPilotScheduler.registered=[];};for(var i=0;i<DayPilotScheduler.registered.length;i++){if(DayPilotScheduler.registered[i]===$f){return;}};DayPilotScheduler.registered.push($f);};DayPilotScheduler.unregister=function($f){var a=DayPilotScheduler.registered;if(!a){return;};var $g=function($h,$i){if(!$h||!$h.length){return -1;};for(var i=0;i<$h.length;i++){if($h[i]===$i){return i;}};return -1;};var i=$g(a,$f);if(i===-1){return;};a.splice(i,1);};DayPilotScheduler.gMouseMove=function(ev){if(typeof(DayPilotScheduler)==='undefined'){return;};ev=ev||window.event;if(ev.insideMainD){return;}else if(ev.srcElement){if(ev.srcElement.inside){return;}};var $j=DayPilot.mc(ev);if(DayPilotScheduler.drag){document.body.style.cursor='move';if(!DayPilotScheduler.gShadow){DayPilotScheduler.gShadow=DayPilotScheduler.createGShadow(DayPilotScheduler.drag.shadowType);};var $k=DayPilotScheduler.gShadow;$k.style.left=$j.x+'px';$k.style.top=$j.y+'px';DayPilotScheduler.moving=null;DayPilot.de(DayPilotScheduler.movingShadow);DayPilotScheduler.movingShadow=null;}else if(DayPilotScheduler.moving&&DayPilotScheduler.moving.event.calendar.dragOutAllowed&&!DayPilotScheduler.drag){var $l=DayPilotScheduler.moving.event.calendar;var ev=DayPilotScheduler.moving.event;DayPilotScheduler.moving.target=null;document.body.style.cursor='move';if(!DayPilotScheduler.gShadow){DayPilotScheduler.gShadow=DayPilotScheduler.createGShadow($l.shadow);};var $k=DayPilotScheduler.gShadow;$k.style.left=$j.x+'px';$k.style.top=$j.y+'px';DayPilotScheduler.drag={};var $e=DayPilotScheduler.drag;$e.element=null;$e.duration=(ev.end().getTime()-ev.start().getTime())/1000;$e.text=ev.text();$e.id=ev.value();$e.shadowType=$l.shadow;$e.event=ev;DayPilot.de(DayPilotScheduler.movingShadow);DayPilotScheduler.movingShadow=null;};for(var i=0;i<DayPilotScheduler.registered.length;i++){if(DayPilotScheduler.registered[i].out){DayPilotScheduler.registered[i].out();}}};DayPilotScheduler.gUnload=function(ev){if(!DayPilotScheduler.registered){return;};for(var i=0;i<DayPilotScheduler.registered.length;i++){var c=DayPilotScheduler.registered[i];c.dispose();DayPilotScheduler.unregister(c);}};DayPilotScheduler.timeRangeTimeout=null;DayPilotScheduler.gMouseUp=function(ev){if(DayPilotScheduler.resizing){if(!DayPilotScheduler.resizingShadow){document.body.style.cursor='default';DayPilotScheduler.resizing=null;return;};var e=DayPilotScheduler.resizing.event;var $f=e.calendar;var $m=DayPilotScheduler.resizingShadow.clientWidth+4;var $n=DayPilotScheduler.resizingShadow.offsetLeft;var $o=DayPilotScheduler.resizing.dpBorder;var $p=$f.rows[DayPilotScheduler.resizing.data.part.dayIndex];var $q=$p.Start.getTime()-$f.startDate.getTime();var $r=null;var $s=null;if($o==='left'){$r=$f.getDate($n).addTime($q);$s=e.end();}else if($o==='right'){$r=e.start();$s=$f.getDate($n+$m,false,true).addTime($q);};DayPilot.de(DayPilotScheduler.resizingShadow);DayPilotScheduler.resizing=null;DayPilotScheduler.resizingShadow=null;document.body.style.cursor='default';$f.eventResizeDispatch(e,$r,$s);}else if(DayPilotScheduler.moving){if(!DayPilotScheduler.movingShadow){document.body.style.cursor='default';DayPilotScheduler.moving=null;return;};var e=DayPilotScheduler.moving.event;var $f=DayPilotScheduler.moving.target;if(!$f){DayPilot.de(DayPilotScheduler.movingShadow);document.body.style.cursor='default';DayPilotScheduler.moving=null;return;};var $r=DayPilotScheduler.movingShadow.start;var $s=DayPilotScheduler.movingShadow.end;var $t=($f.viewType==='Resources')?DayPilotScheduler.movingShadow.row.Value:null;var external=DayPilotScheduler.drag?true:false;DayPilot.de(DayPilotScheduler.movingShadow);document.body.style.cursor='default';DayPilotScheduler.moving=null;DayPilotScheduler.movingShadow=null;if(DayPilotScheduler.drag){if(!$f.todo){$f.todo={};};$f.todo.del=DayPilotScheduler.drag.element;};var ev=ev||window.event;$f.eventMoveDispatch(e,$r,$s,$t,external,ev);}else if(DayPilotScheduler.range){ev=ev||window.event;var $u=ev.which||ev.button;var $v=DayPilotScheduler.range;var $f=$v.calendar;if(DayPilotScheduler.timeRangeTimeout){clearTimeout(DayPilotScheduler.timeRangeTimeout);DayPilotScheduler.timeRangeTimeout=null;$f.onMaindDblClick(ev);return;};DayPilotScheduler.rangeHold=$v;DayPilotScheduler.range=null;var $w=function($x){return function(){DayPilotScheduler.timeRangeTimeout=null;$f.timeRangeSelectedDispatch($x.start,$x.end,$x.resource);if($f.timeRangeSelectedHandling!=="Hold"&&$f.timeRangeSelectedHandling!=="HoldForever"){$a();}else{DayPilotScheduler.rangeHold=$v;}};};var $x=$f.getSelection($v);if($u!=1){DayPilotScheduler.timeRangeTimeout=null;return;};if($f.timeRangeDoubleClickHandling==='Disabled'){$w($x)();var ev=ev||window.event;ev.cancelBubble=true;return false;}else{DayPilotScheduler.timeRangeTimeout=setTimeout($w($x),300);}};if(DayPilotScheduler.drag){DayPilotScheduler.drag=null;document.body.style.cursor=null;};if(DayPilotScheduler.gShadow){document.body.removeChild(DayPilotScheduler.gShadow);DayPilotScheduler.gShadow=null;};DayPilotScheduler.moveOffsetX=null;DayPilotScheduler.moveDragStart=null;};DayPilotScheduler.createShadow=function($i,$d){var $k=document.createElement('div');$k.setAttribute('unselectable','on');$k.style.position='absolute';$k.style.fontSize='1px';$k.style.border='2px dotted #666666';if($d==='Fill'){$k.style.backgroundColor="#aaaaaa";$k.style.opacity=0.5;$k.style.filter="alpha(opacity=50)";$k.style.border='2px solid #aaaaaa';};var $y=Math.max($i.offsetWidth-4,0);$k.style.width=$y+'px';var $z=Math.max($i.offsetHeight-4,0);$k.style.height=$z+'px';$k.style.left=$i.offsetLeft+'px';$k.style.top=$i.offsetTop+'px';$i.parentNode.appendChild($k);return $k;};DayPilotScheduler.createGShadow=function($d){var $k=document.createElement('div');$k.setAttribute('unselectable','on');$k.style.position='absolute';$k.style.width='100px';$k.style.height='20px';$k.style.border='2px dotted #666666';$k.style.zIndex=101;if($d==='Fill'){$k.style.backgroundColor="#aaaaaa";$k.style.opacity=0.5;$k.style.filter="alpha(opacity=50)";$k.style.border='2px solid #aaaaaa';};document.body.appendChild($k);return $k;};DayPilotScheduler.Scheduler=function(id){var $f=this;this.id=id;this.allowMultiSelect=true;this.autoRefreshCommand='refresh';this.autoRefreshEnabled=false;this.autoRefreshInterval=60;this.autoRefreshMaxCount=20;this.autoScroll="Drag";this.borderColor="#000000";this.businessBeginsHour=9;this.businessEndsHour=18;this.cellBackColor="#FFFFD5";this.cellBackColorNonBusiness="#FFF4BC";this.cellBorderColor="#EAD098";this.cellDuration=60;this.cellGroupBy='Day';this.cellSelectColor="#316AC5";this.cellWidth=20;this.clientSide=true;this.crosshairColor='Gray';this.crosshairOpacity=20;this.crosshairType='Header';this.debuggingEnabled=false;this.dragOutAllowed=false;this.durationBarColor='blue';this.durationBarHeight=3;this.durationBarVisible=true;this.days=1;this.dynamicEventRendering='Progressive';this.dynamicEventRenderingMargin=50;this.dynamicLoading=false;this.eventBorderColor="#000000";this.eventBorderVisible=true;this.eventBackColor="#FFFFFF";this.eventFontFamily="Tahoma, Arial";this.eventFontSize='8pt';this.eventFontColor='#000000';this.eventHeight=20;this.eventMoveMargin=5;this.eventResizeMargin=5;this.headerFontColor="#000000";this.headerFontFamily="Tahoma, Arial";this.headerFontSize='8pt';this.headerHeight=20;this.heightSpec='Auto';this.hourFontFamily="Tahoma, Arial";this.hourFontSize='10pt';this.hourNameBackColor="#ECE9D8";this.hourNameBorderColor="#ACA899";this.layout='Auto';this.loadingLabelText="Loading...";this.loadingLabelVisible=true;this.loadingLabelBackColor="orange";this.loadingLabelFontColor="#ffffff";this.loadingLabelFontFamily="Tahoma";this.loadingLabelFontSize="10pt";this.moveBy='Top';this.numberFormat="0.00";this.rowHeaderWidth=80;this.rowHeaderCols=null;this.rowMarginBottom=0;this.rowMinHeight=0;this.scrollX=0;this.scrollY=0;this.shadow="Fill";this.showNonBusiness=true;this.showToolTip=true;this.snapToGrid=true;this.startDate=new DayPilot.Date().getDatePart();this.syncResourceTree=true;this.timeBreakColor='#000000';this.treeEnabled=false;this.treeIndent=20;this.treeImageMarginLeft=2;this.treeImageMarginTop=2;this.useEventBoxes='Always';this.viewType='Resources';this.weekStarts=1;this.width='100%';this.eventCorners='Regular';;this.separators=[];this.afterRender=function(){};this.cornerHTML='';this.crosshairLastY=-1;this.crosshairLastX=-1;this.eventClickHandling='Disabled';this.eventHoverHandling='Bubble';this.eventDoubleClickHandling='Disabled';this.eventEditHandling='Disabled';this.eventMoveHandling='Disabled';this.eventResizeHandling='Disabled';this.eventRightClickHandling='Disabled';this.resourceHeaderClickHandling='Disabled';this.timeRangeDoubleClickHandling='Disabled';this.timeRangeSelectedHandling='Disabled';this.backendUrl=null;this.onEventMove=function(){};this.onEventResize=function(){};this.onResourceExpand=function(){};this.onResourceCollapse=function(){};this.debugMessages=[];this.autoRefreshCount=0;this.rows=[];this.timeline=[];this.groupline=[];this.events={};this.elements={};this.elements.events=[];this.elements.cells=[];this.elements.separators=[];this.elements.range=[];this.elements.breaks=[];this.cache={};this.cache.cells=[];this.cache.timeHeaderGroups=[];this.cache.pixels=[];this.cache.breaks=[];this.clientState={};this.nav={};this.updateView=function($A,$B){var $A=eval("("+$A+")");if($A.BubbleGuid){var $C=$A.BubbleGuid;var $D=this.bubbles[$C];delete this.bubbles[$C];$f.loadingStop();$D.updateView($A.Result.BubbleHTML,$D);return;};if($A.UpdateType==="None"){$f.loadingStop();if($A.Message){$f.message($A.Message,5000);};return;};if($A.VsUpdate){var $E=document.createElement("input");$E.type='hidden';$E.name=$f.id+"_vsupdate";$E.id=$E.name;$E.value=$A.VsUpdate;$f.vsph.innerHTML='';$f.vsph.appendChild($E);};if($A.UpdateType==="Full"){$f.resources=$A.Resources;$f.colors=$A.Colors;$f.palette=$A.Palette;$f.dirtyColors=$A.DirtyColors;$f.cellProperties=$A.CellProperties;$f.separators=$A.Separators;$f.timeHeader=$A.TimeHeader;$f.timeHeaders=$A.TimeHeaders;$f.startDate=$A.StartDate?new DayPilot.Date($A.StartDate):$f.startDate;$f.days=$A.Days?$A.Days:$f.days;$f.cellDuration=$A.CellDuration?$A.CellDuration:$f.cellDuration;$f.cellGroupBy=$A.CellGroupBy?$A.CellGroupBy:$f.cellGroupBy;$f.cellWidth=$A.CellWidth?$A.CellWidth:$f.cellWidth;$f.viewType=$A.ViewType?$A.ViewType:$f.viewType;$f.hourNameBackColor=$A.HourNameBackColor?$A.HourNameBackColor:$f.hourNameBackColor;$f.showNonBusiness=$A.ShowNonBusiness?$A.ShowNonBusiness:$f.showNonBusiness;$f.businessBeginsHour=$A.BusinessBeginsHour?$A.BusinessBeginsHour:$f.businessBeginsHour;$f.businessEndsHour=$A.BusinessEndsHour?$A.BusinessEndsHour:$f.businessEndsHour;if(typeof $A.DynamicLoading!='undefined')$f.dynamicLoading=$A.DynamicLoading;if(typeof $A.TreeEnabled!=='undefined')$f.treeEnabled=$A.TreeEnabled;$f.backColor=$A.BackColor?$A.BackColor:$f.backColor;$f.nonBusinessBackColor=$A.NonBusinessBackColor?$A.NonBusinessBackColor:$f.nonBusinessBackColor;$f.locale=$A.Locale?$A.Locale:$f.locale;$f.timeFormat=$A.TimeFormat?$A.TimeFormat:$f.timeFormat;$f.rowHeaderCols=$A.RowHeaderCols?$A.RowHeaderCols:$f.rowHeaderCols;$f.cornerBackColor=$A.CornerBackColor?$A.CornerBackColor:$f.cornerBackColor;$f.cornerHTML=$A.CornerHTML?$A.CornerHTML:$f.cornerHTML;$f.hashes=$A.Hashes;$f.prepareTimeline();$f.prepareGroupline();$f.calculateCellWidth();$f.loadResources();};$f.events.list=[];$f.loadEvents($A.Events);if(typeof $A.TagFields!=='undefined'){$f.tagFields=$A.TagFields;};if($A.UpdateType==='Full'){$f.drawResHeader();$f.drawTimeHeader();};$f.prepareRowTops();$f.updateRowHeaderHeights();$f.updateHeaderHeight();if($f.heightSpec==='Auto'||$f.heightSpec==='Max'){$f.updateHeight();};$f.deleteCells();$f.deleteEvents();$f.deleteSeparators();$f.multiselect.clear(true);$f.multiselect.initList=$A.SelectedEvents;$f.drawCells();$f.drawSeparators();$f.drawEvents();if($f.timeRangeSelectedHandling!=="HoldForever"){$f.deleteRange();};if($A.UpdateType==="Full"){$f.setScroll($A.ScrollX,$A.ScrollY);$f.saveState();};if($f.todo){if($f.todo.del){var $F=$f.todo.del;$F.parentNode.removeChild($F);$f.todo.del=null;}};$f.afterRender($A.CallBackData,true);$f.loadingStop();if($A.UpdateType==='Full'&&navigator.appVersion.indexOf("MSIE 7.")!=-1){window.setTimeout(function(){$f.updateHeight();},0);};$f.startAutoRefresh();if($A.Message){if($f.message){$f.message($A.Message,5000);}}};this.scrollTo=function($G){var $H=this.getPixels(new DayPilot.Date($G)).left;this.setScroll($H,scrollY);};this.setScroll=function(scrollX,scrollY){var scroll=$f.nav.scroll;var $I=$f.innerHeightTree;var $J=$f.cellCount()*$f.cellWidth;if(scroll.clientWidth+scrollX>$J){scrollX=$J-scroll.clientWidth;};if(scroll.clientHeight+scrollY>$I){scrollY=$I-scroll.clientHeight;};$f.divTimeScroll.scrollLeft=scrollX;$f.divResScroll.scrollTop=scrollY;scroll.scrollLeft=scrollX;scroll.scrollTop=scrollY;};this.rounded=function(){return this.eventCorners=='Rounded';};this.message=function($K,$L,$M,$N){if($K===null){return;};var $L=$L||2000;var $M=$M||"#ffffff";var $N=$N||"#000000";var $O=0.8;var top=this.getTotalHeaderHeight()+1;var $P=this.getTotalRowHeaderWidth()+1;var $Q=DayPilot.sw($f.nav.scroll)+1;var $R;if(!this.nav.message){$R=document.createElement("div");$R.style.position="absolute";$R.style.width="100%";$R.style.left="0px";$R.style.textAlign="left";$R.style.top=top+"px";$R.style.opacity=$O;$R.style.filter="alpha(opacity="+($O*100)+")";$R.style.display='none';var $S=document.createElement("div");$S.style.marginLeft=$P+"px";$S.style.marginRight=$Q+"px";$S.style.padding="5px";$R.appendChild($S);var close=document.createElement("div");close.style.top="5px";close.style.right=(DayPilot.sw($f.nav.scroll)+5)+"px";close.style.color=$M;close.style.lineHeight="100%";close.style.position="absolute";close.style.cursor="pointer";close.style.fontWeight="bold";close.innerHTML="X";close.onclick=function(){$f.nav.message.style.display='none';};$R.appendChild(close);this.nav.top.appendChild($R);this.nav.message=$R;};var $T=function(){$f.nav.message.style.opacity=$O;var $S=$f.nav.message.firstChild;$S.style.backgroundColor=$N;$S.style.color=$M;$S.innerHTML=$K;var end=function(){$f.messageTimeout=setTimeout($f.hideMessage,$L);};DayPilot.fade($f.nav.message,0.2,end);};if(this.nav.message.style.display!=='none'){clearTimeout($f.messageTimeout);DayPilot.fade($f.nav.message,-0.2,$T);}else{$T();}};this.hideMessage=function(){var end=function(){$f.nav.message.style.display='none';};DayPilot.fade($f.nav.message,-0.2,end);};this.getLayout=function(){var $U=/MSIE 6/i.test(navigator.userAgent);if(this.layout==='Auto'){if($U){return 'TableBased';}else{return 'DivBased';}};return this.layout;};this.updateHeight=function(){if(this.nav.scroll){if(this.heightSpec==='Parent100Pct'){this.height=parseInt(this.nav.top.clientHeight,10)-(this.getTotalHeaderHeight()+2);};var $z=this.getScrollableHeight();this.nav.scroll.style.height=$z+'px';this.scrollRes.style.height=$z+'px';if(this.heightSpec!=="Parent100Pct"){this.nav.top.style.height=($z+this.getTotalHeaderHeight())+"px";};for(var i=0;i<this.elements.separators.length;i++){this.elements.separators[i].style.height=this.innerHeightTree+'px';}}};this.prepareTimeline=function(){this.endDate=(this.viewType==='Resources')?this.startDate.addDays(this.days):this.startDate.addDays(1);this.timeline=[];this.cache.pixels=[];if(this.timeHeader){var $V=this.startDate.getTime();var $p=this.timeHeader[this.timeHeader.length-1];for(var i=0;i<$p.length;i++){var h=$p[i];var $W={};$W.start=new DayPilot.Date(h.start);$W.end=new DayPilot.Date(h.end);$W.breakBefore=$W.start.getTime()!==$V;this.timeline.push($W);$V=$W.end.getTime();};return;};var $X=this.startDate;var end=$X.addMinutes(this.cellDuration);var $Y=false;while(end.getTime()<=this.endDate.getTime()){if(this.includeCell($X,end)){var $W={};$W.start=$X;$W.end=end;$W.breakBefore=$Y;this.timeline.push($W);$Y=false;}else{$Y=true;};$X=end;end=$X.addMinutes(this.cellDuration);}};this.prepareGroupline=function(){this.groupline=[];var $Z=this.endDate;var $00={};var $X=this.startDate;while($X.getTime()<$Z.getTime()){var $00={};$00.start=$X;$00.end=this.addGroupSize($00.start);$00.left=this.getPixels($00.start).left;$00.width=this.getPixels($00.end).left-$00.left;if($00.width>0){this.groupline.push($00);};$X=$00.end;}};this.includeCell=function($X,end){if(this.showNonBusiness){return true;};if($X.d.getUTCDay()===0){return false;};if($X.d.getUTCDay()===6){return false;};if(this.cellDuration<60*24){var $01=$X.d.getUTCHours();$01+=$X.d.getUTCMinutes()/60.0;$01+=$X.d.getUTCSeconds()/3600.0;$01+=$X.d.getUTCMilliseconds()/3600000.0;if($01<this.businessBeginsHour){return false;};if(this.businessEndsHour>=24){return true;};if($01>=this.businessEndsHour){return false;}};return true;};this.getPixels=function($G){var $02=$G.getTime();var $03=this.cache.pixels[$02];if($03){return $03;};var $04=null;var $05=221876841600000;if(this.timeline.length===0||$02<this.timeline[0].start.getTime()){var $A={};$A.cut=false;$A.left=0;$A.boxLeft=$A.left;$A.boxRight=$A.left;return $A;};for(var i=0;i<this.timeline.length;i++){var $06=false;var $00=this.timeline[i];var $07=$00.start.getTime();var $08=$00.end.getTime();if($07<$02&&$02<$08){var $09=$02-$07;var $A={};$A.cut=false;$A.left=i*this.cellWidth+this.ticksToPixels($09);$A.boxLeft=i*this.cellWidth;$A.boxRight=(i+1)*this.cellWidth;break;}else if($07===$02){var $A={};$A.cut=false;$A.left=i*this.cellWidth;$A.boxLeft=$A.left;$A.boxRight=$A.left;break;}else if($08===$02){var $A={};$A.cut=false;$A.left=(i+1)*this.cellWidth;$A.boxLeft=$A.left;$A.boxRight=$A.left;break;}else if($02<$07&&$02>$05){var $A={};$A.cut=true;$A.left=i*this.cellWidth;$A.boxLeft=$A.left;$A.boxRight=$A.left;break;};$05=$08;};if(!$A){var $A={};$A.cut=true;$A.left=(this.timeline.length)*this.cellWidth;$A.boxLeft=$A.left;$A.boxRight=$A.left;};this.cache.pixels[$02]=$A;return $A;};this.getPixels2=function($G){var $A={};if(this.timeline.length<=0){return 0;};var i=0;while($G.getTime()>this.timeline[i].end.getTime()){i++;if(this.timeline[i]===null){$A.cut=true;$A.left=(this.timeline.length)*this.cellWidth;$A.boxLeft=$A.left;return $A;}};if($G.getTime()<this.timeline[i].start.getTime()){$A.cut=true;}else{$A.cut=false;};var $P=i*this.cellWidth;$A.boxLeft=$P;$A.boxRight=$A.cut?$P:$P+this.cellWidth;var $09=$G.getTime()-this.timeline[i].start.getTime();if($09<0){$09=0;};$P+=this.ticksToPixels($09);$A.left=$P;return $A;};this.getDate=function($P,$0a,$0b){var x=Math.floor($P/this.cellWidth);var $0c=($0b&&x>0)?x-1:x;if(this.timeline[$0c]===null){return null;};var $X=($0b&&x>0)?this.timeline[x-1].end:this.timeline[x].start;if(!$0a){return $X;}else{var $09=$P%this.cellWidth;return $X.addTime(this.pixelsToTicks($09));}};this.ticksToPixels=function($02){return Math.floor((this.cellWidth*$02)/(1000*60*this.cellDuration));};this.pixelsToTicks=function($H){return Math.floor($H*(this.cellDuration/this.cellWidth)*60*1000);};this.eventClickPostBack=function(e,$0d){this.postBack2('EventClick',e,$0d);};this.eventClickCallBack=function(e,$0d){this.callBack2('EventClick',e,$0d);};this.eventClickDispatch=function(ev){var e=this.event;var $0d=this.data;var $R=this;var ev=ev||window.event;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if(!$0d.client.doubleClickEnabled()){$f.eventClickSingle($R,ev.ctrlKey);return;};if(!$f.timeouts){$f.timeouts=[];};var $0e=function($R,$0f){return function(){$f.eventClickSingle($R,$0f);};};$f.timeouts.push(window.setTimeout($0e($R,ev.ctrlKey),300));};this.eventClickSingle=function($R,$0f){var e=$R.event;var $0d=$R.data;if(!$0d.client.clickEnabled()){return;};switch($f.eventClickHandling){case 'PostBack':$f.eventClickPostBack(e);break;case 'CallBack':$f.eventClickCallBack(e);break;case 'JavaScript':$f.onEventClick(e);break;case 'Edit':$f.divEdit($R);break;case 'Select':$f.eventSelect($R,e,$0f);break;case 'ContextMenu':var $0g=e.client.contextMenu();if($0g){$0g.show(e);}else{if($f.contextMenu){$f.contextMenu.show(e);}};break;case 'Bubble':if($f.bubble){$f.bubble.showEvent(e);};break;}};this.setHScrollPosition=function($H){this.nav.scroll.scrollLeft=$H;};this.getHScrollPosition=function(){return this.nav.scroll.scrollLeft;};this.getScrollX=this.getHScrollPosition;this.getScrollY=function(){return this.nav.scroll.scrollTop;};this.eventSelect=function($R,e,$0f){var m=$f.multiselect;m.previous=m.events();m.toggleDiv($R,$0f);var $0h=m.isSelected(e)?"selected":"deselected";$f.eventSelectDispatch(e,$0h);};this.eventSelectPostBack=function(e,$0h,$0d){var $0i={};$0i.e=e;$0i.change=$0h;this.postBack2('EventSelect',$0d,$0i);};this.eventSelectCallBack=function(e,$0h,$0d){var $0i={};$0i.e=e;$0i.change=$0h;this.callBack2('EventSelect',$0d,$0i);};this.eventSelectDispatch=function(e,$0h){switch($f.eventSelectHandling){case 'PostBack':$f.eventSelectPostBack(e,$0h);break;case 'CallBack':__theFormPostData="";__theFormPostCollection=[];if(WebForm_InitCallback){WebForm_InitCallback();};$f.eventSelectCallBack(e,$0h);break;case 'JavaScript':$f.onEventSelect(e,$0h);break;}};this.eventRightClickPostBack=function(e,$0d){this.postBack2('EventRightClick',e,$0d);};this.eventRightClickCallBack=function(e,$0d){this.callBack2('EventRightClick',e,$0d);};this.eventRightClickDispatch=function(ev){var e=this.event;ev=ev||window.event;ev.cancelBubble=true;if(!this.data.client.rightClickEnabled()){return false;};switch($f.eventRightClickHandling){case 'PostBack':$f.eventRightClickPostBack(e);break;case 'CallBack':$f.eventRightClickCallBack(e);break;case 'JavaScript':$f.onEventRightClick(e);break;case 'ContextMenu':var $0g=e.client.contextMenu();if($0g){$0g.show(e);}else{if($f.contextMenu){$f.contextMenu.show(this.event);}};break;};return false;};this.eventDoubleClickPostBack=function(e,$0d){this.postBack2('EventDoubleClick',e,$0d);};this.eventDoubleClickCallBack=function(e,$0d){this.callBack2('EventDoubleClick',e,$0d);};this.eventDoubleClickDispatch=function(ev){if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($f.timeouts){for(var $0j in $f.timeouts){window.clearTimeout($f.timeouts[$0j]);};$f.timeouts=null;};var ev=ev||window.event;var e=this.event;switch($f.eventDoubleClickHandling){case 'PostBack':$f.eventDoubleClickPostBack(e);break;case 'CallBack':$f.eventDoubleClickCallBack(e);break;case 'JavaScript':$f.onEventDoubleClick(e);break;case 'Edit':$f.divEdit(this);break;case 'Select':$f.eventSelect($R,e,ev.ctrlKey);break;case 'Bubble':if($f.bubble){$f.bubble.showEvent(e);};break;}};this.eventResizePostBack=function(e,$r,$s,$0d){this.invokeEventResize("PostBack",e,$r,$s,$0d);};this.eventResizeCallBack=function(e,$r,$s,$0d){this.invokeEventResize("CallBack",e,$r,$s,$0d);};this.invokeEventResize=function($d,e,$r,$s,$0d){var $0i={};$0i.e=e;$0i.newStart=$r;$0i.newEnd=$s;this.invokeEvent($d,"EventResize",$0i,$0d);};this.eventResizeDispatch=function(e,$r,$s){switch($f.eventResizeHandling){case 'PostBack':$f.eventResizePostBack(e,$r,$s);break;case 'CallBack':$f.eventResizeCallBack(e,$r,$s);break;case 'JavaScript':$f.onEventResize(e,$r,$s);break;case 'Notify':$f.eventResizeNotify(e,$r,$s);break;}};this.eventMovePostBack=function(e,$r,$s,$t,$0d){this.invokeEventMove("PostBack",e,$r,$s,$t,$0d);};this.eventMoveCallBack=function(e,$r,$s,$t,$0d){this.invokeEventMove("CallBack",e,$r,$s,$t,$0d);};this.invokeEventMove=function($d,e,$r,$s,$t,$0d){var $0i={};$0i.e=e;$0i.newStart=$r;$0i.newEnd=$s;$0i.newResource=$t;this.invokeEvent($d,"EventMove",$0i,$0d);};this.invokeEvent=function($d,$0k,$0i,$0d){if($d==='PostBack'){this.postBack2($0k,$0i,$0d);}else if($d==='CallBack'){this.callBack2($0k,$0i,$0d,"CallBack");}else if($d==='Immediate'){this.callBack2($0k,$0i,$0d,"Notify");}else if($d==='Queue'){this.queue.add(new DayPilotScheduler.Action(this,$0k,$0i,$0d));}else if($d==='Notify'){if(this.notifyType()=='Notify'){this.callBack2($0k,$0i,$0d,"Notify");}else{this.queue.add(new DayPilotScheduler.Action(this,$0k,$0i,$0d));}}else{throw "Invalid event invocation type";}};this.eventMoveNotify=function(e,$r,$s,$t,$0d){var $0l=$f.events.removeFromRows(e.data);e.start($r);e.end($s);e.resource($t);e.commit();$0l=$0l.concat($f.events.addToRows(e.data));$f.loadRows($0l);$f.updateRowHeights();$f.updateRowsNoLoad($0l);this.invokeEventMove("Notify",e,$r,$s,$t,$0d);};this.notifyType=function(){var $d;if(this.notifyCommit=='Immediate'){$d="Notify";}else if(this.notifyCommit=='Queue'){$d="Queue";}else{throw "Invalid notifyCommit value: "+this.notifyCommit;};return $d;};this.eventResizeNotify=function(e,$r,$s,$0d){var $0l=$f.events.removeFromRows(e.data);e.start($r);e.end($s);e.commit();$0l=$0l.concat($f.events.addToRows(e.data));$f.loadRows($0l);$f.updateRowHeights();$f.updateRowsNoLoad($0l);this.invokeEventResize("Notify",e,$r,$s,$0d);};this.multiselect={};this.multiselect.initList=[];this.multiselect.list=[];this.multiselect.divs=[];this.multiselect.previous=[];this.multiselect.serialize=function(){var m=$f.multiselect;return DayPilot.JSON.stringify(m.events());};this.multiselect.events=function(){var m=$f.multiselect;var $0m=[];$0m.ignoreToJSON=true;for(var i=0;i<m.list.length;i++){$0m.push(m.list[i]);};return $0m;};this.multiselect.updateHidden=function(){};this.multiselect.toggleDiv=function($R,$0n){var m=$f.multiselect;if(m.isSelected($R.event)){if($f.allowMultiSelect){if($0n){m.remove($R.event);}else{var $0o=m.list.length;m.clear(true);if($0o>1){m.add($R.event);}}}else{m.clear(true);}}else{if($f.allowMultiSelect){if($0n){m.add($R.event);}else{m.clear(true);m.add($R.event);}}else{m.clear(true);m.add($R.event);}};m.redraw();m.updateHidden();};this.multiselect.shouldBeSelected=function(e){if(!this.initList){return false;};for(var i=0;i<this.initList.length;i++){var ei=this.initList[i];if(ei.value!==null&&e.value()!==null&&ei.value===e.value()){return true;};if(ei.value===null&&e.value()===null&&ei.recurrentMasterId===e.recurrentMasterId()&&e.start().toStringSortable()===ei.start){return true;}};return false;};this.multiselect.alert=function(){var m=$f.multiselect;var $0p=[];for(var i=0;i<m.list.length;i++){var event=m.list[i];$0p.push(event.value());};alert($0p.join("\n"));};this.multiselect.add=function(ev){var m=$f.multiselect;if(m.indexOf(ev)==-1){m.list.push(ev);}};this.multiselect.remove=function(ev){var m=$f.multiselect;var i=m.indexOf(ev);if(i!=-1){m.list.splice(i,1);}};this.multiselect.clear=function($0q){var m=$f.multiselect;m.list=[];if($0q){return;};m.redraw();};this.multiselect.redraw=function(){var m=$f.multiselect;for(var i=0;i<$f.elements.events.length;i++){var $R=$f.elements.events[i];if(m.isSelected($R.event)){m.divSelect($R);}else{m.divDeselect($R);}}};this.multiselect.divSelect=function($R){var m=$f.multiselect;var cn=$f.applyCssClass("selected");var c=$R;if(c){if(c.className){if(c.className.indexOf(cn)==-1){c.className+=" "+cn;}}else{c.className=cn;}};m.divs.push($R);};this.multiselect.findContentDiv=function($R){for(var i=0;i<$R.childNodes.length;i++){var c=$R.childNodes[i];if(c.getAttribute("c")=="1"){return c;}};return null;};this.multiselect.divDeselectAll=function(){var m=$f.multiselect;for(var i=0;i<m.divs.length;i++){var $R=m.divs[i];m.divDeselect($R,true);};m.divs=[];};this.multiselect.divDeselect=function($R,$0r){var m=$f.multiselect;var cn=$f.applyCssClass("selected");var c=$R;if(c&&c.className&&c.className.indexOf(cn)!=-1){c.className=c.className.replace(cn,"");};if($0r){return;};var i=DayPilot.indexOf(m.divs,$R);if(i!=-1){m.divs.splice(i,1);}};this.multiselect.isSelected=function(ev){return $f.multiselect.indexOf(ev)!=-1;};this.multiselect.indexOf=function(ev){return DayPilot.indexOf($f.multiselect.list,ev);};this.update=function(){this.loadEvents();this.deleteEvents();this.deleteCells();this.drawCells();this.drawEvents();this.prepareRowTops();this.updateRowHeaderHeights();};this.updateRowsNoLoad=function($0l){var $X,end;var $0s=new Date();$0l=DayPilot.ua($0l);if(this.rowsDirty){$f.debug('updateRowsNoLoad()/row height change detected');$X=new Date();this.updateRowHeaderHeights();this.prepareRowTops();end=new Date();$f.debug('updateRowsNoLoad()/updateRowHeaderHeights() took:'+(end.getTime()-$X.getTime()));$X=new Date();this.deleteCells();end=new Date();$f.debug('updateRowsNoLoad()/deleteCells() took:'+(end.getTime()-$X.getTime()));this.deleteSeparators();$X=new Date();for(var i=0;i<$0l.length;i++){var ri=$0l[i];this.deleteEventsInRow(ri);};end=new Date();$f.debug('updateRowsNoLoad()/row deleting took:'+(end.getTime()-$X.getTime()));$X=new Date();for(var i=0;i<$0l.length;i++){var ri=$0l[i];this.drawEventsInRow(ri);};end=new Date();$f.debug('updateRowsNoLoad()/row drawing took:'+(end.getTime()-$X.getTime()));$X=new Date();this.drawCells();end=new Date();$f.debug('updateRowsNoLoad()/drawCells() took:'+(end.getTime()-$X.getTime()));this.drawSeparators();this.updateEventTops();}else{$X=new Date();for(var i=0;i<$0l.length;i++){var ri=$0l[i];this.deleteEventsInRow(ri);this.drawEventsInRow(ri);};end=new Date();$f.debug('updateRowsNoLoad()/row updating took:'+(end.getTime()-$X.getTime()));};$0t=new Date();$f.debug('* updateRowsNoLoad() took:'+($0t.getTime()-$0s.getTime()));};this.notify=function($0k,$0d){var $0i={};$0i.actions=[];$0i.actions.ignoreToJSON=true;$0i.actions.push($0k);this.callBack2('Notify',$0i,$0d);};this.notifyCommit='Immediate';this.eventMoveDispatch=function(e,$r,$s,$t,external,ev){switch($f.eventMoveHandling){case 'PostBack':$f.eventMovePostBack(e,$r,$s,$t);break;case 'CallBack':$f.eventMoveCallBack(e,$r,$s,$t);break;case 'JavaScript':$f.onEventMove(e,$r,$s,$t,external,ev.ctrlKey,ev.shiftKey);break;case 'Notify':$f.eventMoveNotify(e,$r,$s,$t);break;}};this.eventBubbleCallBack=function(e,$D){var $C=this.recordBubbleCall($D);var $0i={};$0i.e=e;$0i.guid=$C;this.callBack2("EventBubble",$0i);};this.bubbleCallBack=function($0u,$D){var $C=this.recordBubbleCall($D);var $0i={};$0i.args=$0u;$0i.guid=$C;this.callBack2("Bubble",$0i);};this.recordBubbleCall=function($D){var $C=DayPilot.guid();if(!this.bubbles){this.bubbles=[];};this.bubbles[$C]=$D;return $C;};this.eventMenuClickPostBack=function(e,$0v,$0d){var $0i={};$0i.e=e;$0i.command=$0v;this.postBack2('EventMenuClick',$0i,$0d);};this.eventMenuClickCallBack=function(e,$0v,$0d){var $0i={};$0i.e=e;$0i.command=$0v;this.callBack2('EventMenuClick',$0i,$0d);};this.eventMenuClick=function($0v,e,$0w){switch($0w){case 'PostBack':$f.eventMenuClickPostBack(e,$0v);break;case 'CallBack':$f.eventMenuClickCallBack(e,$0v);break;}};this.timeRangeSelectedPostBack=function($X,end,$0x,$0d){var $v={};$v.start=$X;$v.end=end;$v.resource=$0x;this.postBack2('TimeRangeSelected',$v,$0d);};this.timeRangeSelectedCallBack=function($X,end,$0x,$0d){var $v={};$v.start=$X;$v.end=end;$v.resource=$0x;this.callBack2('TimeRangeSelected',$v,$0d);};this.timeRangeSelectedDispatch=function($X,end,$0x){switch($f.timeRangeSelectedHandling){case 'PostBack':$f.timeRangeSelectedPostBack($X,end,$0x);break;case 'CallBack':$f.timeRangeSelectedCallBack($X,end,$0x);break;case 'JavaScript':$f.onTimeRangeSelected($X,end,$0x);break;case 'Hold':break;}};this.timeRangeDoubleClickPostBack=function($X,end,$0x,$0d){var $v={};$v.start=$X;$v.end=end;$v.resource=$0x;this.postBack2('TimeRangeDoubleClick',$v,$0d);};this.timeRangeDoubleClickCallBack=function($X,end,$0x,$0d){var $v={};$v.start=$X;$v.end=end;$v.resource=$0x;this.callBack2('TimeRangeDoubleClick',$v,$0d);};this.timeRangeDoubleClickDispatch=function($X,end,$0x){switch($f.timeRangeDoubleClickHandling){case 'PostBack':$f.timeRangeDoubleClickPostBack($X,end,$0x);break;case 'CallBack':$f.timeRangeDoubleClickCallBack($X,end,$0x);break;case 'JavaScript':$f.onTimeRangeDoubleClick($X,end,$0x);break;}};this.timeRangeMenuClickPostBack=function(e,$0v,$0d){var $0i={};$0i.selection=e;$0i.command=$0v;this.postBack2("TimeRangeMenuClick",$0i,$0d);};this.timeRangeMenuClickCallBack=function(e,$0v,$0d){var $0i={};$0i.selection=e;$0i.command=$0v;this.callBack2("TimeRangeMenuClick",$0i,$0d);};this.timeRangeMenuClick=function($0v,e,$0w){switch($0w){case 'PostBack':$f.timeRangeMenuClickPostBack(e,$0v);break;case 'CallBack':$f.timeRangeMenuClickCallBack(e,$0v);break;}};this.resourceHeaderMenuClickPostBack=function(e,$0v,$0d){var $0i={};$0i.resource=e;$0i.command=$0v;this.postBack2("ResourceHeaderMenuClick",$0i,$0d);};this.resourceHeaderMenuClickCallBack=function(e,$0v,$0d){var $0i={};$0i.resource=e;$0i.command=$0v;this.callBack2("ResourceHeaderMenuClick",$0i,$0d);};this.resourceHeaderMenuClick=function($0v,e,$0w){switch($0w){case 'PostBack':$f.resourceHeaderMenuClickPostBack(e,$0v);break;case 'CallBack':$f.resourceHeaderMenuClickCallBack(e,$0v);break;}};this.resourceHeaderClickPostBack=function(e,$0d){var $0i={};$0i.resource=e;this.postBack2("ResourceHeaderClick",$0i,$0d);};this.resourceHeaderClickCallBack=function(e,$0d){var $0i={};$0i.resource=e;this.callBack2("ResourceHeaderClick",$0i,$0d);};this.resourceHeaderClickDispatch=function(e){switch(this.resourceHeaderClickHandling){case 'PostBack':$f.resourceHeaderClickPostBack(e);break;case 'CallBack':$f.resourceHeaderClickCallBack(e);break;case 'JavaScript':$f.onResourceHeaderClick(e);break;}};this.resourceCollapsePostBack=function(e,$0d){var $0i={};$0i.resource=e;this.postBack2("ResourceCollapse",$0i,$0d);};this.resourceCollapseCallBack=function(e,$0d){var $0i={};$0i.resource=e;this.callBack2("ResourceCollapse",$0i,$0d);};this.resourceCollapseDispatch=function(e){switch(this.resourceCollapseHandling){case 'PostBack':$f.resourceCollapsePostBack(e);break;case 'CallBack':$f.resourceCollapseCallBack(e);break;case 'JavaScript':$f.onResourceCollapse(e);break;}};this.resourceExpandPostBack=function(e,$0d){var $0i={};$0i.resource=e;this.postBack2("ResourceExpand",$0i,$0d);};this.resourceExpandCallBack=function(e,$0d){var $0i={};$0i.resource=e;this.callBack2("ResourceExpand",$0i,$0d);};this.resourceExpandDispatch=function(e){switch(this.resourceExpandHandling){case 'PostBack':$f.resourceExpandPostBack(e);break;case 'CallBack':$f.resourceExpandCallBack(e);break;case 'JavaScript':$f.onResourceExpand(e);break;}};this.eventEditPostBack=function(e,$0y,$0d){var $0i={};$0i.e=e;$0i.newText=$0y;this.postBack2("EventEdit",$0i,$0d);};this.eventEditCallBack=function(e,$0y,$0d){var $0i={};$0i.e=e;$0i.newText=$0y;this.callBack2("EventEdit",$0i,$0d);};this.eventEditDispatch=function(e,$0y){switch($f.eventEditHandling){case 'PostBack':$f.eventEditPostBack(e,$0y);break;case 'CallBack':$f.eventEditCallBack(e,$0y);break;case 'JavaScript':$f.onEventEdit(e,$0y);break;}};this.commandCallBack=function($0v,$0d){this.invokeCommand("CallBack",$0v,$0d);};this.invokeCommand=function($d,$0v,$0d){var $0i={};$0i.command=$0v;this.invokeEvent($d,"Command",$0i,$0d);};this.postBack2=function($0k,$0z,$0d){var $0A={};$0A.action=$0k;$0A.type="PostBack";$0A.parameters=$0z;$0A.data=$0d;$0A.header=this.getCallBackHeader();var $0B="JSON"+DayPilot.JSON.stringify($0A);__doPostBack($f.uniqueID,$0B);};this.callBack2=function($0k,$0z,$0d,$d){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};if(typeof $d==='undefined'){$d="CallBack";};this.stopAutoRefresh();this.callbackTimeout=window.setTimeout(function(){$f.loadingStart();},100);var $0A={};$0A.action=$0k;$0A.type=$d;$0A.parameters=$0z;$0A.data=$0d;$0A.header=this.getCallBackHeader();var $0C=DayPilot.JSON.stringify($0A);var $0B;if(typeof $0D!=='undefined'&&$0D.compress){$0B="LZJB"+$0D.Base64.encode($0D.compress($0C));}else{$0B="JSON"+$0C;};var $B=null;if(this.backendUrl){DayPilot.request(this.backendUrl,this.callBackResponse,$0B,this.ajaxError);}else{WebForm_DoCallback(this.uniqueID,$0B,this.updateView,$B,this.callbackError,true);}};this.callBackResponse=function($0E){$f.updateView($0E.responseText);};this.getCallBackHeader=function(){var h={};h.control="dps";h.id=this.id;h.startDate=$f.startDate;h.days=$f.days;h.cellDuration=$f.cellDuration;h.cellGroupBy=$f.cellGroupBy;h.cellWidth=$f.cellWidth;h.viewType=$f.viewType;h.hourNameBackColor=$f.hourNameBackColor;h.showNonBusiness=$f.showNonBusiness;h.businessBeginsHour=$f.businessBeginsHour;h.businessEndsHour=$f.businessEndsHour;h.weekStarts=$f.weekStarts;h.treeEnabled=$f.treeEnabled;h.backColor=$f.cellBackColor;h.nonBusinessBackColor=$f.cellBackColorNonBusiness;h.locale=$f.locale;h.tagFields=$f.tagFields;h.timeHeaders=$f.timeHeaders;h.clientState=$f.clientState;if(this.nav.scroll){h.scrollX=this.nav.scroll.scrollLeft;h.scrollY=this.nav.scroll.scrollTop;};h.selected=$f.multiselect.events();h.hashes=$f.hashes;var $0F=$f.getArea(h.scrollX,h.scrollY);var $v=$f.getAreaRange($0F);var $0G=$f.getAreaResources($0F);h.rangeStart=$v.start;h.rangeEnd=$v.end;h.resources=$0G;h.dynamicLoading=$f.dynamicLoading;if(this.syncResourceTree){h.tree=this.getTreeState();};return h;};this.getArea=function(scrollX,scrollY){var $0F={};$0F.start={};$0F.end={};$0F.start.x=Math.floor(scrollX/$f.cellWidth);$0F.end.x=Math.floor((scrollX+$f.nav.scroll.clientWidth)/$f.cellWidth);$0F.start.y=$f.getRow(scrollY).i;$0F.end.y=$f.getRow(scrollY+$f.nav.scroll.clientHeight).i;var $0H=this.timeline.length;if($0F.end.x>=$0H){$0F.end.x=$0H-1;};return $0F;};this.getAreaRange=function($0F){var $A={};if(this.timeline.length<=0){$A.start=this.startDate;$A.end=this.startDate;return $A;};if(!this.timeline[$0F.start.x]){throw 'Internal error: area.start.x is null.';};$A.start=this.timeline[$0F.start.x].start;$A.end=this.timeline[$0F.end.x].end;return $A;};this.getAreaResources=function($0F){if(!$0F){var $0F=this.getArea(this.nav.scroll.scrollLeft,this.nav.scroll.scrollTop);};var $0G=[];$0G.ignoreToJSON=true;for(var i=$0F.start.y;i<=$0F.end.y;i++){var r=$f.rows[i];if(r&&!r.Hidden){$0G.push(r.Value);}};return $0G;};this.getTreeState=function(){var $0I=[];$0I.ignoreToJSON=true;for(var i=0;i<this.rows.length;i++){if(this.rows[i].Level>0){continue;};var $0J=this.getNodeState(i);$0I.push($0J);};return $0I;};this.getNodeChildren=function($0K){var $0L=[];$0L.ignoreToJSON=true;for(var i=0;i<$0K.length;i++){$0L.push(this.getNodeState($0K[i]));};return $0L;};this.getNodeState=function(i){var $p=this.rows[i];var $0J={};$0J.Value=$p.Value;$0J.BackColor=$p.BackColor;$0J.Name=$p.Name;$0J.InnerHTML=$p.InnerHTML;$0J.ToolTip=$p.ToolTip;$0J.Expanded=$p.Expanded;$0J.Children=this.getNodeChildren($p.Children);$0J.Loaded=$p.Loaded;$0J.Columns=this.getNodeColumns($p);if($p.MinHeight!==$f.rowMinHeight){$0J.MinHeight=$p.MinHeight;};if($p.MarginBottom!==$f.rowMarginBottom){$0J.MarginBottom=$p.MarginBottom;};return $0J;};this.getNodeColumns=function($p){if(!$p.Columns||$p.Columns.length===0){return null;};var $0M=[];$0M.ignoreToJSON=true;for(var i=0;i<$p.Columns.length;i++){var c={};c.InnerHTML=$p.Columns[i].InnerHTML;$0M.push(c);};return $0M;};this.$=function($0N){return document.getElementById(id+"_"+$0N);};this.applyCssClass=function($0O){if(this.cssClassPrefix){return this.cssClassPrefix+$0O;}else{return "";}};this.registerDispose=function(){var $0P=document.getElementById(id);$0P.dispose=this.dispose;};this.dispose=function(){var c=$f;c.deleteEvents();c.divBreaks=null;c.divCells=null;c.divCorner=null;c.divCrosshair=null;c.divEvents=null;c.divHeader=null;c.divLines=null;c.divNorth=null;c.divRange=null;c.divResScroll=null;c.divSeparators=null;c.divSeparatorsAbove=null;c.divStretch=null;c.divTimeScroll=null;c.scrollRes=null;c.vsph=null;c.maind=null;c.nav.loading=null;c.nav.top.onmousemove=null;c.nav.top.dispose=null;c.nav.top=null;c.nav.scroll.onscroll=null;c.nav.scroll.root=null;c.nav.scroll=null;DayPilot.ue(window,'resize',c.resize);DayPilotScheduler.unregister(c);};this.createShadow=function($b,$i,$d){var $0Q=$f.maind;var $0R=$f.getShadowCoords();var $z=$0R.row.Height;var $k=document.createElement('div');$k.setAttribute('unselectable','on');$k.style.position='absolute';$k.style.width=($0R.width-4)+'px';$k.style.height=($z-4)+'px';$k.style.left=$0R.left+'px';$k.style.top=$0R.top+'px';$k.style.border='2px dotted #666666';$k.style.zIndex=101;if($d==='Fill'){$k.style.backgroundColor="#aaaaaa";$k.style.opacity=0.5;$k.style.filter="alpha(opacity=50)";$k.style.border='2px solid #aaaaaa';if($i&&$i.data){$k.style.overflow='hidden';$k.style.fontSize=$i.style.fontSize;$k.style.fontFamily=$i.style.fontFamily;$k.style.color=$i.style.color;$k.innerHTML=$i.data.client.innerHTML();}};$0Q.appendChild($k);return $k;};this.getRow=function(y){var $A={};var element;var top=0;var $0S=0;var $0T=this.rows.length;for(var i=0;i<$0T;i++){var $p=this.rows[i];if($p.Hidden){continue;};$0S+=$p.Height;if(y<$0S||i===$0T-1){top=$0S-$p.Height;element=$p;break;}};$A.top=top;$A.bottom=$0S;$A.i=i;$A.element=element;return $A;};this.getRowByIndex=function(i){var top=0;var $0U=0;var $0V=0;if(i>this.rows.length-1){throw "Row index too high (DayPilotScheduler.getRowByIndex)";};for(var j=0;j<=i;j++){var $p=this.rows[j];if($p.Hidden){continue;};$0U+=$p.Height;$0V++;};top=$0U-$p.Height;var $A={};$A.top=top;$A.height=$p.Height;$A.bottom=$0U;$A.i=$0V-1;return $A;};this.loadFromServer=function(){return(typeof this.events.list==='undefined')||(this.events.list===null);};this.events.find=function(id){var $0W=$f.events.list.length;for(var i=0;i<$0W;i++){if($f.events.list[i].value===id){return new DayPilot.Event($f.events.list[i],$f);}};return null;};this.events.findRecurrent=function($0X,$0Y){var $0W=$f.events.list.length;for(var i=0;i<$0W;i++){if($f.events.list[i].recurrentMasterId===$0X&&$f.events.list[i].start.getTime()==$0Y.getTime()){return new DayPilot.Event($f.events.list[i],$f);}};return null;};this.events.removeFromRows=function($0d){var $0l=[];for(var i=0;i<$f.rows.length;i++){var $p=$f.rows[i];for(var r=0;r<$p.events.length;r++){if($p.events[r].data==$0d){$0l.push(i);$p.events.splice(r,1);break;}}};return $0l;};this.events.addToRows=function($0d){var $0l=[];for(var i=0;i<$f.rows.length;i++){var $p=$f.rows[i];var ep=$f.loadEvent($0d,$p);if(ep){$0l.push(i);}};return $0l;};this.events.update=function(e,$0d){if(!e.dirty()){throw "Not dirty";};var $0i={};$0i.oldEvent=new DayPilot.Event(e.copy(),$f);$0i.newEvent=new DayPilot.Event(e.temp(),$f);var $0k=new DayPilotScheduler.Action($f,"EventUpdate",$0i,$0d);var $0l=$f.events.removeFromRows(e.data);e.commit();$0l=$0l.concat($f.events.addToRows(e.data));$f.loadRows($0l);$f.updateRowHeights();$f.updateRowsNoLoad($0l);return $0k;};this.events.remove=function(e,$0d){var $0i={};$0i.e=new DayPilot.Event(e.data,$f);var $0k=new DayPilotScheduler.Action($f,"EventRemove",$0i,$0d);var $0V=$f.events.list.indexOf(e.data);$f.events.list.splice($0V,1);var $0l=$f.events.removeFromRows(e.data);$f.loadRows($0l);$f.updateRowHeights();$f.updateRowsNoLoad($0l);return $0k;};this.events.add=function(e,$0d){e.calendar=$f;$f.events.list.push(e.data);var $0i={};$0i.e=e;var $0k=new DayPilotScheduler.Action($f,"EventAdd",$0i,$0d);var ri=$f.rows.indexOf($f.findRowByResourceId(e.resource()));var $p=$f.rows[ri];var $X=new Date();var $0l=$f.events.addToRows(e.data);$f.loadRows($0l);$f.updateRowHeights();var end=new Date();$f.debug('* events.add()/loadEvent() took:'+(end.getTime()-$X.getTime()));$f.updateRowsNoLoad($0l);return $0k;};this.queue={};this.queue.list=[];this.queue.list.ignoreToJSON=true;this.queue.add=function($0k){if(!$0k){return;};if($0k.isAction){$f.queue.list.push($0k);}else{throw "DayPilot.Action object required for queue.add()";}};this.queue.notify=function($0d){var $0i={};$0i.actions=$f.queue.list;$f.callBack2('Notify',$0i,$0d,"Notify");$f.queue.list=[];};this.queue.clear=function(){$f.queue.list=[];};this.queue.pop=function(){return $f.queue.list.pop();};this.debug=function($0Z,$10){if(!this.debuggingEnabled){return;};if(!$f.debugMessages){$f.debugMessages=[];};$f.debugMessages.push($0Z);if(typeof $11!=='undefined'){$11.log($0Z);}};this.showDebugMessages=function(){alert("Log:\n"+$f.debugMessages.join("\n"));};this.getBoxStart=function($G){if($G.getTime()===this.startDate.getTime()){return $G;};var $12=this.startDate;if($G.getTime()<this.startDate.getTime()){while($12.getTime()>$G.getTime()){$12=$12.addMinutes(-this.cellDuration);};return $12;};if($G.getTime()>this.startDate.getTime()){while($12.getTime()<=$G.getTime()){$12=$12.addMinutes(this.cellDuration);};return $12.addMinutes(-this.cellDuration);};throw "Internal error: Cannot find box start";};this.getShadowCoords=function(){var $p=this.getRow($f.coords.y);var $i=DayPilotScheduler.moving;var e=$i.event;var $b=DayPilot.Date.diff(e.end().d,e.start().d);var $13=this.useBox($b);var $14=e.start().getDatePart();var $15=($13)?e.start().getTime()-($14.getTime()+Math.floor((e.start().getHours()*60+e.start().getMinutes())/$f.cellDuration)*$f.cellDuration*60*1000):0;var $16;if(DayPilotScheduler.moveDragStart){$16=$13?DayPilotScheduler.moveDragStart.getTime()-this.getBoxStart(e.start()).getTime():DayPilotScheduler.moveDragStart.getTime()-e.start().getTime();$16=Math.floor(($16/60000) / this.cellDuration)*(this.cellDuration*60000);}else{$16=0;};var $X=this.getDate(this.coords.x,true).addTime(-$16);var $17=$X;if(this.snapToGrid){$X=this.getBoxStart($X);};$X=$X.addTime($15);var end=$X.addTime($b);var $18=$X;var $19=end;if(this.viewType==='Days'){var $q=this.rows[e.part.dayIndex].Start.getTime()-this.startDate.getTime();var $18=$X.addTime(-$q);var $19=$18.addTime($b);var $1a=$p.element.Start.getTime()-this.startDate.getTime();$X=$18.addTime($1a);end=$X.addTime($b);};var $1b=this.getPixels($18);var $1c=this.getPixels($19);var $P=($13)?$1b.boxLeft:$1b.left;var $y=($13)?($1c.boxRight-$P):($1c.left-$P);var $0R={};$0R.top=$p.top+1;$0R.left=$P;$0R.row=$p.element;$0R.rowIndex=$p.i;$0R.width=$y;$0R.start=$X;$0R.end=end;return $0R;};this.moveShadow=function(){var scroll=this.nav.scroll;if(!$f.coords){return;};var $k=DayPilotScheduler.movingShadow;var $0R=this.getShadowCoords();$k.style.top=($0R.top-1)+'px';$k.style.left=$0R.left+'px';$k.style.width=($0R.width-4)+'px';$k.style.height=Math.max($0R.row.Height-4,0)+'px';$k.row=$0R.row;$k.start=$0R.start;$k.end=$0R.end;};this.getTotalRowHeaderWidth=function(){var $1d=0;if(this.rowHeaderCols){for(var i=0;i<this.rowHeaderCols.length;i++){$1d+=this.rowHeaderCols[i];}}else{$1d=this.rowHeaderWidth;};return $1d;};this.drawResHeader=function(){var parent=this.divResScroll;DayPilot.puc(parent);parent.innerHTML='';var $1e=this.rowHeaderCols;var $0M=$1e?this.rowHeaderCols.length:0;var $1d=this.getTotalRowHeaderWidth()-1;var $1f=document.createElement("table");$1f.style.borderCollapse="collapse";$1f.style.KhtmlUserSelect="none";$1f.style.MozUserSelect="none";$1f.style.width=$1d+"px";$1f.cellspacing="0";$1f.cellpadding="0";$1f.onmousemove=function(){$f.crosshairHide();$f.stopScroll();};this.divHeader=$1f;var m=this.rows.length;for(var i=0;i<m;i++){var $p=this.rows[i];if($p.Hidden){continue;};var r=$1f.insertRow(-1);var c=r.insertCell(-1);c.row=$p;c.index=i;var $y=$1e?$1e[0]-1:this.rowHeaderWidth-1;c.style.width=($y)+"px";c.style.borderRight="1px solid "+this.borderColor;c.style.borderBottom="1px solid "+this.borderColor;c.style.backgroundColor=$p.BackColor;c.style.fontFamily=this.headerFontFamily;c.style.fontSize=this.headerFontSize;c.style.color=this.headerFontColor;c.style.cursor='default';c.style.padding='0px';if($p.ToolTip){c.title=$p.ToolTip;};c.unselectable='on';c.setAttribute('resource',$p.Value);c.onmousemove=function(){$f.onResMouseMove(this);};c.onmouseout=function(){$f.onResMouseOut(this);};c.oncontextmenu=$f.onResRightClick;c.onclick=$f.onResClick;var $S=document.createElement("div");$S.style.width=($y)+"px";$S.unselectable='on';$S.className=this.applyCssClass('rowheader');$S.style.height=($p.Height-1)+"px";$S.style.overflow='hidden';$S.style.position='relative';if(this.treeEnabled){var $1g=document.createElement("div");$1g.style.width="10px";$1g.style.height="10px";$1g.style.backgroundRepeat="no-repeat";$1g.style.position='absolute';$1g.style.left=($p.Level*this.treeIndent+this.treeImageMarginLeft)+'px';$1g.style.top=this.treeImageMarginTop+"px";if(!$p.Loaded){if(this.treeImageExpand){$1g.style.backgroundImage="url('"+this.treeImageExpand+"')";};$1g.className=this.applyCssClass('tree_image_expand');$1g.style.cursor='pointer';$1g.index=i;$1g.onclick=function(ev){$f.loadNode(this.index);ev=ev||window.event;ev.cancelBubble=true;};}else if($p.Children.length>0){if($p.Expanded){if(this.treeImageCollapse){$1g.style.backgroundImage="url('"+this.treeImageCollapse+"')";};$1g.className=this.applyCssClass('tree_image_collapse');}else{if(this.treeImageExpand){$1g.style.backgroundImage="url('"+this.treeImageExpand+"')";};$1g.className=this.applyCssClass('tree_image_expand');};$1g.style.cursor='pointer';$1g.index=i;$1g.onclick=function(ev){$f.toggle(this.index);ev=ev||window.event;ev.cancelBubble=true;};}else{if(this.treeImageNoChildren){$1g.style.backgroundImage="url('"+this.treeImageNoChildren+"')";};$1g.className=this.applyCssClass('tree_image_no_children');};$S.appendChild($1g);};var $c=document.createElement("div");if(this.treeEnabled){$c.style.marginLeft=(($p.Level+1)*this.treeIndent)+'px';}else{$c.style.marginLeft="4px";};$c.innerHTML=$p.InnerHTML;$S.appendChild($c);c.appendChild($S);for(var j=1;j<$0M;j++){var c=r.insertCell(-1);c.row=$p;c.index=i;c.style.borderRight="1px solid "+this.borderColor;c.style.borderBottom="1px solid "+this.borderColor;c.style.backgroundColor=$p.BackColor;c.style.fontFamily=this.headerFontFamily;c.style.fontSize=this.headerFontSize;c.style.color=this.headerFontColor;c.style.cursor='default';c.style.padding='0px';if($p.ToolTip){c.title=$p.ToolTip;};c.unselectable='on';c.className=this.applyCssClass('rowheader');c.setAttribute('resource',$p.Value);c.onmousemove=function(){$f.onResMouseMove(this);};c.onmouseout=function(){$f.onResMouseOut(this);};c.oncontextmenu=$f.onResRightClick;c.onclick=$f.onResClick;var $S=document.createElement("div");$S.style.width=($1e[j]-1)+"px";$S.style.height=($p.Height-1)+"px";$S.style.overflow='hidden';$S.style.position='relative';var $c=document.createElement("div");$c.style.marginLeft='4px';var $1h=$p.Columns[j-1]?$p.Columns[j-1].InnerHTML:"";$c.innerHTML=$1h;$S.appendChild($c);c.appendChild($S);}};var r=$1f.insertRow(-1);var c=r.insertCell(-1);c.colSpan=$0M+1;c.style.width=$1d+"px";c.style.height=(parent.clientHeight+20)+"px";c.style.backgroundColor=this.hourNameBackColor;c.style.fontSize="1px";c.style.cursor='default';c.unselectable='on';c.className=this.applyCssClass('rowheader');c.innerHTML="&nbsp;";parent.appendChild($1f);};this.onResRightClick=function(){var $p=this.row;var r={};r.type='resource';r.start=$p.Start;r.name=$p.Name;r.value=$p.Value;r.index=this.index;r.root=$f;r.toJSON=function($1i){var $0C={};$0C.start=this.start;$0C.name=this.name;$0C.value=this.value;$0C.index=this.index;return $0C;};if($p.contextMenu){$p.contextMenu.show(r);};return false;};this.onResClick=function(ev){var $p=this.row;var r=$f.createDayPilotResource($p);$f.resourceHeaderClickDispatch(r);};this.createDayPilotResource=function($p){var r={};r.type='resource';r.start=$p.Start;r.name=$p.Name;r.value=$p.Value;r.index=this.index;r.root=$f;r.toJSON=function($1i){var $0C={};$0C.start=this.start;$0C.name=this.name;$0C.value=this.value;$0C.index=this.index;return $0C;};return r;};this.isResourcesView=function(){return this.viewType==='Resources';};this.loadEvents=function($0m){var $1j=[];if($0m&&this.dynamicLoading){var $1k=$0m;var $10=[];for(var i=0;i<$1k.length;i++){var e=$1k[i];var $06=false;for(var j=0;j<this.events.list.length;j++){var ex=this.events.list[j];if(ex.value===e.value){this.events.list[j]=e;$06=true;break;}};if(!$06){$10.push(e);}};this.events.list=this.events.list.concat($10);}else if($0m){this.events.list=$0m;};var $1l=this.events.list.length;for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];$p.events=[];$p.data={};$p.data.start=new DayPilot.Date($p.Start);$p.data.startTicks=$p.data.start.getTime();$p.data.end=this.isResourcesView()?$p.data.start.addDays(this.days):$p.data.start.addDays(1);$p.data.endTicks=$p.data.end.getTime();$p.data.offset=$p.Start.getTime()-this.startDate.getTime();$p.data.i=i;for(var j=0;this.events.list&&j<$1l;j++){if($1j[j]){continue;};var e=this.events.list[j];var ep=this.loadEvent(e,$p);if(!ep){continue;};if(ep.part.start.getTime()===ep.start().getTime()&&ep.part.end.getTime()===ep.end().getTime()){$1j[j]=true;}}};for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];this.loadRow($p);};this.updateRowHeights();};this.loadRow=function($p){$p.lines=[];if(this.sortDirections){$p.events.sort(this.eventComparerCustom);}else{$p.events.sort(this.eventComparer);};for(var j=0;j<$p.events.length;j++){var e=$p.events[j];$p.putIntoLine(e);}};this.loadRows=function($0l){$0l=DayPilot.ua($0l);for(var i=0;i<$0l.length;i++){var ri=$0l[i];$f.loadRow($f.rows[ri]);}};this.loadEvent=function(e,$p){var $X=new DayPilot.Date(e.start);var end=new DayPilot.Date(e.end);var $1m=$X.getTime();var $1n=end.getTime();if($1n<$1m){return null;};var $1o=false;if(this.isResourcesView()){$1o=($p.Value===e.resource||$p.Value==="*")&&!($1n<=$p.data.startTicks||$1m>=$p.data.endTicks);}else{$1o=!($1n<=$p.data.startTicks||$1m>=$p.data.endTicks);};if(!$1o){return null;};var ep=new DayPilot.Event(e,$f);ep.part.dayIndex=$p.data.i;ep.part.start=$p.data.startTicks<$1m?ep.start():$p.data.start;ep.part.end=$p.data.endTicks>$1n?ep.end():$p.data.end;var $1p=this.getPixels(ep.part.start.addTime(-$p.data.offset));var $1q=this.getPixels(ep.part.end.addTime(-$p.data.offset));var $P=$1p.left;var $Q=$1q.left;if($P===$Q&&($1p.cut||$1q.cut)){return null;};ep.part.box=this.useBox($1n-$1m);if(ep.part.box){var $1r=$1q.boxRight;ep.part.left=Math.floor($P/this.cellWidth)*this.cellWidth;ep.part.width=Math.max(Math.ceil($1r/this.cellWidth)*this.cellWidth-ep.part.left-2,this.cellWidth-2);ep.part.barLeft=Math.max($P-ep.part.left-1,0);ep.part.barWidth=Math.max($Q-$P-1,1);}else{ep.part.left=$P;ep.part.width=Math.max($Q-$P-2,0);ep.part.barLeft=0;ep.part.barWidth=Math.max($Q-$P-1,1);};$p.events.push(ep);return ep;};this.useBox=function($1s){if(this.useEventBoxes==='Always'){return true;};if(this.useEventBoxes==='Never'){return false;};return $1s<this.cellDuration*60*1000;};this.eventComparer=function(a,b){if(!a||!b||!a.start||!b.start){return 0;};var $1t=a.start().getTime()-b.start().getTime();if($1t!==0){return $1t;};var $1u=b.end().getTime()-a.end().getTime();return $1u;};this.eventComparerCustom=function(a,b){if(!a||!b){return 0;};if(!a.data||!b.data||!a.data.sort||!b.data.sort||a.data.sort.length===0||b.data.sort.length===0){return $f.eventComparer(a,b);};var $A=0;var i=0;while($A===0&&a.data.sort[i]&&b.data.sort[i]){if(a.data.sort[i]===b.data.sort[i]){$A=0;}else{$A=$f.stringComparer(a.data.sort[i],b.data.sort[i],$f.sortDirections[i]);};i++;};return $A;};this.stringComparer=function(a,b,$1v){var $1w=($1v!=="desc");var $1x=$1w?-1:1;var $1y=-$1x;if(a===null&&b===null){return 0;};if(b===null){return $1y;};if(a===null){return $1x;};var ar=[];ar[0]=a;ar[1]=b;ar.sort();return a===ar[0]?$1x:$1y;};this.loadResources=function(){this.rows=[];var $0V={};$0V.i=0;this.loadResourceChildren(this.resources,$0V,0,null,this.treeEnabled,false);};this.loadResourceChildren=function($1z,$0V,$1A,parent,$1B,$1C){if(!$1z){return;};for(var i=0;i<$1z.length;i++){var $0G=$1z[i];var $p={};$p.BackColor=$0G.BackColor;$p.Expanded=$0G.Expanded;$p.Name=$0G.Name;$p.InnerHTML=$0G.InnerHTML?$0G.InnerHTML:$0G.Name;$p.MinHeight=typeof $0G.MinHeight!='undefined'?$0G.MinHeight:$f.rowMinHeight;$p.MarginBottom=typeof $0G.MarginBottom!='undefined'?$0G.MarginBottom:$f.rowMarginBottom;$p.Loaded=$0G.Loaded;$p.Value=$0G.Value;$p.ToolTip=$0G.ToolTip;$p.Children=[];$p.Columns=[];$p.Start=$0G.Start?new DayPilot.Date($0G.Start):this.startDate;$p.contextMenu=$0G.ContextMenu?eval($0G.ContextMenu):this.contextMenuResource;$p.Height=this.eventHeight;$p.Hidden=$1C;$p.Level=$1A;$p.Index=$0V.i;$p.lines=[];$p.isRow=true;$p.height=function(){var $1D=Math.max(1,this.lines.length);var $z=$1D*$f.eventHeight+this.MarginBottom;return($z>this.MinHeight)?$z:this.MinHeight;};$p.putIntoLine=function(ep){var $1E=this;for(var i=0;i<this.lines.length;i++){var $1F=this.lines[i];if($1F.isFree(ep.part.left,ep.part.width)){$1F.push(ep);return i;}};var $1F=[];$1F.isFree=function($1G,$1H){var end=$1G+$1H-1;var $1I=this.length;for(var i=0;i<$1I;i++){var e=this[i];if(!(end<e.part.left||$1G>e.part.left+e.part.width-1)){return false;}};return true;};$1F.push(ep);this.lines.push($1F);return this.lines.length-1;};this.rows.push($p);if(parent!==null){parent.Children.push($0V.i);};if($0G.Columns){for(var j=0;j<$0G.Columns.length;j++){$p.Columns.push($0G.Columns[j]);}};$0V.i++;if($1B&&$0G.Children){var $1J=$1C||!$p.Expanded;this.loadResourceChildren($0G.Children,$0V,$1A+1,$p,true,$1J);}}};this.drawTop=function(){this.nav.top=document.getElementById(this.id);this.nav.top.innerHTML="";this.nav.top.style.MozUserSelect='none';this.nav.top.style.KhtmlUserSelect='none';this.nav.top.style.width=this.width?this.width:'100%';if(this.heightSpec==="Parent100Pct"){this.nav.top.style.height="100%";};this.nav.top.style.lineHeight="1.2";this.nav.top.style.position="relative";this.nav.top.onmousemove=function(ev){ev=ev||window.event;ev.insideMainD=true;if(window.event){window.event.srcElement.inside=true;}};var $1K=this.getTotalRowHeaderWidth();var $1L=this.getLayout();if($1L==='DivBased'){var $P=document.createElement("div");$P.style.cssFloat="left";$P.style.styleFloat="left";$P.style.width=($1K)+"px";$P.appendChild(this.drawCorner());$P.appendChild(this.drawResourceHeader());var $Q=document.createElement("div");$Q.style.marginLeft=($1K+1)+"px";$Q.style.marginRight='1px';$Q.style.position='relative';$Q.appendChild(this.drawTimeHeaderDiv());$Q.appendChild(this.drawMainContent());this.nav.top.appendChild($P);this.nav.top.appendChild($Q);}else{var $1f=document.createElement("table");$1f.cellPadding=0;$1f.cellSpacing=0;$1f.border=0;$1f.style.position='absolute';$1f.style.backgroundColor=this.hourNameBackColor;var $1M=$1f.insertRow(-1);var $1N=$1M.insertCell(-1);$1N.appendChild(this.drawCorner());var $1O=$1M.insertCell(-1);$1O.appendChild(this.drawTimeHeaderDiv());var $1P=$1f.insertRow(-1);var $1Q=$1P.insertCell(-1);$1Q.appendChild(this.drawResourceHeader());var $1R=$1P.insertCell(-1);$1R.appendChild(this.drawMainContent());this.nav.top.appendChild($1f);};this.vsph=document.createElement("div");this.vsph.style.display="none";this.nav.top.appendChild(this.vsph);var $1S=document.createElement("input");$1S.type="hidden";$1S.id=this.id+"_state";$1S.name=this.id+"_state";this.nav.top.appendChild($1S);var loading=document.createElement("div");loading.style.position='absolute';loading.style.left=(this.getTotalRowHeaderWidth()+5)+"px";loading.style.top=(this.getTotalHeaderHeight()+5)+"px";loading.style.backgroundColor=this.loadingLabelBackColor;loading.style.fontSize=this.loadingLabelFontSize;loading.style.fontFamily=this.loadingLabelFontFamily;loading.style.color=this.loadingLabelFontColor;loading.style.padding='2px';loading.innerHTML=this.loadingLabelText;loading.style.display='none';this.nav.loading=loading;this.nav.top.appendChild(loading);};this.updateHeaderHeight=function(){this.nav.loading.style.top=(this.getTotalHeaderHeight()+5)+"px";this.divCorner.style.height=(this.getTotalHeaderHeight()-1)+"px";this.divNorth.style.height=this.getTotalHeaderHeight()+"px";this.nav.scroll.style.top=this.getTotalHeaderHeight()+"px";};this.drawCorner=function(){var $1K=this.getTotalRowHeaderWidth();var $R=document.createElement("div");$R.style.width=$1K+"px";$R.style.borderRight="1px solid "+this.borderColor;$R.style.borderTop="1px solid "+this.borderColor;$R.style.backgroundColor=this.hourNameBackColor;$R.style.fontFamily=this.hourFontFamily;$R.style.fontSize=this.hourFontSize;$R.style.cursor='default';$R.style.overflow='hidden';$R.style.position='relative';$R.className=this.applyCssClass('corner');$R.unselectable='on';$R.onmousemove=function(){$f.crosshairHide();$f.stopScroll();};$R.oncontextmenu=function(){return false;};var $S=document.createElement("div");$S.style.width=($1K-1)+"px";$S.style.height=(this.getTotalHeaderHeight()-1)+"px";$S.style.borderLeft="1px solid "+this.borderColor;this.divCorner=$S;$S.innerHTML='&nbsp;';$R.appendChild($S);var $1T=document.createElement("div");$1T.style.position='absolute';$1T.style.padding='2px';$1T.style.top='0px';$1T.style.left='1px';$1T.style.backgroundColor="#FF6600";$1T.style.color="white";$1T.innerHTML="\u0044\u0045\u004D\u004F";if(this.numberFormat)$R.appendChild($1T);$f.nav.corner=$R;return $R;};this.getTotalHeaderHeight=function(){if(this.timeHeader){return this.timeHeader.length*this.headerHeight;};return 2*this.headerHeight;};this.drawResourceHeader=function(){var $R=document.createElement("div");$R.style.border="1px solid "+this.borderColor;$R.style.backgroundColor=this.hourNameBackColor;$R.style.width=(this.getTotalRowHeaderWidth()-1)+"px";$R.style.height=this.getScrollableHeight()+"px";$R.style.overflow='hidden';$R.style.position='relative';$R.onmousemove=function(){$f.crosshairHide();$f.stopScroll();};$R.oncontextmenu=function(){return false;};this.divResScroll=$R;this.scrollRes=$R;return $R;};this.setRightColWidth=function($R){if(this.getLayout()==='TableBased'){var $y=parseInt(this.width,10);var $1U=(this.width.indexOf("%")!==-1);var $1V=/MSIE/i.test(navigator.userAgent);var $1K=this.getTotalRowHeaderWidth();if($1U){if(this.nav.top&&this.nav.top.offsetWidth>0){$R.style.width=(this.nav.top.offsetWidth-6-$1K)+"px";}}else{$R.style.width=($y-$1K)+"px";}}};this.resize=function(){if($f.getLayout()==='TableBased'){$f.setRightColWidth($f.nav.scroll);$f.setRightColWidth($f.divTimeScroll);};$f.updateHeight();if($f.cellWidthSpec==='Auto'){$f.calculateCellWidth();$f.drawTimeHeader();$f.drawCells();}};this.calculateCellWidth=function(){if(this.cellWidthSpec!=='Auto'){return;};var $1W=this.nav.top.clientWidth;var $1X=this.getTotalRowHeaderWidth();var $1Y=$1W-$1X;var $00=$1Y/this.cellCount();this.cellWidth=Math.floor($00);};this.drawTimeHeaderDiv=function(){var $R=document.createElement("div");$R.style.overflow='hidden';$R.style.backgroundColor=this.hourNameBackColor;$R.style.borderRight="1px solid "+this.borderColor;$R.style.position='absolute';$R.style.display='block';$R.style.top="0px";$R.style.width="100%";$R.onmousemove=function(){$f.crosshairHide();$f.stopScroll();if($f.cellBubble){$f.cellBubble.delayedHide();}};this.setRightColWidth($R);this.divTimeScroll=$R;var $S=document.createElement("div");$S.style.borderTop="1px solid "+this.borderColor;$S.style.width=(this.cellCount()*this.cellWidth+5000)+"px";$S.style.height=this.getTotalHeaderHeight()+"px";this.divNorth=$S;$R.appendChild($S);return $R;};this.getScrollableHeight=function(){var $z;if(this.heightSpec==='Fixed'||this.heightSpec==="Parent100Pct"){return this.height?this.height:0;}else{if(this.innerHeightTree){var $1Z=DayPilot.sh($f.nav.scroll);if($1Z===0){$z=this.innerHeightTree;}else{$z=this.innerHeightTree+$1Z;}}else{$z=this.rows.length*this.eventHeight;}};if(this.heightSpec==='Max'&&$z>this.height){return this.height;};return $z;};this.findGrouplineX=function($P){for(var i=0;i<this.groupline.length;i++){var $00=this.groupline[i];if($P>=$00.left&&$P<$00.left+$00.width){return i;}};return this.groupline.length-1;};this.out=function(){this.crosshairHide();this.stopScroll();};this.drawMainContent=function(){var $R=document.createElement("div");$R.style.overflow="auto";$R.style.overflowX="auto";$R.style.overflowY="auto";$R.style.position="absolute";$R.style.height=this.getScrollableHeight()+"px";$R.style.top=this.getTotalHeaderHeight()+"px";$R.style.width="100%";$R.style.borderRight="1px solid "+this.borderColor;$R.style.borderBottom="1px solid "+this.borderColor;$R.style.borderTop="1px solid "+this.borderColor;$R.style.backgroundColor=this.emptyBackColor;$R.oncontextmenu=function(){return false;};this.setRightColWidth($R);this.nav.scroll=$R;this.maind=document.createElement("div");this.maind.style.MozUserSelect="none";this.maind.style.KhtmlUserSelect="none";this.maind.style.backgroundColor=this.cellBorderColor;this.maind.style.position='absolute';this.maind.style.width=(this.cellCount()*this.cellWidth)+"px";this.maind.unselectable="on";this.maind.onmousedown=this.onMaindMouseDown;this.maind.onmousemove=this.onMaindMouseMove;this.maind.oncontextmenu=this.onMaindRightClick;this.maind.ondblclick=this.onMaindDblClick;this.divStretch=document.createElement("div");this.divStretch.style.position='absolute';this.divStretch.style.height='1px';this.maind.appendChild(this.divStretch);this.divCells=document.createElement("div");this.divCells.style.position='absolute';this.divCells.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divCells);this.divLines=document.createElement("div");this.divLines.style.position='absolute';this.divLines.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divLines);this.divBreaks=document.createElement("div");this.divBreaks.style.position='absolute';this.divBreaks.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divBreaks);this.divSeparators=document.createElement("div");this.divSeparators.style.position='absolute';this.divSeparators.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divSeparators);this.divCrosshair=document.createElement("div");this.divCrosshair.style.position='absolute';this.divCrosshair.ondblclick=this.onMaindDblClick;this.maind.appendChild(this.divCrosshair);this.divRange=document.createElement("div");this.divRange.style.position='absolute';this.divRange.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divRange);this.divEvents=document.createElement("div");this.divEvents.style.position='absolute';this.maind.appendChild(this.divEvents);this.divSeparatorsAbove=document.createElement("div");this.divSeparatorsAbove.style.position='absolute';this.divSeparatorsAbove.oncontextmenu=this.onMaindRightClick;this.maind.appendChild(this.divSeparatorsAbove);$R.appendChild(this.maind);return $R;};this.loadingStart=function(){if(this.loadingLabelVisible){$f.nav.loading.innerHTML=this.loadingLabelText;$f.nav.loading.style.display='';}};this.loadingStop=function($0Z){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};if($0Z){this.nav.loading.innerHTML=$0Z;window.setTimeout(function(){$f.loadingStop();},1000);}else{this.nav.loading.style.display='none';}};this.prepareVariables=function(){this.startDate=new DayPilot.Date(this.startDate).getDatePart();};this.shortInit=function(){this.prepareVariables();this.loadResources();this.drawTop();this.resize();this.registerGlobalHandlers();this.registerDispose();DayPilotScheduler.register(this);this.afterRender(null,false);this.registerOnScroll();this.startAutoRefresh();this.callBack2('Init');};this.Init=function(){var $20=this.loadFromServer();var $21=this.events.list!==null;if($20){this.shortInit();return;};this.prepareVariables();this.prepareTimeline();this.prepareGroupline();this.loadResources();this.drawTop();this.resize();this.calculateCellWidth();this.drawTimeHeader();this.loadingStart();if($21){this.loadEvents();}else{this.events.list=[];};this.prepareRowTops();this.drawResHeader();this.updateHeight();this.drawSeparators();this.registerGlobalHandlers();this.registerDispose();DayPilotScheduler.register(this);this.afterRender(null,false);this.registerOnScroll();this.loadingStop();if($f.scrollToDate){$f.scrollTo($f.scrollToDate);}else{$f.setScroll($f.scrollX,$f.scrollY);};if(!$f.onScrollCalled){this.onScroll();};if(this.messageHTML){this.message(this.messageHTML,5000);};this.startAutoRefresh();};this.startAutoRefresh=function($22){if($22){this.autoRefreshEnabled=true;};if(!this.autoRefreshEnabled){return;};if(this.autoRefreshCount>=this.autoRefreshMaxCount){return;};this.stopAutoRefresh();var $23=this.autoRefreshInterval;if(!$23||$23<10){throw "The minimum autoRefreshInterval is 10 seconds";};this.autoRefreshTimeout=window.setTimeout(function(){$f.doRefresh();},this.autoRefreshInterval*1000);};this.stopAutoRefresh=function(){if(this.autoRefreshTimeout){window.clearTimeout(this.autoRefreshTimeout);}};this.doRefresh=function(){if(!DayPilotScheduler.resizing&&!DayPilotScheduler.moving&&!DayPilotScheduler.drag&&!DayPilotScheduler.range){this.autoRefreshCount++;this.commandCallBack(this.autoRefreshCommand);};if(this.autoRefreshCount<this.autoRefreshMaxCount){this.autoRefreshTimeout=window.setTimeout(function(){$f.doRefresh();},this.autoRefreshInterval*1000);}};this.registerGlobalHandlers=function(){if(!DayPilotScheduler.globalHandlers){DayPilotScheduler.globalHandlers=true;DayPilot.re(document,'mousemove',DayPilotScheduler.gMouseMove);DayPilot.re(document,'mouseup',DayPilotScheduler.gMouseUp);DayPilot.re(window,'unload',DayPilotScheduler.gUnload);};DayPilot.re(window,'resize',this.resize);};this.registerOnScroll=function(){this.nav.scroll.root=this;this.nav.scroll.onscroll=this.onScroll;$f.scrollPos=this.nav.scroll.scrollLeft;$f.scrollTop=this.nav.scroll.scrollTop;$f.scrollWidth=this.divNorth.clientWidth;};this.saveState=function(){var $X=new Date();var $24={};$24.scrollX=this.nav.scroll.scrollLeft;$24.scrollY=this.nav.scroll.scrollTop;if(this.syncResourceTree){$24.tree=this.getTreeState();};this.$("state").value=DayPilot.he(DayPilot.JSON.stringify($24));var end=new Date();};this.drawSeparators=function(){if(!this.separators){return;};for(var i=0;i<this.separators.length;i++){this.drawSeparator(i);}};this.drawEvents=function($25){var $26=10;if(!$25){$f.divEvents=document.createElement("div");$f.divEvents.style.position='absolute';$f.maind.appendChild(this.divEvents);};this.divEvents.style.display='none';var $27=this.dynamicEventRendering==='Progressive';var top=this.nav.scroll.scrollTop;var $0U=top+this.nav.scroll.clientHeight;if(this.clientSide){for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];var $28=$p.Top-this.dynamicEventRenderingMargin;var $29=$28+$p.Height+2*this.dynamicEventRenderingMargin;if($27&&($0U<=$28||top>=$29)){continue;};for(var j=0;j<$p.lines.length;j++){var $1F=$p.lines[j];for(var k=0;k<$1F.length;k++){var e=$1F[k];if(!e.part.top){e.part.top=j*this.eventHeight;e.part.height=this.eventHeight-2;e.part.right=e.part.left+e.part.width;e.part.fullTop=this.rows[e.part.dayIndex].Top+e.Top;e.part.fullBottom=e.part.fullTop+e.part.height;};var $2a=this.drawEvent(e);if($25&&$2a){$26--;if($26<=0){window.setTimeout(function(){$f.drawEvents($25);},0);return;}}}}}}else{var $2b=this.events.list.length;for(var i=0;i<$2b;i++){this.drawEvent(this.events.list[i]);}};this.divEvents.style.display='';this.loadingStop();this.multiselect.redraw();};this.drawEventsInRow=function($2c){var $p=this.rows[$2c];this.divEvents=document.createElement("div");this.divEvents.style.position='absolute';this.divEvents.style.display='none';this.maind.appendChild(this.divEvents);for(var j=0;j<$p.lines.length;j++){var $1F=$p.lines[j];for(var k=0;k<$1F.length;k++){var e=$1F[k];e.part.top=j*this.eventHeight;e.part.height=this.eventHeight-2;e.part.right=e.part.left+e.part.width;e.part.fullTop=this.rows[e.part.dayIndex].Top+e.Top;e.part.fullBottom=e.part.fullTop+e.part.height;this.drawEvent(e);}};this.divEvents.style.display='';this.multiselect.redraw();};this.deleteEvents=function(){if(this.elements.events){var length=this.elements.events.length;for(var i=0;i<length;i++){var $R=this.elements.events[i];this.deleteEvent($R);}};this.elements.events=[];};this.deleteEventsInRow=function($2c){if(this.elements.events){var length=this.elements.events.length;var $2d=[];for(var i=0;i<length;i++){var $R=this.elements.events[i];if($R.row==$2c){this.deleteEvent($R);$2d.push(i);}};for(var i=$2d.length-1;i>=0;i--){this.elements.events.splice($2d[i],1);}}};this.deleteEvent=function($R){$R.onclick=null;$R.oncontextmenu=null;$R.onmouseover=null;$R.onmouseout=null;$R.onmousemove=null;$R.onmousedown=null;$R.ondblclick=null;$R.event=null;$R.data.rendered=null;$R.data=null;if($R.parentNode){$R.parentNode.removeChild($R);}};this.deleteOldEvents=function($2e){if(!$2e){$2e=0;};if(this.dynamicEventRendering!=='Progressive'){return;};var $X=new Date();this.divEvents.style.display='none';var $2f=[];var $2g=0;var length=this.elements.events.length;for(var i=length-1;i>=0;i--){var $R=this.elements.events[i];if(this.oldEvent($R.data)){if($2e>0){$2e--;$2f.unshift($R);}else{this.deleteEvent($R);$2g++;}}else{$2f.unshift($R);}};this.elements.events=$2f;var end=new Date();var $b=end.getTime()-$X.getTime();this.divEvents.style.display='';};this.deleteSeparators=function(){if(this.elements.separators){for(var i=0;i<this.elements.separators.length;i++){var $R=this.elements.separators[i];DayPilot.pu($R);$R.parentNode.removeChild($R);}};this.elements.separators=[];};this.hiddenEvents=function(){var $27=this.dynamicEventRendering==='Progressive';if(!this.nav.scroll){return false;};var top=this.nav.scroll.scrollTop;var $0U=top+this.nav.scroll.clientHeight;for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];var $28=$p.Top;var $29=$p.Top+$p.Height;if($27&&($0U<=$28||top>=$29)){continue;};for(var j=0;j<$p.lines.length;j++){var $1F=$p.lines[j];for(var k=0;k<$1F.length;k++){var e=$1F[k];if(this.hiddenEvent(e)){return true;}}}};return false;};this.hiddenEvent=function($0d){if($0d.rendered){return false;};var $27=this.dynamicEventRendering==='Progressive';var $P=this.nav.scroll.scrollLeft;var $Q=$P+this.nav.scroll.clientWidth;var $2h=$0d.Left;var $2i=$0d.Left+$0d.Width;if($27&&($Q<=$2h||$P>=$2i)){return false;};return true;};this.oldEvent=function($0d){if(!$0d.rendered){return true;};var top=this.nav.scroll.scrollTop;var $0U=top+this.nav.scroll.clientHeight;var $P=this.nav.scroll.scrollLeft;var $Q=$P+this.nav.scroll.clientWidth;var $2h=$0d.Left;var $2i=$0d.Right;var $2j=$0d.FullTop;var $2k=$0d.FullBottom;if($Q<=$2h||$P>=$2i){return true;};if($0U<=$2j||top>=$2k){return true;};return false;};this.drawEvent=function($0d){if($0d.rendered){return false;};var $27=this.dynamicEventRendering==='Progressive';var $P=this.nav.scroll.scrollLeft-this.dynamicEventRenderingMargin;var $Q=$P+this.nav.scroll.clientWidth+2*this.dynamicEventRenderingMargin;var $2h=$0d.part.left;var $2i=$0d.part.left+$0d.part.width;if($27&&($Q<=$2h||$P>=$2i)){return false;};var $2c=$0d.part.dayIndex;var $y=($f.eventBorderVisible?$0d.part.width:$0d.part.width+1);var $z=($f.eventBorderVisible?$0d.part.height:$0d.part.height+1);var $p=this.rows[$2c];if($p.Hidden){return false;};var $28=$p.Top;var $R=document.createElement("div");$R.data=$0d;$R.style.position='absolute';$R.style.left=$0d.part.left+'px';$R.style.top=($28+$0d.part.top)+'px';$R.style.width=$y+'px';$R.style.height=$z+'px';if($f.eventBorderVisible){$R.style.border='1px solid '+this.eventBorderColor;};$R.style.backgroundColor=$0d.client.backColor();$R.style.whiteSpace='nowrap';$R.style.fontSize=this.eventFontSize;$R.style.overflow='hidden';$R.style.cursor='default';$R.style.fontFamily=this.eventFontFamily;$R.style.color=$0d.data.fontColor||this.eventFontColor;$R.className=$0d.client.cssClass()?$0d.client.cssClass():this.applyCssClass("event");$R.unselectable='on';if(this.showToolTip){$R.title=$0d.client.toolTip();};if($0d.data.backgroundImage&&!this.durationBarVisible){$R.style.backgroundImage="url("+$0d.data.backgroundImage+")";if($0d.data.backgroundRepeat){$R.style.backgroundRepeat=$0d.data.backgroundRepeat;}};if(this.rounded()){$R.style.MozBorderRadius="5px";$R.style.webkitBorderRadius="5px";$R.style.borderRadius="5px";};$R.onmousemove=this.onEventMouseMove;$R.onmousedown=this.onEventMouseDown;if($0d.client.clickEnabled()){$R.onclick=this.eventClickDispatch;};if($0d.client.doubleClickEnabled()){$R.ondblclick=this.eventDoubleClickDispatch;};$R.oncontextmenu=this.eventRightClickDispatch;if(this.bubble&&this.eventHoverHandling==='Bubble'){$R.onmouseout=function(){$f.bubble.hideOnMouseOut();};};var $2l=[];var $2m=0;if($0d.client.barVisible()){$2m=$f.durationBarHeight;$2l.push("<div unselectable='on' style='left:0px;background-color:white;width:");$2l.push($0d.part.barLeft);$2l.push("px;height:2px;font-size:1px;position:absolute'></div>");$2l.push("<div unselectable='on' style='left:");$2l.push($0d.part.barLeft+$0d.part.barWidth);$2l.push("px;background-color:white;width:");$2l.push($y-($0d.part.barLeft+$0d.part.barWidth));$2l.push("px;height:2px;font-size:1px;position:absolute'></div>");$2l.push("<div unselectable='on' style='width:");$2l.push($0d.part.barWidth);$2l.push("px;margin-left:");$2l.push($0d.part.barLeft);$2l.push("px;height:");$2l.push($2m-1);$2l.push("px;background-color:");$2l.push($0d.client.barColor());if($0d.data.durationBarImageUrl){$2l.push(";background-image:url(");$2l.push($0d.data.durationBarImageUrl);$2l.push(")");};$2l.push(";font-size:1px;position:relative'></div>");$2l.push("<div unselectable='on' style='width:");$2l.push($y);$2l.push("px;height:1px;background-color:");$2l.push(this.eventBorderColor);$2l.push(";font-size:1px;overflow:hidden;position:relative'></div>");};$2l.push("<div unselectable='on' style='padding-left:1px;width:");$2l.push($y-1);$2l.push("px;height:");$2l.push($z-$2m);$2l.push("px;");if($f.rtl){$2l.push("direction:rtl;");};if($0d.data.backgroundImage&&this.durationBarVisible){$2l.push("background-image:url(");$2l.push($0d.data.backgroundImage);$2l.push(");");if($0d.data.backgroundRepeat){$2l.push("background-repeat:");$2l.push($0d.data.backgroundRepeat);$2l.push(";");}};$2l.push("'>");$2l.push($0d.client.innerHTML());$2l.push("</div>");$R.innerHTML=$2l.join('');$R.row=$2c;this.elements.events.push($R);this.divEvents.appendChild($R);$0d.rendered=true;$R.event=$0d;if($f.multiselect.shouldBeSelected($R.event)){$f.multiselect.add($R.event);};if($f.afterEventRender){$f.afterEventRender($R.event,$R);};return true;};this.updateEventTops=function(){for(var i=0;i<this.elements.events.length;i++){var $R=this.elements.events[i];var $0d=$R.data;var $2c=$0d.part.dayIndex;var $p=this.rows[$2c];var $28=$p.Top;$R.style.top=($28+$0d.part.top)+'px';}};this.findEventDiv=function(e){for(var i=0;i<this.elements.events.length;i++){var $R=this.elements.events[i];if($R.event==e){return $R;}};return null;};this.onEventMouseMove=function(ev){ev=ev||window.event;if($f.cellBubble){$f.cellBubble.delayedHide();};$f.eventUpdateCursor(this,ev);if(ev.srcElement){ev.srcElement.insideEvent=true;}else{ev.insideEvent=true;}};this.onEventMouseDown=function(ev){$f.crosshairHide();$f.stopScroll();ev=ev||window.event;var $u=ev.which||ev.button;if((this.style.cursor==='w-resize'||this.style.cursor==='e-resize')&&$u===1){DayPilotScheduler.resizing=this;DayPilotScheduler.originalMouse=DayPilot.mc(ev);DayPilotScheduler.originalWidth=this.offsetWidth;DayPilotScheduler.originalLeft=this.offsetLeft;document.body.style.cursor=this.style.cursor;}else if(this.style.cursor==='move'&&$u===1){var mv=this;if($f.dragOutAllowed){DayPilotScheduler.moving=mv;}else{DayPilotScheduler.moving=mv;};DayPilotScheduler.originalMouse=DayPilot.mc(ev);DayPilotScheduler.originalLeft=this.offsetLeft;DayPilotScheduler.originalTop=this.offsetTop;DayPilotScheduler.moveOffsetX=DayPilot.mo2(this,ev).x;DayPilotScheduler.moveDragStart=$f.getDate($f.coords.x,true);document.body.style.cursor='move';}else{};ev.cancelBubble=true;return false;};this.eventUpdateCursor=function($R,ev){var $2n=this.eventResizeMargin;var $2o=this.eventMoveMargin;var $i=$R;if(typeof(DayPilotScheduler)==='undefined'){return;};var $09=DayPilot.mo2($R,ev);if(!$09){return;};$f.eventOffset=$09;if(DayPilotScheduler.resizing){return;};var $2p=$R.getAttribute("dpStart")===$R.getAttribute("dpPartStart");var $2q=$R.getAttribute("dpEnd")===$R.getAttribute("dpPartEnd");if($f.moveBy==='Top'&&$09.y<=$2o&&$i.data.client.moveEnabled()&&$f.eventMoveHandling!=='Disabled'){if($2p){$R.style.cursor='move';}else{$R.style.cursor='not-allowed';}}else if($f.moveBy==='Top'&&$09.x<=$2n&&$i.data.client.resizeEnabled()&&$f.eventResizeHandling!=='Disabled'){if($2p){$R.style.cursor="w-resize";$R.dpBorder='left';}else{$R.style.cursor='not-allowed';}}else if($f.moveBy==='Left'&&$09.x<=$2o&&$i.data.client.moveEnabled()&&$f.eventMoveHandling!=='Disabled'){if($2p){$R.style.cursor="move";}else{$R.style.cursor='not-allowed';}}else if($R.offsetWidth-$09.x<=$2n&&$i.data.client.resizeEnabled()&&$f.eventResizeHandling!=='Disabled'){if($2q){$R.style.cursor="e-resize";$R.dpBorder='right';}else{$R.style.cursor='not-allowed';}}else if(!DayPilotScheduler.resizing&&!DayPilotScheduler.moving){if($i.data.client.clickEnabled()&&$f.eventClickHandling!=='Disabled'){$R.style.cursor='pointer';}else{$R.style.cursor='default';}};if(typeof(DayPilotBubble)!=='undefined'&&$f.bubble&&$f.eventHoverHandling==='Bubble'){if($R.style.cursor==='default'||$R.style.cursor==='pointer'){$f.bubble.showEvent($R.event);}else{DayPilotBubble.hideActive();}}};this.cellCount=function(){if(this.viewType==='Resources'){return this.timeline.length;}else{return Math.floor(24*60/this.cellDuration);}};this.getSelection=function($v){var $p=$f.rows[$v.start.y];var $0x=$p.Value;var $2r=$v.end.x>$v.start.x?$v.start.x:$v.end.x;var $2s=($v.end.x>$v.start.x?$v.end.x:$v.start.x);var $q=$p.Start.getTime()-this.startDate.getTime();var $X=this.timeline[$2r].start.addTime($q);var end=this.timeline[$2s].end.addTime($q);return new DayPilot.Selection($X,end,$0x,$f);};this.createEdit=function($i){var $2t=$i.parentNode;var $2u=document.createElement('textarea');$2u.style.position='absolute';$2u.style.width=(($i.offsetWidth<100)?100:($i.offsetWidth-2))+'px';$2u.style.height=($i.offsetHeight-2)+'px';$2u.style.fontFamily=DayPilot.gs($i,'fontFamily')+DayPilot.gs($i,'font-family');$2u.style.fontSize=DayPilot.gs($i,'fontSize')+DayPilot.gs($i,'font-size');$2u.style.left=$i.offsetLeft+'px';$2u.style.top=$i.offsetTop+'px';$2u.style.border='1px solid black';$2u.style.padding='0px';$2u.style.marginTop='0px';$2u.style.backgroundColor='white';$2u.value=DayPilot.tr($i.event.text());$2u.event=$i.event;$2t.appendChild($2u);return $2u;};this.divEdit=function($i){if(DayPilotScheduler.editing){DayPilotScheduler.editing.blur();return;};var $2u=this.createEdit($i);DayPilotScheduler.editing=$2u;$2u.onblur=function(){var $2v=$i.event.text();var $0y=$2u.value;DayPilotScheduler.editing=null;if($2u.parentNode){$2u.parentNode.removeChild($2u);};if($2v===$0y){return;};$i.style.display='none';$f.eventEditDispatch($i.event,$0y);};$2u.onkeypress=function(e){var $2w=(window.event)?event.keyCode:e.keyCode;if($2w===13){this.onblur();return false;}else if($2w===27){$2u.parentNode.removeChild($2u);DayPilotScheduler.editing=false;};return true;};$2u.select();$2u.focus();};this.onResMouseMove=function(td){if(typeof(DayPilotBubble)!=='undefined'){if($f.cellBubble){$f.cellBubble.hideOnMouseOut();};if($f.resourceBubble){var $0G={};$0G.calendar=$f;$0G.id=td.getAttribute("resource");$0G.toJSON=function(){var $0C={};$0C.id=this.id;return $0C;};$f.resourceBubble.showResource($0G);}}};this.onResMouseOut=function(){if(typeof(DayPilotBubble)!=='undefined'&&$f.resourceBubble){$f.resourceBubble.hideOnMouseOut();}};this.onCellMouseOut=function(){if(typeof(DayPilotBubble)!=='undefined'&&$f.cellBubble){$f.cellBubble.hideOnMouseOut();}};this.updateHeaders=function(){var $S=[];$S.push("<table cellspacing='0' cellpadding='0' style='color:");$S.push($f.headerFontColor);$S.push(";'><tr>");$S.push($f.row1);$S.push("</tr><tr>");$S.push($f.row2);$S.push("</tr></table>");DayPilot.puc($f.divNorth);$f.divNorth.innerHTML=$S.join('');var $2x=$f.divCorner;$2x.style.backgroundColor=$f.cornerBackColor;$2x.innerHTML=$f.cornerHTML;};this.drawTimeHeader=function(){var $1f=document.createElement("table");$1f.cellSpacing=0;$1f.cellPadding=0;$1f.style.color=$f.headerFontColor;$1f.style.border="0px none";for(var i=0;i<this.timeHeader.length-1;i++){var $1M=$1f.insertRow(-1);this.drawTimeHeaderGroups($1M,i);};var $1P=$1f.insertRow(-1);this.drawTimeHeaderCols($1P);var $2y=this.divNorth;DayPilot.puc($2y);$2y.innerHTML='';$2y.appendChild($1f);$2y.style.width=(this.cellCount()*this.cellWidth+5000)+"px";var $2x=this.divCorner;$2x.style.backgroundColor=this.cornerBackColor;$2x.innerHTML=this.cornerHTML;this.divStretch.style.width=(this.timeline.length*this.cellWidth)+"px";};this.drawTimeHeaderGroups=function($p,$0V){if(this.timeHeader){if(this.timeHeader.length-1<=$0V){throw "Not enough timeHeader rows";};for(var i=0;i<this.timeHeader[$0V].length;i++){var $00=this.timeHeader[$0V][i];if(!$00.toolTip){$00.toolTip=$00.innerHTML;};if(!$00.backColor){$00.backColor=this.hourNameBackColor;};$00.colSpan=$00.width/this.cellWidth;this.drawTimeHeaderCell($p,$00);};return;};for(var i=0;i<this.groupline.length;i++){var g=this.groupline[i];var $K=this.getGroupName(g.start);var $00={};$00.innerHTML=$K;$00.toolTip=$K;$00.start=g.start;$00.end=g.end;$00.type='Group';$00.backColor=this.hourNameBackColor;$00.width=g.width;$00.colSpan=g.width/this.cellWidth;var $2z=this.beforeTimeHeaderRender?this.beforeTimeHeaderRender($00):null;if($2z){$00=$2z;};this.drawTimeHeaderCell($p,$00);}};this.getGroupName=function($2A){var $K=null;switch(this.cellGroupBy){case 'Hour':$K=$2A.getHours();break;case 'Day':$K=$2A.toString();break;case 'Week':$K='Week';break;case 'Month':$K=($2A.getMonth()+1)+'/'+$2A.getYear();break;case 'Year':$K=$2A.getYear();break;case 'None':$K='';break;default:throw 'Invalid cellGroupBy value';};return $K;};this.addGroupSize=function($2A){var $2B=this.viewType==='Resources'?this.days:1;var $Z=this.startDate.addDays($2B);switch(this.cellGroupBy){case 'Hour':to=$2A.addHours(1);break;case 'Day':to=$2A.addDays(1);break;case 'Week':to=$2A.addDays(1);while(to.dayOfWeek()!==this.weekStarts){to=to.addDays(1);};break;case 'Month':to=$2A.addMonths(1);to=to.firstDayOfMonth();var $2C=(DayPilot.Date.diff(to.d,$2A.d)/(1000.0*60))%this.cellDuration===0;while(!$2C){to=to.addHours(1);$2C=(DayPilot.Date.diff(to.d,$2A.d)/(1000.0*60))%this.cellDuration===0;};break;case 'Year':to=$2A.addYears(1);to=to.firstDayOfYear();var $2C=(DayPilot.Date.diff(to.d,$2A.d)/(1000.0*60))%this.cellDuration===0;while(!$2C){to=to.addHours(1);$2C=(DayPilot.Date.diff(to.d,$2A.d)/(1000.0*60))%this.cellDuration===0;};break;case 'None':to=$Z;break;default:throw 'Invalid cellGroupBy value';};if(to.getTime()>$Z.getTime()){to=$Z;};return to;};this.drawTimeHeaderCell=function($p,$00){var td=$p.insertCell(-1);td.colSpan=$00.colSpan;td.unselectable="on";td.style.height=(this.headerHeight-1)+"px";td.style.textAlign="center";td.style.backgroundColor=$00.backColor;td.style.fontFamily=this.hourFontFamily;td.style.fontSize=this.hourFontSize;td.style.color=this.headerFontColor;td.style.KhtmlUserSelect='none';td.style.MozUserSelect='none';td.style.whiteSpace='nowrap';td.style.overflow='hidden';td.style.width=$00.width+"px";td.style.cursor='default';td.style.padding='0px';td.style.border='0px none';td.style.borderBottom="1px solid "+this.borderColor;td.className=this.applyCssClass('timeheadergroup');td.oncontextmenu=function(){return false;};var $R=document.createElement("div");$R.unselectable="on";$R.style.height=(this.headerHeight-1)+"px";$R.style.borderRight="1px solid "+this.hourNameBorderColor;$R.style.overflow='hidden';$R.style.width=($00.width-1)+"px";$R.title=$00.toolTip;$R.innerHTML=$00.innerHTML;td.appendChild($R);};this.drawTimeHeaderCols=function($p){var $2D=this.cellCount();var td=document.createElement("td");td.unselectable="on";td.style.borderTop="0px none";td.style.borderBottom="0px none";td.style.borderLeft="0px none";td.style.borderRight="0px none";td.style.width=this.cellWidth+"px";td.style.height=(this.headerHeight-1)+"px";td.style.overflow='hidden';td.style.textAlign='center';td.style.fontFamily=this.hourFontFamily;td.style.fontSize=this.hourFontSize;td.style.color=this.headerFontColor;td.style.KhtmlUserSelect='none';td.style.MozUserSelect='none';td.style.cursor='default';td.style.padding='0px';td.className=this.applyCssClass('timeheadercol');var $R=document.createElement("div");$R.unselectable="on";$R.style.height=(this.headerHeight)+"px";$R.style.borderRight="1px solid "+this.hourNameBorderColor;$R.style.width=(this.cellWidth-1)+"px";$R.style.overflow='hidden';$R.style.position='relative';td.appendChild($R);var $0V=this.timeHeader.length-1;for(var i=0;i<$2D;i++){var $00;if(this.timeHeader){$00=this.timeHeader[$0V][i];if(!$00.backColor){$00.backColor=this.hourNameBackColor;};if(!$00.toolTip){$00.toolTip=$00.innerHTML;}}else{var c=this.timeline[i];var $K=this.getColName(c.start);var $00={};$00.innerHTML=$K;$00.toolTip=$K;$00.start=c.start;$00.end=c.end;$00.type='Cell';$00.backColor=this.hourNameBackColor;var $2z=this.beforeTimeHeaderRender?this.beforeTimeHeaderRender($00):null;if($2z){$00=$2z;}};var $2E=td.cloneNode(true);$2E.style.backgroundColor=$00.backColor;$2E.firstChild.title=$00.toolTip;$2E.firstChild.innerHTML=$00.innerHTML;$2E.oncontextmenu=function(){return false;};$p.appendChild($2E);}};this.getColName=function($2A){var $K=null;if(this.cellDuration<60){$K=$2A.getMinutes();}else if(this.cellDuration<1440){$K=$2A.getHours();}else{$K=$2A.getDay();};return $K;};this.updateRowHeights=function(){for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];var $2f=$p.height()+$p.MarginBottom;if($p.Height!==$2f){this.rowsDirty=true;};$p.Height=$2f;}};this.updateRowHeaderHeights=function(){var $1X=this.divHeader;if(!$1X){return;};var $0W=this.rows.length;var $0M=this.rowHeaderCols?this.rowHeaderCols.length:1;var j=0;for(var i=0;i<$0W;i++){var $p=this.rows[i];if($p.Hidden){continue;};for(var c=0;c<$0M;c++){var $2F=$1X.rows[j].cells[c];var $2G=$p.Height-1;if($2F.firstChild&&$2F.firstChild&&parseInt($2F.firstChild.style.height,10)!==$2G){$2F.firstChild.style.height=$2G+"px";}};j++;}};this.drawSeparator=function($0V){var s=this.separators[$0V];var $0Y=new DayPilot.Date(s.Location);var $2H=s.Color;var $y=s.Width?s.Width:1;var $2I=s.Layer?s.Layer==='AboveEvents':false;var $O=s.Opacity?s.Opacity:100;if($0Y.getTime()<this.startDate.getTime()){return;};if($0Y.getTime()>=this.startDate.addDays(this.days).getTime()){return;};var $H=this.getPixels($0Y);if($H.cut){return;};if($H.left<0){return;};if($H.left>this.cellCount()*this.cellWidth){return;};var $1F=document.createElement("div");$1F.style.width=$y+'px';$1F.style.height=$f.innerHeightTree+'px';$1F.style.position='absolute';$1F.style.left=$H.left+'px';$1F.style.top='0px';$1F.style.backgroundColor=$2H;$1F.style.opacity=$O/100;$1F.style.filter="alpha(opacity="+$O+")";if($2I){this.divSeparatorsAbove.appendChild($1F);}else{this.divSeparators.appendChild($1F);};this.elements.separators.push($1F);};this.onMaindDblClick=function(ev){if(DayPilotScheduler.timeRangeTimeout){clearTimeout(DayPilotScheduler.timeRangeTimeout);DayPilotScheduler.timeRangeTimeout=null;};var $v={};if(!$f.coords){var $2J=$f.maind;$f.coords=DayPilot.mo2($2J,ev);};ev=ev||window.event;var $u=ev.which||ev.button;if($f.isWithinRange($f.coords)){var $x=$f.getSelection(DayPilotScheduler.rangeHold);$f.timeRangeDoubleClickDispatch($x.start,$x.end,$x.resource);}else{$f.rangeFromCoords();var $x=$f.getSelection(DayPilotScheduler.range);$f.timeRangeDoubleClickDispatch($x.start,$x.end,$x.resource);};DayPilotScheduler.rangeHold=DayPilotScheduler.range;DayPilotScheduler.range=null;};this.clearDblClickTimeout=function(){$f.dblclick=null;};this.onMaindMouseDown=function(ev){if(DayPilotScheduler.timeRangeTimeout&&false){clearTimeout(DayPilotScheduler.timeRangeTimeout);DayPilotScheduler.timeRangeTimeout=null;};$f.crosshairHide();$f.stopScroll();if(!$f.coords){var $2J=$f.maind;$f.coords=DayPilot.mo2($2J,ev);};ev=ev||window.event;var $u=ev.which||ev.button;if($u===2||($u===3&&$f.isWithinRange($f.coords))){return false;};if($f.timeRangeSelectedHandling==='Disabled'){return false;};$f.rangeFromCoords();return false;};this.rangeFromCoords=function(){var $v={};$v.start={y:$f.getRow($f.coords.y).i,x:Math.floor($f.coords.x/$f.cellWidth)};$v.end={x:Math.floor($f.coords.x/$f.cellWidth)};$v.calendar=$f;DayPilotScheduler.range=$v;$f.drawRange();};this.onMaindMouseMove=function(ev){DayPilotScheduler.activeCalendar=this;ev=ev||window.event;var $j=DayPilot.mc(ev);$f.coords=DayPilot.mo2($f.maind,ev);if(DayPilotScheduler.resizing){if(!DayPilotScheduler.resizingShadow){DayPilotScheduler.resizingShadow=DayPilotScheduler.createShadow(DayPilotScheduler.resizing,$f.shadow);};var $2K=DayPilotScheduler.resizing.event.calendar.cellWidth;var $2L=0;var $2M=($j.x-DayPilotScheduler.originalMouse.x);if(DayPilotScheduler.resizing.dpBorder==='right'){var $2N;if($f.snapToGrid){$2N=Math.ceil(((DayPilotScheduler.originalWidth+DayPilotScheduler.originalLeft+$2M))/$2K)*$2K-DayPilotScheduler.originalLeft;}else{$2N=DayPilotScheduler.originalWidth+DayPilotScheduler.originalLeft+$2M-DayPilotScheduler.originalLeft;};if($2N<$2K){$2N=$2K;};var $1I=$f.maind.clientWidth;if(DayPilotScheduler.originalLeft+$2N>$1I){$2N=$1I-DayPilotScheduler.originalLeft;};DayPilotScheduler.resizingShadow.style.width=($2N-4)+'px';}else if(DayPilotScheduler.resizing.dpBorder==='left'){var $2O;if($f.snapToGrid){$2O=Math.floor(((DayPilotScheduler.originalLeft+$2M-$2L)+$2K/2) / $2K)*$2K+$2L;}else{$2O=DayPilotScheduler.originalLeft+$2M-$2L+$2L;};if($2O<$2L){$2O=$2L;};var $2N=DayPilotScheduler.originalWidth-($2O-DayPilotScheduler.originalLeft);if($2N<$2K){$2N=$2K;}else{DayPilotScheduler.resizingShadow.style.left=$2O+'px';};DayPilotScheduler.resizingShadow.style.width=($2N-4)+'px';}}else if(DayPilotScheduler.moving){if(!DayPilotScheduler.movingShadow){var mv=DayPilotScheduler.moving;var $b=mv.offsetWidth/$f.cellWidth*$f.cellDuration*60;DayPilotScheduler.movingShadow=$f.createShadow($b,mv,$f.shadow);};DayPilotScheduler.moving.target=$f;$f.moveShadow();}else if(DayPilotScheduler.range){var $v=DayPilotScheduler.range;$v.end={x:Math.floor($f.coords.x/$f.cellWidth)};$f.drawRange();}else if($f.crosshairType!=='Disabled'){$f.updateCrosshairPosition();};var $2P=ev.insideEvent;if(window.event){$2P=window.event.srcElement.insideEvent;};if($f.cellBubble&&$f.coords&&$f.rows&&$f.rows.length>0&&!$2P){var x=Math.floor($f.coords.x/$f.cellWidth);var y=$f.getRow($f.coords.y).i;if(y<$f.rows.length){var $00={};$00.calendar=$f;$00.start=$f.timeline[x].start;$00.end=$f.timeline[x].end;$00.resource=$f.rows[y].Value;$00.toJSON=function(){var $0C={};$0C.start=this.start;$0C.end=this.end;$0C.resource=this.resource;return $0C;};$f.cellBubble.showCell($00);}};if(DayPilotScheduler.drag){$f.crosshairHide();if(DayPilotScheduler.gShadow){document.body.removeChild(DayPilotScheduler.gShadow);};DayPilotScheduler.gShadow=null;if(!DayPilotScheduler.movingShadow&&$f.coords&&$f.rows.length>0){if(!DayPilotScheduler.moving){DayPilotScheduler.moving={};var event=DayPilotScheduler.drag.event;if(!event){var $2Q=new DayPilot.Date().getDatePart();var ev={'value':DayPilotScheduler.drag.id,'start':$2Q,'end':$2Q.addSeconds(DayPilotScheduler.drag.duration),'text':DayPilotScheduler.drag.text};event=new DayPilot.Event(ev);event.calendar=$f;};DayPilotScheduler.moving.event=event;};DayPilotScheduler.movingShadow=$f.createShadow(DayPilotScheduler.drag.duration,$f.shadow,DayPilotScheduler.drag.shadowType);};ev.cancelBubble=true;};if($f.autoScroll=="Always"||($f.autoScroll=="Drag"&&(DayPilotScheduler.moving||DayPilotScheduler.resizing||DayPilotScheduler.range))){var $2R=$f.nav.scroll;var $0R={x:$f.coords.x,y:$f.coords.y};$0R.x-=$2R.scrollLeft;$0R.y-=$2R.scrollTop;var $y=$2R.clientWidth;var $z=$2R.clientHeight;var $o=20;var $P=$0R.x<$o;var $Q=$y-$0R.x<$o;var top=$0R.y<$o;var $0U=$z-$0R.y<$o;var x=0;var y=0;if($P){x=-5;};if($Q){x=5;};if(top){y=-5;};if($0U){y=5;};if(x||y){$f.startScroll(x,y);}else{$f.stopScroll();}}};this.updateCrosshairPosition=function(){if($f.coords&&$f.rows&&$f.rows.length>0){var x=Math.floor($f.coords.x/$f.cellWidth);var y=$f.getRow($f.coords.y).i;if(y<$f.rows.length){$f.crosshair(x,y);}}};this.crosshairHide=function(){this.divCrosshair.innerHTML='';this.crosshairVertical=null;this.crosshairHorizontal=null;if(this.crosshairTop&&this.crosshairTop.parentNode){this.crosshairTop.parentNode.removeChild(this.crosshairTop);this.crosshairTop=null;};if(this.crosshairLeft){for(var i=0;i<this.crosshairLeft.length;i++){var ch=this.crosshairLeft[i];if(ch.parentNode){ch.parentNode.removeChild(ch);}};this.crosshairLeft=null;};this.crosshairLastX=-1;this.crosshairLastY=-1;};this.crosshair=function(x,y){var $d=this.crosshairType;var $p=this.getRowByIndex(y);if($d==='Full'){var $P=x*this.cellWidth;var $1F=this.crosshairVertical;if(!$1F){var $1F=document.createElement("div");$1F.style.width=this.cellWidth+'px';$1F.style.height=$f.innerHeightTree+'px';$1F.style.position='absolute';$1F.style.top='0px';$1F.style.backgroundColor=this.crosshairColor;$1F.style.opacity=this.crosshairOpacity/100;$1F.style.filter="alpha(opacity="+this.crosshairOpacity+")";this.crosshairVertical=$1F;this.divCrosshair.appendChild($1F);};$1F.style.left=$P+'px';var top=$p.top;var $z=$p.height;var $y=this.cellCount()*this.cellWidth;var $1F=this.crosshairHorizontal;if(!$1F){var $1F=document.createElement("div");$1F.style.width=$y+'px';$1F.style.height=$z+'px';$1F.style.position='absolute';$1F.style.top=top+'px';$1F.style.left='0px';$1F.style.backgroundColor=this.crosshairColor;$1F.style.opacity=this.crosshairOpacity/100;$1F.style.filter="alpha(opacity="+this.crosshairOpacity+")";this.crosshairHorizontal=$1F;this.divCrosshair.appendChild($1F);};$1F.style.top=top+'px';$1F.style.height=$z+'px';};if(this.crosshairLastX!==x){if(this.crosshairTop&&this.crosshairTop.parentNode){this.crosshairTop.parentNode.removeChild(this.crosshairTop);this.crosshairTop=null;};var $1F=document.createElement("div");$1F.style.width=this.cellWidth+"px";$1F.style.height=this.headerHeight+"px";$1F.style.left='0px';$1F.style.top='0px';$1F.style.position='absolute';$1F.style.backgroundColor=this.crosshairColor;$1F.style.opacity=this.crosshairOpacity/100;$1F.style.filter="alpha(opacity="+this.crosshairOpacity+")";this.crosshairTop=$1F;var $2y=this.divNorth;if($2y.firstChild.rows[1].cells[x]){$2y.firstChild.rows[1].cells[x].firstChild.appendChild($1F);}};if(this.crosshairLastY!==y){if(this.crosshairLeft){for(var i=0;i<this.crosshairLeft.length;i++){var ch=this.crosshairLeft[i];if(ch.parentNode){ch.parentNode.removeChild(ch);}};this.crosshairLeft=null;};var $0M=this.rowHeaderCols?this.rowHeaderCols.length:1;this.crosshairLeft=[];for(var i=0;i<$0M;i++){var $y=this.rowHeaderCols?this.rowHeaderCols[i]:this.rowHeaderWidth;var $1F=document.createElement("div");$1F.style.width=$y+"px";$1F.style.height=$p.height+"px";$1F.style.left='0px';$1F.style.top='0px';$1F.style.position='absolute';$1F.style.backgroundColor=this.crosshairColor;$1F.style.opacity=this.crosshairOpacity/100;$1F.style.filter="alpha(opacity="+this.crosshairOpacity+")";this.crosshairLeft.push($1F);this.divHeader.rows[$p.i].cells[i].firstChild.appendChild($1F);}};this.crosshairLastX=x;this.crosshairLastY=y;};this.onMaindRightClick=function(ev){ev=ev||window.event;if($f.timeRangeSelectedHandling==='Disabled'){return false;};if(!$f.isWithinRange($f.coords)){$f.onMaindClick(ev);};if($f.contextMenuSelection){var $2S=$f.getSelection(DayPilotScheduler.rangeHold);$f.contextMenuSelection.show($2S);};ev.cancelBubble=true;return false;};this.isWithinRange=function($0R){var $v=DayPilotScheduler.rangeHold;if(!$v||!$v.start||!$v.end){return false;};var $p=this.getRowByIndex($v.start.y);var $2T=$v.start.x<$v.end.x;var $2U=($2T?$v.start.x:$v.end.x)*this.cellWidth;var $2V=($2T?$v.end.x:$v.start.x)*this.cellWidth+this.cellWidth;var $2W=$p.top;var $2X=$p.bottom;if($0R.x>=$2U&&$0R.x<=$2V&&$0R.y>=$2W&&$0R.y<=$2X){return true;};return false;};this.drawRange=function(){var $v=DayPilotScheduler.range;var $2r=$v.end.x>$v.start.x?$v.start.x:$v.end.x;var $2s=($v.end.x>$v.start.x?$v.end.x:$v.start.x)+1;this.deleteRange();for(var x=$2r;x<$2s;x++){this.drawRangeCell(x,$v.start.y);}};this.onMaindClick=function(ev){if($f.timeRangeSelectedHandling==='Disabled'){return false;};ev=ev||window.event;var $u=ev.which||ev.button;if(DayPilotScheduler.range){return;};if(DayPilotScheduler.rangeHold&&$f.isWithinRange($f.coords)&&($u===3||$u===2)){return;};var $v={};$v.start={y:$f.getRow($f.coords.y).i,x:Math.floor($f.coords.x/$f.cellWidth)};$v.end={x:Math.floor($f.coords.x/$f.cellWidth)};DayPilotScheduler.range=$v;$f.drawRange();DayPilotScheduler.range=null;var $x=$f.getSelection($v);$f.timeRangeSelectedDispatch($x.start,$x.end,$x.resource);DayPilotScheduler.rangeHold=$v;};this.cellClick=function(){var o=this.style.backgroundColor;this.style.backgroundColor='#316AC5';$f.timeRangeSelectedDispatch(this.start,this.end,this.row);this.style.backgroundColor=o;};this.onScroll=function(ev){if($f.dynamicLoading){$f.onScrollDynamic();return;};var $2Y=$f.nav.scroll;$f.scrollPos=$2Y.scrollLeft;$f.scrollTop=$2Y.scrollTop;$f.scrollWidth=$2Y.clientWidth;$f.divTimeScroll.scrollLeft=$f.scrollPos;$f.divResScroll.scrollTop=$f.scrollTop;if($f.refreshTimeout){window.clearTimeout($f.refreshTimeout);};$f.refreshTimeout=window.setTimeout($f.delayedRefresh(),50);$f.onScrollCalled=true;};this.onScrollDynamic=function(){var $2Y=$f.nav.scroll;$f.scrollPos=$2Y.scrollLeft;$f.scrollTop=$2Y.scrollTop;$f.scrollWidth=$2Y.clientWidth;$f.divTimeScroll.scrollLeft=$f.scrollPos;$f.divResScroll.scrollTop=$f.scrollTop;if($f.refreshTimeout){window.clearTimeout($f.refreshTimeout);};$f.refreshTimeout=window.setTimeout($f.delayedRefreshDynamic($2Y.scrollLeft,$2Y.scrollTop),500);};this.delayedRefreshDynamic=function(scrollX,scrollY){return function(){$f.scrollX=scrollX;$f.scrollY=scrollY;$f.callBack2('Scroll');};};this.delayedRefresh=function(){return function(){$f.saveState();$f.drawCells();$f.refreshTimeout=window.setTimeout($f.delayedDrawEvents(),200);};};this.delayedDrawEvents=function(){var $25=false;var $2Z=$f.dynamicEventRenderingCacheSweeping;var $30=$f.dynamicEventRenderingCacheSize;return function(){if($f.hiddenEvents()){$f.loadingStart();window.setTimeout(function(){if($2Z)$f.deleteOldEvents($30);window.setTimeout(function(){$f.drawEvents($25);},50);},50);}};};this.debugHeader=function(){var $31=this.scrollPos;var $32=this.scrollWidth;var x=Math.floor($31/this.cellWidth);var $00=this.timeline[x];this.drawTimeHeaderSection($31,$32);};this.drawCellsFull=function(){var $0F=this.getDrawArea();var $33=$0F.xStart;var $34=$0F.xEnd-$0F.xStart;var $35=$0F.yStart;var $36=$0F.yEnd-$0F.yStart;this.elements.cells=[];for(var i=0;i<$34;i++){var x=$33+i;for(var j=0;j<$36;j++){var y=$35+j;if(!this.rows[y].Hidden){this.drawCell(x,y);}}}};this.drawCells=function(){if(this.rows!==null&&this.rows.length>0){if(this.dirtyColors){this.drawCellsFull();}else{this.drawCellsFast();};this.drawTimeBreaks();};var $y=this.cellCount()*this.cellWidth;this.maind.style.height=this.innerHeightTree+"px";this.maind.style.width=$y+"px";this.rowsDirty=false;};this.drawTimeBreaks=function(){this.elements.cells=[];var $0F=this.getDrawArea();for(var x=$0F.xStart;x<$0F.xEnd;x++){var $37=(x<this.timeline.length-1)?this.timeline[x+1].breakBefore:false;if($37){this.drawTimeBreak(x);}}};this.drawTimeBreak=function(x){var $0V="x"+x;if(this.cache.breaks[$0V]){return;};var $P=x*this.cellWidth+this.cellWidth-1;var $z=this.innerHeightTree;var $1F=document.createElement("div");$1F.style.left=$P+"px";$1F.style.top="0px";$1F.style.width="1px";$1F.style.height=$z+"px";$1F.style.fontSize='1px';$1F.style.lineHeight='1px';$1F.style.overflow='hidden';$1F.style.position='absolute';$1F.style.backgroundColor=this.timeBreakColor;$1F.unselectable='on';this.divBreaks.appendChild($1F);this.elements.breaks.push($1F);this.cache.breaks[$0V]='1';};this.getDrawArea=function(){var $38=30;var $0F={};var $39=Math.floor(this.scrollPos/this.cellWidth);var $3a=Math.ceil(this.scrollWidth/this.cellWidth)+1;var $1d=this.cellCount();var $X=$39-$38;var end=$X+2*$38+$3a;end=Math.min(end,$1d);$X=Math.max($X,0);var $35=this.getRow(this.nav.scroll.scrollTop).i;var $3b=this.getRow(this.nav.scroll.scrollTop+this.nav.scroll.offsetHeight).i;if($3b<this.rows.length){$3b++;};var $36=$3b-$35;$0F.xStart=$X;$0F.xEnd=end;$0F.yStart=$35;$0F.yEnd=$3b;return $0F;};this.drawCellsFast=function(){var $0F=this.getDrawArea();var $X=$0F.xStart;var end=$0F.xEnd;this.elements.cells=[];for(var x=$X;x<end;x++){this.drawCellColumn(x);};for(var y=0;y<this.rows.length;y++){if(!this.rows[y].Hidden){this.drawLine(y);}}};this.drawLine=function(y){var $0V="y"+y;if(this.cache.cells[$0V]){return;};var top=this.rows[y].Top+this.rows[y].Height-1;var $y=this.cellCount()*this.cellWidth;var $1F=document.createElement("div");$1F.style.left="0px";$1F.style.top=top+"px";$1F.style.width=$y+"px";$1F.style.height="1px";$1F.style.fontSize='1px';$1F.style.lineHeight='1px';$1F.style.overflow='hidden';$1F.style.position='absolute';$1F.style.backgroundColor=this.cellBorderColor;$1F.unselectable='on';this.divLines.appendChild($1F);this.elements.cells.push($1F);this.cache.cells[$0V]='1';};this.drawCellColumn=function(x){var $0V="x"+x;var $z=this.innerHeightTree;if(this.cache.cells[$0V]){return;};var $2H=this.getColor(x,0);var $37=(x<this.timeline.length-1)?this.timeline[x+1].breakBefore:false;var $00=document.createElement("div");$00.style.left=(x*this.cellWidth)+"px";$00.style.top="0px";$00.style.width=(this.cellWidth-1)+"px";$00.style.height=$z+"px";$00.style.position='absolute';$00.style.backgroundColor=$2H;$00.unselectable='on';$00.className=this.applyCssClass('cellbackground');this.divCells.appendChild($00);this.elements.cells.push($00);this.cache.cells[$0V]='1';};this.hideRows=function($2A,to){if(!to){to=$2A;};if(to<$2A){return;};if($2A<0||$2A>=this.rows.length){return;};for(var i=$2A;i<=to;i++){this.row[i].Hidden=true;};this.deleteCells();this.drawCells();this.deleteEvents();this.drawEvents();this.drawResHeader();};this.toggle=function(i){var $p=this.rows[i];var $3c=!$p.Expanded;this.rows[i].Expanded=$3c;var $0l=this.updateChildren(i,$p.Expanded);if(!$3c){for(var i=0;i<$0l.length;i++){var ri=$0l[i];this.deleteEventsInRow(ri);}};this.prepareRowTops();this.deleteCells();this.drawCells();if($3c){for(var i=0;i<$0l.length;i++){var ri=$0l[i];this.drawEventsInRow(ri);}};this.updateEventTops();this.drawResHeader();this.updateHeight();this.saveState();var r=this.createDayPilotResource($p);if($3c){this.resourceExpandDispatch(r);}else{this.resourceCollapseDispatch(r);}};this.loadNode=function(i){var $0i={};$0i.index=i;this.callBack2('LoadNode',$0i);};this.updateChildren=function(i,$3d){var $p=this.rows[i];var $3e=[];if($p.Children===null||$p.Children.length===0){return $3e;};for(var k=0;k<$p.Children.length;k++){var $0V=$p.Children[k];this.rows[$0V].Hidden=$3d?!$p.Expanded:true;if($3d==!this.rows[$0V].Hidden){$3e.push($0V);};var $3f=this.updateChildren($0V,$3d);if($3f.length>0){$3e=$3e.concat($3f);}};return $3e;};this.startScroll=function($3g,$3h){this.stopScroll();this.scrollabit($3g,$3h);};this.scrollabitX=function($26){if(!$26){return false;};var $1W=this.nav.scroll.scrollWidth;var $X=this.nav.scroll.scrollLeft;var $y=this.nav.scroll.clientWidth;var $Q=$X+$y;if($26<0&&$X<=0){return false;};if($26>0&&$Q>=$1W){return false;};this.nav.scroll.scrollLeft+=$26;return true;};this.scrollabitY=function($26){if(!$26){return false;};var $1W=this.nav.scroll.scrollHeight;var $X=this.nav.scroll.scrollTop;var $z=this.nav.scroll.clientHeight;var $0U=$X+$z;if($26<0&&$X<=0){return false;};if($26>0&&$0U>=$1W){return false;};this.nav.scroll.scrollTop+=$26;return true;};this.scrollabit=function($3g,$3h){var $3i=this.scrollabitX($3g)||this.scrollabitY($3h);if(!$3i){return;};var $w=function($3g,$3h){return function(){$f.scrollabit($3g,$3h);};};this.scrolling=window.setTimeout($w($3g,$3h),100);};this.stopScroll=function(){if(this.scrolling){window.clearTimeout(this.scrolling);this.scrolling=null;}};this.prepareRowTops=function(){var top=0;for(var i=0;i<this.rows.length;i++){var $p=this.rows[i];if(!$p.Hidden){$p.Top=top;top+=$p.Height;}};this.innerHeightTree=top;};this.deleteCells=function(){this.elements.cells=[];this.elements.breaks=[];this.cache.cells=[];this.cache.breaks=[];this.divCells.innerHTML='';this.divLines.innerHTML='';this.divBreaks.innerHTML='';};this.drawCell=function(x,y){var $0V=x+'_'+y;if(this.cache.cells[$0V]){return;};var $2H=this.getColor(x,y);var $00=document.createElement("div");$00.style.left=(x*this.cellWidth)+"px";$00.style.top=this.rows[y].Top+"px";$00.style.width=(this.cellWidth-1)+"px";$00.style.height=(this.rows[y].Height-1)+"px";$00.style.position='absolute';$00.style.backgroundColor=$2H;$00.unselectable='on';$00.className=this.applyCssClass('cellbackground');if(this.cellProperties&&this.cellProperties[$0V]){var p=this.cellProperties[$0V];$00.innerHTML=p.html;$00.style.backgroundImage=p.image;$00.style.backgroundRepeat=p.repeat;if(p.css){if($00.className){$00.className+=" "+this.applyCssClass(p.css);}else{$00.className=this.applyCssClass(p.css);}}};this.divCells.appendChild($00);this.elements.cells.push($00);this.cache.cells[$0V]='1';};this.drawRangeCell=function(x,y){var $00=document.createElement("div");$00.style.left=(x*this.cellWidth)+"px";$00.style.top=this.rows[y].Top+"px";$00.style.width=(this.cellWidth-1)+"px";$00.style.height=(this.rows[y].Height-1)+"px";$00.style.position='absolute';$00.style.backgroundColor=$f.cellSelectColor;$00.unselectable='on';this.divRange.appendChild($00);this.elements.range.push($00);};this.clearSelection=function(){this.deleteRange();};this.cleanSelection=this.clearSelection;this.deleteRange=function(){this.divRange.innerHTML='<div style="position:absolute; left:0px; top:0px; width:0px; height:0px;"></div>';this.elements.range=[];DayPilotScheduler.rangeHold=null;};this.getColor=function(x,y){if(this.colors){if(this.colors!==null&&this.colors[y]!==null&&this.colors[y][x]!==null&&this.palette!==null){return this.palette[this.colors[y][x]];}else return null;}else{var $00={};$00.resource=this.rows[y].Value;var $09=this.timeline[x].start.getTime()-this.startDate.getTime();$00.start=new DayPilot.Date(this.rows[y].Start).addTime($09);$00.backColor=this.isBusiness($00)?this.cellBackColor:this.cellBackColorNonBusiness;var $2z=this.beforeCellRender($00);if($2z){return $2z.backColor;}else{return this.cellBackColor;}}};this.isBusiness=function($00){if($00.start.dayOfWeek()===0||$00.start.dayOfWeek()===6){return false;};if(this.cellDuration<720){if($00.start.getHours()<this.businessBeginsHour||$00.start.getHours()>=this.businessEndsHour){return false;}else{return true;}};return true;};this.beforeCellRender=function($00){return $00;};this.setHeight=function($H){if(this.heightSpec!=="Parent100Pct"){this.heightSpec="Fixed";};this.height=$H-(this.getTotalHeaderHeight()+2);this.updateHeight();};this.findRowByResourceId=function(id){for(var i=0;i<this.rows.length;i++){if(this.rows[i].Value===id){return this.rows[i];}};return null;};};DayPilotScheduler.Action=function($f,$0k,$0i,$0d){this.calendar=$f;this.isAction=true;this.action=$0k;this.params=$0i;this.data=$0d;this.notify=function(){$f.invokeEvent("Immediate",this.action,this.params,this.data);};this.auto=function(){$f.invokeEvent("Notify",this.action,this.params,this.data);};this.queue=function(){$f.queue.add(this);};this.toJSON=function(){var $0C={};$0C.name=this.action;$0C.params=this.params;$0C.data=this.data;return $0C;}};DayPilot.SchedulerVisible.dragStart=DayPilotScheduler.dragStart;DayPilot.SchedulerVisible.dragStop=DayPilotScheduler.dragStop;DayPilot.SchedulerVisible.Scheduler=DayPilotScheduler.Scheduler;DayPilot.Scheduler=DayPilotScheduler.Scheduler;})();

