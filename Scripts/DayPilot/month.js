
if(typeof DayPilot==='undefined'){var DayPilot={};};if(typeof DayPilotMonth==='undefined'){var DayPilotMonth=DayPilot.MonthVisible={};};(function(){var $a=function(){};if(typeof DayPilot.Month!=='undefined'){return;};var DayPilotMonth={};DayPilotMonth.Month=function($b){var $c=document.getElementById($b);var $d=this;this.id=$b;this.startDate=new DayPilot.Date();this.width='100%';this.cellHeight=100;this.allowMultiSelect=true;this.autoRefreshCommand='refresh';this.autoRefreshEnabled=false;this.autoRefreshInterval=60;this.autoRefreshMaxCount=20;this.eventFontColor="#000000";this.eventFontFamily="Tahoma";this.eventFontSize="11px";this.headerBackColor='#ECE9D8';this.headerFontColor='#000000';this.headerFontFamily="Tahoma";this.headerFontSize="10pt";this.headerHeight=20;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.weekStarts=1;this.innerBorderColor='#cccccc';this.borderColor='black';this.eventHeight=16;this.cellHeaderHeight=16;this.numberFormat="0.00";this.clientState={};this.afterRender=function(){};this.backColor='#FFFFD5';this.nonBusinessBackColor='#FFF4BC';this.cellHeaderBackColor='';this.cellHeaderFontColor='#000000';this.cellHeaderFontFamily='Tahoma';this.cellHeaderFontSize='10pt';this.eventBackColor='White';this.eventBorderColor='Black';this.eventCorners="Regular";this.eventFontColor='#000000';this.eventFontFamily='Tahoma';this.eventFontSize='11px';this.eventHeight=16;this.cellWidth=14.285;this.lineSpace=1;this.eventTextLayer='Top';this.eventStartTime=true;this.eventEndTime=true;this.eventTextAlignment='Center';this.eventTextLeftIndent=20;this.showWeekend=true;this.cellMode=false;this.shadowType="Fill";this.eventTimeFontColor='gray';this.eventTimeFontFamily='Tahoma';this.eventTimeFontSize='8pt';this.viewType='Month';this.weeks=1;this.eventClickHandling='Disabled';this.eventDoubleClickHandling='Disabled';this.eventMoveHandling='Disabled';this.eventResizeHandling='Disabled';this.eventRightClickHandling='ContextMenu';this.timeRangeSelectedHandling='Diabled';this.timeRangeDoubleClickHandling='Disabled';this.onTimeRangeDoubleClick=function(){};this.backendUrl=null;this.cellEvents=[];this.elements={};this.elements.events=[];this.cache={};this.cache.events={};this.nav={};this.autoRefreshCount=0;this.updateView=function($e,$f){var $e=eval("("+$e+")");if($e.BubbleGuid){var $g=$e.BubbleGuid;var $h=this.bubbles[$g];delete this.bubbles[$g];$d.loadingStop();$h.updateView($e.Result.BubbleHTML,$h);return;};if($e.UpdateType==="None"){return;};if($e.VsUpdate){var $i=document.createElement("input");$i.type='hidden';$i.name=$d.id+"_vsupdate";$i.id=$i.name;$i.value=$e.VsUpdate;$d.vsph.innerHTML='';$d.vsph.appendChild($i);};$d.events=$e.Events;if($e.UpdateType==="Full"){$d.cellProperties=$e.CellProperties;$d.headerProperties=$e.HeaderProperties;$d.startDate=$e.StartDate;if(typeof $e.ShowWeekend!=='undefined'){$d.showWeekend=$e.ShowWeekend;};$d.headerBackColor=$e.HeaderBackColor?$e.HeaderBackColor:$d.headerBackColor;$d.backColor=$e.BackColor?$e.BackColor:$d.backColor;$d.nonBusinessBackColor=$e.NonBusinessBackColor?$e.NonBusinessBackColor:$d.nonBusinessBackColor;$d.locale=$e.Locale?$e.Locale:$d.locale;$d.timeFormat=$e.TimeFormat?$e.TimeFormat:$d.timeFormat;if(typeof $e.WeekStarts!=='undefined'){$d.weekStarts=$e.WeekStarts;};$d.hashes=$e.Hashes;};$d.multiselect.clear(true);$d.multiselect.initList=$e.SelectedEvents;$d.clearEvents();$d.prepareRows();$d.prepareEvents();if($e.UpdateType==="Full"){$d.clearTable();$d.drawTable();};$d.updateHeight();$d.drawEvents();$d.afterRender($e.CallBackData,true);$d.startAutoRefresh();if($e.Message){$d.message($e.Message,5000);}};this.lineHeight=function(){return this.eventHeight+this.lineSpace;};this.applyCssClass=function($j){if(this.cssClassPrefix){return this.cssClassPrefix+$j;}else{return "";}};this.rounded=function(){return this.eventCorners==="Rounded";};this.prepareEvents=function(){if(this.cellMode){this.prepareEventsCells();}else{this.prepareEventsRows();}};this.loadingStop=function(){};this.prepareEventsRows=function(){for(var x=0;x<this.events.length;x++){var e=this.events[x];e.Start=new DayPilot.Date(e.Start).d;e.End=new DayPilot.Date(e.End).d;if(e.Start.getTime()>e.End.getTime()){continue;};for(var i=0;i<this.rows.length;i++){var $k=this.rows[i];if($k.belongsHere(e)){$k.events.push(e);}}};for(var ri=0;ri<this.rows.length;ri++){var $k=this.rows[ri];$k.events.sort(this.eventComparerCustom);for(var ei=0;ei<this.rows[ri].events.length;ei++){var ev=$k.events[ei];var $l=$k.getStartColumn(ev);var $m=$k.getWidth(ev);var $n=$k.putIntoLine(ev,$l,$m,ri);}}};this.prepareEventsCells=function(){this.cellEvents=[];for(var x=0;x<this.getColCount();x++){this.cellEvents[x]=[];for(var y=0;y<this.rows.length;y++){var $o={};var d=DayPilot.Date.addDays(this.firstDate,y*7+x);$o.start=d;$o.end=DayPilot.Date.addDays(d,1);$o.events=[];this.cellEvents[x][y]=$o;}};for(var i=0;i<this.events.length;i++){var e=this.events[i];e.Start=new DayPilot.Date(e.Start);e.End=new DayPilot.Date(e.Start);if(e.Start.getTime()>e.End.getTime()){continue;};for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $o=this.cellEvents[x][y];if(e.Start.getTime()>=$o.start.getTime()&&e.Start.getTime()<$o.end.getTime()){$o.events.push(e);}}}};for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $o=this.cellEvents[x][y];$o.events.sort(this.eventComparerCustom);}}};this.clearEvents=function(){for(var i=0;i<this.elements.events.length;i++){var e=this.elements.events[i];e.event=null;e.click=null;e.parentNode.removeChild(e);};this.elements.events=[];};this.drawEvents=function(){this.cache.events={};if(this.cellMode){this.drawEventsCells();}else{this.drawEventsRows();};this.multiselect.redraw();};this.drawEventsCells=function(){this.elements.events=[];for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $o=this.cellEvents[x][y];var $p=this.cells[x][y];for(var i=0;i<$o.events.length;i++){var $q={};$q.event=$o.events[i];$q.colStart=x;$q.colWidth=1;$q.row=y;$q.line=i;$q.startsHere=true;$q.endsHere=true;this.drawEvent($q);}}}};this.drawEventsRows=function(){this.elements.events=[];for(var ri=0;ri<this.rows.length;ri++){var $k=this.rows[ri];for(var li=0;li<$k.lines.length;li++){var $n=$k.lines[li];for(var pi=0;pi<$n.length;pi++){this.drawEvent($n[pi]);}}}};this.eventComparer=function(a,b){if(!a||!b||!a.Start||!b.Start){return 0;};var $r=a.Start.getTime()-b.Start.getTime();if($r!==0){return $r;};var $s=b.End.getTime()-a.End.getTime();return $s;};this.eventComparerCustom=function(a,b){if(!a||!b){return 0;};if(!a.Sort||!b.Sort||a.Sort.length===0||b.Sort.length===0){return $d.eventComparer(a,b);};var $e=0;var i=0;while($e===0&&a.Sort[i]&&b.Sort[i]){if(a.Sort[i]===b.Sort[i]){$e=0;}else{$e=$d.stringComparer(a.Sort[i],b.Sort[i],$d.sortDirections[i]);};i++;};return $e;};this.stringComparer=function(a,b,$t){var $u=($t!=="desc");var $v=$u?-1:1;var $w=-$v;if(a===null&&b===null){return 0;};if(b===null){return $w;};if(a===null){return $v;};var ar=[];ar[0]=a;ar[1]=b;ar.sort();return a===ar[0]?$v:$w;};this.drawShadow=function(x,y,$n,$x,$y,e){if(!$y){$y=0;};var $z=$x;this.shadow=[];this.shadow.start={x:x,y:y};this.shadow.width=$x;var $A=y*7+x-$y;if($A<0){$z+=$A;x=0;y=0;};var $B=$y;while($B>=7){y--;$B-=7;};if($B>x){var $C=7-this.getColCount();if($B>(x+$C)){y--;x=x+7-$B;}else{$z=$z-$B+x;x=0;}}else{x-=$B;};if(y<0){y=0;x=0;};if(DayPilotMonth.resizingEvent){this.relative.style.cursor='w-resize';}else if(DayPilotMonth.movingEvent){this.relative.style.cursor='move';}while($z>0&&y<this.rows.length){var $D=Math.min(this.getColCount()-x,$z);var $k=this.rows[y];var $E=document.createElement("div");$E.unselectable='on';$E.style.position='absolute';$E.style.left=(this.getCellWidth()*x)+'%';$E.style.width=(this.getCellWidth()*$D)+'%';$E.style.top=(this.getRowTop(y)+1)+'px';$E.style.height=(this.eventHeight)+'px';var $F=document.createElement("div");$F.style.marginLeft='1px';$F.style.height=($k.getHeight()-5)+'px';$F.style.border='2px dotted #666666';if(this.shadowType==='Fill'){$F.style.backgroundColor="#aaaaaa";$F.style.opacity=0.5;$F.style.filter="alpha(opacity=50)";$F.style.border='2px solid #aaaaaa';if(e&&e.eventPart&&e.eventPart.event){$F.style.overflow='hidden';$F.style.fontSize=this.eventFontSize;$F.style.fontFamily=this.eventFontFamily;$F.style.color=this.eventFontColor;$F.innerHTML=e.eventPart.event.InnerHTML?e.eventPart.event.InnerHTML:e.eventPart.event.Text;}};$E.appendChild($F);this.relative.appendChild($E);this.shadow.push($E);$z-=($D+7-this.getColCount());x=0;y++;}};this.clearShadow=function(){if(this.shadow){for(var i=0;i<this.shadow.length;i++){this.relative.removeChild(this.shadow[i]);};this.shadow=null;this.relative.style.cursor='';}};this.getEventTop=function($k,$n){var top=this.headerHeight;for(var i=0;i<$k;i++){top+=this.rows[i].getHeight();};top+=this.cellHeaderHeight;top+=$n*this.lineHeight();return top;};this.getDateFromCell=function(x,y){return DayPilot.Date.addDays(this.firstDate,y*7+x);};this.drawEvent=function($q,$G){var $G=this.cellMode;var ev=$q.event;var $k=$q.row;var $n=$q.line;var $l=$q.colStart;var $m=$q.colWidth;var $H=$G?0:this.getCellWidth()*($l);var $x=$G?100:this.getCellWidth()*($m);var top=$G?$n*this.lineHeight():this.getEventTop($k,$n);var e=document.createElement("div");e.unselectable='on';e.style.height=this.eventHeight+'px';e.style.fontFamily=this.eventFontFamily;var eo=null;var $I=$q.event.Value+"_"+$q.event.Start+"_"+$q.event.RecurrentMasterId;if(this.cache.events[$I]){eo=this.cache.events[$I];}else{eo=new DayPilotMonth.Event($d,$q,$k);this.cache.events[$I]=eo;};e.event=eo;if($G){e.style.marginRight="2px";e.style.marginBottom="2px";}else{e.style.width=$x+'%';e.style.position='absolute';e.style.left=$H+'%';e.style.top=top+'px';};if(this.showToolTip){e.title=ev.ToolTip;};e.onclick=$d.eventClickDispatch;e.ondblclick=$d.eventDoubleClickDispatch;e.oncontextmenu=function(){$d.eventRightClickDispatch(e.event);return false;};e.onmousedown=function(ev){ev=ev||window.event;var $J=ev.which||ev.button;if($J===1){if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){DayPilotBubble.hideActive();};DayPilotMonth.movingEvent=null;if(this.style.cursor==='w-resize'||this.style.cursor==='e-resize'){var $K={};$K.start={};$K.start.x=$l;$K.start.y=$k;$K.event=e.event;$K.width=DayPilot.Date.daysSpan($K.event.start().d,$K.event.end().d)+1;$K.direction=this.style.cursor;DayPilotMonth.resizingEvent=$K;}else if($d.eventMoveHandling!=='Disabled'){$d.clearShadow();var $L=DayPilot.mo2($d.relative,ev);if(!$L){return;};var $o=$d.getCellBelowPoint($L.x,$L.y);var $A=DayPilot.Date.daysDiff($q.event.Start,$d.rows[$k].start);var $y=($o.y*7+$o.x)-($k*7+$l);if($A){$y+=$A;};var $M={};$M.start={};$M.start.x=$l;$M.start.y=$k;$M.start.line=$n;$M.offset=$y;$M.colWidth=$m;$M.event=e.event;$M.coords=$L;DayPilotMonth.movingEvent=$M;}}};e.onmousemove=function(ev){if(typeof(DayPilotMonth)==='undefined'){return;};if(DayPilotMonth.movingEvent||DayPilotMonth.resizingEvent){return;};var $y=DayPilot.mo(e,ev);if(!$y)return;var $N=6;if(!$d.cellMode&&$y.x<=$N&&$d.eventResizeHandling!=='Disabled'){if($q.startsHere){e.style.cursor="w-resize";e.dpBorder='left';}else{e.style.cursor='not-allowed';}}else if(!$d.cellMode&&e.clientWidth-$y.x<=$N&&$d.eventResizeHandling!=='Disabled'){if($q.endsHere){e.style.cursor="e-resize";e.dpBorder='right';}else{e.style.cursor='not-allowed';}}else{e.style.cursor='default';};if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){if(!DayPilotMonth.movingEvent&&!DayPilotMonth.resizingEvent){$d.bubble.showEvent(e.event);}else{DayPilotBubble.hideActive();}}};e.onmouseout=function(){if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){$d.bubble.hideOnMouseOut();};e.style.cursor='';};var back=(ev.BackColor)?ev.BackColor:this.eventBackColor;var $O=document.createElement("div");$O.unselectable='on';$O.style.marginLeft='2px';$O.style.marginRight='1px';$O.style.paddingLeft='2px';$O.style.height=(this.eventHeight-2)+'px';$O.style.border='1px solid '+$d.eventBorderColor;$O.style.overflow='hidden';$O.style.position='relative';$O.style.backgroundColor=back;$O.className=this.applyCssClass("event");if(this.rounded()){$O.style.MozBorderRadius="5px";$O.style.webkitBorderRadius="5px";$O.style.borderRadius="5px";};var $F=[];var $P=this.eventTextLayer==='Top';var $Q=this.eventStartTime;var $R=this.eventEndTime;var $S=this.eventTextAlignment;var $T=this.eventTextLeftIndent;if($Q){if($S==='Left'){$F.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:");$F.push(this.eventTimeFontSize);$F.push(";color:");$F.push(this.eventTimeFontColor);$F.push(";font-family:");$F.push(this.eventTimeFontFamily);$F.push(";text-align:right;");$F.push("width:");$F.push($T-4);$F.push("px;");$F.push("><span style='background-color:");}else{$F.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:");$F.push(this.eventTimeFontSize);$F.push(";color:");$F.push(this.eventTimeFontColor);$F.push(";font-family:");$F.push(this.eventTimeFontFamily);$F.push(";'><span style='background-color:");};$F.push(back);$F.push("' unselectable='on'>");if($q.startsHere){$F.push(DayPilot.Date.hours(ev.Start,$d.timeFormat==='Clock12Hours'));}else{$F.push("~");};$F.push("</span></div></div>");};if($R){$F.push("<div unselectable='on' style='position:absolute;text-align:right;height:1px;font-size:1px;width:100%'><div unselectable='on' style='margin-right:4px;font-size:");$F.push(this.eventTimeFontSize);$F.push(";color:");$F.push(this.eventTimeFontColor);$F.push(";font-family:");$F.push(this.eventTimeFontFamily);$F.push(";'><span style='background-color:");$F.push(back);$F.push("' unselectable='on'>");if($q.endsHere){$F.push(DayPilot.Date.hours(ev.End,$d.timeFormat==='Clock12Hours'));}else{$F.push("~");};$F.push("</span></div></div>");};if($S==='Left'){var $H=$Q?$T:0;$F.push("<div style='margin-top:0px;height:");$F.push(this.eventHeight-2);$F.push("px;");$F.push(";overflow:hidden;text-align:left;padding-left:");$F.push($H);$F.push("px;font-size:");$F.push(this.eventFontSize);$F.push(";color:");$F.push(this.eventFontColor);$F.push(";font-family:");$F.push(this.eventFontFamily);$F.push("' unselectable='on'>");if(ev.InnerHTML){$F.push(ev.InnerHTML);}else{$F.push(ev.Text);};$F.push("</div>");}else if($S==='Center'){if($P){$F.push("<div style='position:absolute; text-align:center; width: 98%; height:1px; font-size: 1px;'>");$F.push("<span style='background-color:");$F.push(back);$F.push(";font-size:");$F.push(this.eventFontSize);$F.push(";color:");$F.push(this.eventFontColor);$F.push(";font-family:");$F.push(this.eventFontFamily);$F.push("' unselectable='on'>");if(ev.InnerHTML){$F.push(ev.InnerHTML);}else{$F.push(ev.Text);};$F.push("</span>");$F.push("</div>");}else{$F.push("<div style='margin-top:0px;height:");$F.push(this.eventHeight-2);$F.push("px;");$F.push(";overflow:hidden;text-align:center;font-size:");$F.push(this.eventFontSize);$F.push(";color:");$F.push(this.eventFontColor);$F.push(";font-family:");$F.push(this.eventFontFamily);$F.push("' unselectable='on'>");if(ev.InnerHTML){$F.push(ev.InnerHTML);}else{$F.push(ev.Text);};$F.push("</div>");}};$O.innerHTML=$F.join('');e.appendChild($O);this.elements.events.push(e);if($G){this.cells[$l][$k].body.appendChild(e);}else{this.relative.appendChild(e);};if($d.multiselect.shouldBeSelected(e.event)){$d.multiselect.add(e.event);};if($d.afterEventRender){$d.afterEventRender(e.event,e);}};this.isWeekend=function($U){var $V=0;var $W=6;if($U.dayOfWeek()===$V){return true;};if($U.dayOfWeek()===$W){return true;};return false;};this.lastVisibleDayOfMonth=function(){var $X=this.startDate.lastDayOfMonth();if(this.showWeekend){return $X;}while(this.isWeekend($X)){$X=$X.addDays(-1);};return $X;};this.prepareRows=function(){if(typeof this.startDate==='string'){this.startDate=DayPilot.Date.fromStringSortable(this.startDate);};if(this.viewType==='Month'){this.startDate=this.startDate.firstDayOfMonth();};this.firstDate=this.startDate.firstDayOfWeek(this.getWeekStart());if(!this.showWeekend){var $Y=this.startDate.addMonths(-1).getMonth();var $Z=new DayPilot.Date(this.firstDate).addDays(6);while(this.isWeekend($Z)){$Z=$Z.addDays(-1);};if($Z.getMonth()===$Y){this.firstDate=DayPilot.Date.addDays(this.firstDate,7);}};var $00=this.startDate;var $01;if(this.viewType==='Month'){var $02=this.lastVisibleDayOfMonth().d;var $03=DayPilot.Date.daysDiff(this.firstDate,$02)+1;$01=Math.ceil($03/7);}else{$01=this.weeks;};this.days=$01*7;this.rows=[];for(var x=0;x<$01;x++){var r={};r.start=DayPilot.Date.addDays(this.firstDate,x*7);r.end=DayPilot.Date.addDays(r.start,this.getColCount());r.events=[];r.lines=[];r.index=x;r.minHeight=this.cellHeight;r.calendar=this;r.belongsHere=function(ev){if(ev.End.getTime()===ev.Start.getTime()&&ev.Start.getTime()===this.start.getTime()){return true;};return !(ev.End.getTime()<=this.start.getTime()||ev.Start.getTime()>=this.end.getTime());};r.getPartStart=function(ev){return DayPilot.Date.max(this.start,ev.Start);};r.getPartEnd=function(ev){return DayPilot.Date.min(this.end,ev.End);};r.getStartColumn=function(ev){var $04=this.getPartStart(ev);return DayPilot.Date.daysDiff(this.start,$04);};r.getWidth=function(ev){return DayPilot.Date.daysSpan(this.getPartStart(ev),this.getPartEnd(ev))+1;};r.putIntoLine=function(ev,$l,$m,$k){var $05=this;for(var i=0;i<this.lines.length;i++){var $n=this.lines[i];if($n.isFree($l,$m)){$n.addEvent(ev,$l,$m,$k,i);return i;}};var $n=[];$n.isFree=function($l,$m){var $06=true;for(var i=0;i<this.length;i++){if(!($l+$m-1<this[i].colStart||$l>this[i].colStart+this[i].colWidth-1)){$06=false;}};return $06;};$n.addEvent=function(ev,$l,$m,$k,$07){var $q={};$q.event=ev;$q.colStart=$l;$q.colWidth=$m;$q.row=$k;$q.line=$07;$q.startsHere=$05.start.getTime()<=ev.Start.getTime();$q.endsHere=$05.end.getTime()>=ev.End.getTime();this.push($q);};$n.addEvent(ev,$l,$m,$k,this.lines.length);this.lines.push($n);return this.lines.length-1;};r.getStart=function(){var $08=0;for(var i=0;i<$d.rows.length&&i<this.index;i++){$08+=$d.rows[i].getHeight();}};r.getHeight=function(){return Math.max(this.lines.length*$d.lineHeight()+$d.cellHeaderHeight,this.calendar.cellHeight);};this.rows.push(r);};this.endDate=DayPilot.Date.addDays(this.firstDate,$01*7);};this.getHeight=function(){var $09=this.headerHeight;for(var i=0;i<this.rows.length;i++){$09+=this.rows[i].getHeight();};return $09;};this.getWidth=function($08,end){var $0a=(end.y*7+end.x)-($08.y*7+$08.x);return $0a+1;};this.getMinCoords=function($0b,$0c){if(($0b.y*7+$0b.x)<($0c.y*7+$0c.x)){return $0b;}else{return $0c;}};this.drawRelative=function(){this.relative=document.createElement("div");this.nav.top=this.relative;this.relative.style.MozUserSelect='none';this.relative.style.KhtmlUserSelect='none';this.relative.style.position='relative';this.relative.style.width=this.width;this.relative.style.height=this.getHeight()+'px';this.relative.onmousemove=function(ev){if(DayPilotMonth.resizingEvent){var $L=DayPilot.mo2($d.relative,ev);if(!$L){return;};var $o=$d.getCellBelowPoint($L.x,$L.y);$d.clearShadow();var $K=DayPilotMonth.resizingEvent;var $0d=$K.start;var $x,$08;if($K.direction==='w-resize'){$08=$o;var $0e=$K.event.end().d;if(DayPilot.Date.getDate($0e).getTime()===$0e.getTime()){$0e=DayPilot.Date.addDays($0e,-1);};var end=$d.getCellFromDate($0e);$x=$d.getWidth($o,end);}else{$08=$d.getCellFromDate($K.event.start().d);$x=$d.getWidth($08,$o);};if($x<1){$x=1;};$d.drawShadow($08.x,$08.y,0,$x);}else if(DayPilotMonth.movingEvent){var $L=DayPilot.mo2($d.relative,ev);if(!$L){return;};if($L.x==DayPilotMonth.movingEvent.coords.x&&$L.y==DayPilotMonth.movingEvent.coords.y){return;};var $o=$d.getCellBelowPoint($L.x,$L.y);$d.clearShadow();var event=DayPilotMonth.movingEvent.event;var $y=DayPilotMonth.movingEvent.offset;var $x=$d.cellMode?1:DayPilot.Date.daysSpan(event.start().d,event.end().d)+1;if($x<1){$x=1;};$d.drawShadow($o.x,$o.y,0,$x,$y,event);}else if(DayPilotMonth.timeRangeSelecting){var $L=DayPilot.mo2($d.relative,ev);if(!$L){return;};var $o=$d.getCellBelowPoint($L.x,$L.y);$d.clearShadow();var $08=DayPilotMonth.timeRangeSelecting;var $0f=$08.y*7+$08.x;var $0g=$o.y*7+$o.x;var $x=Math.abs($0g-$0f)+1;if($x<1){$x=1;};var $0h=$0f<$0g?$08:$o;DayPilotMonth.timeRangeSelecting.from={x:$0h.x,y:$0h.y};DayPilotMonth.timeRangeSelecting.width=$x;DayPilotMonth.timeRangeSelecting.moved=true;$d.drawShadow($0h.x,$0h.y,0,$x,0,null);}};$c.appendChild(this.relative);this.vsph=document.createElement("div");this.vsph.style.display='none';$c.appendChild(this.vsph);};this.message=function($0i,$0j,$0k,$0l){if($0i===null){return;};var $0j=$0j||2000;var $0k=$0k||"#ffffff";var $0l=$0l||"#000000";var top=this.headerHeight;var $H=1;var $0m=-1;var $p;if(this.nav.message){$p=this.nav.message;$p.firstChild.style.color=$0k;$p.firstChild.style.backgroundColor=$0l;$p.firstChild.innerHTML=$0i;}else{$p=document.createElement("div");$p.style.position="absolute";$p.style.width="100%";$p.style.left="0px";$p.style.textAlign="left";$p.style.top=top+"px";$p.style.opacity=0.8;$p.style.filter="alpha(opacity=80)";$p.style.display='none';var $O=document.createElement("div");$O.style.marginLeft=$H+"px";$O.style.marginRight=$0m+"px";$O.style.backgroundColor=$0l;$O.style.color=$0k;$O.style.padding="5px";$O.innerHTML=$0i;$p.appendChild($O);this.nav.top.appendChild($p);this.nav.message=$p;};if(this.nav.message.style.display!=='none'){clearTimeout($d.messageTimeout);};var end=function(){$d.messageTimeout=setTimeout($d.hideMessage,$0j);};DayPilot.fade($p,0.1,end);};this.message=function($0i,$0j,$0k,$0l){if($0i===null){return;};var $0j=$0j||2000;var $0k=$0k||"#ffffff";var $0l=$0l||"#000000";var $0n=0.8;var top=this.headerHeight;var $H=1;var $0m=-1;var $p;if(!this.nav.message){$p=document.createElement("div");$p.style.position="absolute";$p.style.width="100%";$p.style.left="0px";$p.style.textAlign="left";$p.style.top=top+"px";$p.style.opacity=$0n;$p.style.filter="alpha(opacity="+($0n*100)+")";$p.style.display='none';var $O=document.createElement("div");$O.style.marginLeft=$H+"px";$O.style.marginRight=$0m+"px";$O.style.padding="5px";$p.appendChild($O);var close=document.createElement("div");close.style.top="5px";close.style.right=(DayPilot.sw($d.nav.scroll)+5)+"px";close.style.color=$0k;close.style.lineHeight="100%";close.style.position="absolute";close.style.cursor="pointer";close.style.fontWeight="bold";close.innerHTML="X";close.onclick=function(){$d.nav.message.style.display='none';};$p.appendChild(close);this.nav.top.appendChild($p);this.nav.message=$p;};var $0o=function(){$d.nav.message.style.opacity=$0n;var $O=$d.nav.message.firstChild;$O.style.backgroundColor=$0l;$O.style.color=$0k;$O.innerHTML=$0i;var end=function(){$d.messageTimeout=setTimeout($d.hideMessage,$0j);};DayPilot.fade($d.nav.message,0.2,end);};if(this.nav.message.style.display!=='none'){clearTimeout($d.messageTimeout);DayPilot.fade($d.nav.message,-0.2,$0o);}else{$0o();}};this.hideMessage=function(){var end=function(){$d.nav.message.style.display='none';};DayPilot.fade($d.nav.message,-0.2,end);};this.updateHeight=function(){this.relative.style.height=this.getHeight()+'px';for(var x=0;x<this.cells.length;x++){for(var y=0;y<this.cells[x].length;y++){this.cells[x][y].style.top=this.getRowTop(y)+'px';this.cells[x][y].style.height=this.rows[y].getHeight()+'px';}}};this.getCellBelowPoint=function(x,y){var $0p=Math.floor(this.relative.clientWidth/this.getColCount());var $0q=Math.min(Math.floor(x/$0p),this.getColCount()-1);var $k=null;var $09=this.headerHeight;for(var i=0;i<this.rows.length;i++){$09+=this.rows[i].getHeight();if(y<$09){$k=i;break;}};if($k===null){$k=this.rows.length-1;};var $o={};$o.x=$0q;$o.y=$k;return $o;};this.getCellFromDate=function($U){var $x=DayPilot.Date.daysDiff(this.firstDate,$U);var $o={x:0,y:0};while($x>=7){$o.y++;$x-=7;};$o.x=$x;return $o;};this.drawTable=function(){var $0r=document.createElement("div");$0r.oncontextmenu=function(){return false;};this.relative.appendChild($0r);this.cells=[];for(var x=0;x<this.getColCount();x++){this.cells[x]=[];var $0s=this.headerProperties?this.headerProperties[x]:null;var $0t=document.createElement("div");$0t.unselectable='on';$0t.style.position='absolute';$0t.style.left=(this.getCellWidth()*x)+'%';$0t.style.width=(this.getCellWidth())+'%';$0t.style.top='0px';$0t.style.height=(this.headerHeight)+'px';$0t.style.backgroundColor=$0s?$0s.BackColor:this.headerBackColor;$0t.style.fontFamily=this.headerFontFamily;$0t.style.fontSize=this.headerFontSize;$0t.style.color=this.headerFontColor;$0t.style.borderLeft='1px solid '+this.borderColor;$0t.style.borderTop='1px solid '+this.borderColor;$0t.style.borderBottom='1px solid '+this.borderColor;$0t.style.textAlign='center';$0t.style.cursor='default';$0t.className=this.applyCssClass("header");if(x===this.getColCount()-1){$0t.style.borderRight='1px solid '+this.borderColor;};var $0u=x+this.getWeekStart();if($0u>6){$0u-=7;};$0t.innerHTML=$0s?$0s.InnerHTML:this.dayNames[$0u];(function(x){$0t.onclick=function(){$d.headerClickDispatch(x);};})($0u);$0r.appendChild($0t);for(var y=0;y<this.rows.length;y++){this.drawCell(x,y,$0r);}};var $p=document.createElement("div");$p.style.position='absolute';$p.style.padding='2px';$p.style.top='0px';$p.style.left='0px';$p.style.backgroundColor="#FF6600";$p.style.color="white";$p.innerHTML="\u0044\u0045\u004D\u004F";if(this.numberFormat)this.relative.appendChild($p);};this.clearTable=function(){for(var x=0;x<this.cells.length;x++){for(var y=0;y<this.cells[x].length;y++){this.cells[x][y].onclick=null;}};this.relative.innerHTML='';};this.drawCell=function(x,y,$0r){var $k=this.rows[y];var d=DayPilot.Date.addDays(this.firstDate,y*7+x);var $0v=this.cellProperties?this.cellProperties[y*this.getColCount()+x]:null;var $o=document.createElement("div");$o.unselectable='on';$o.style.position='absolute';$o.style.cursor='default';$o.style.left=(this.getCellWidth()*x)+'%';$o.style.width=(this.getCellWidth())+'%';$o.style.top=(this.getRowTop(y))+'px';$o.style.height=($k.getHeight())+'px';var $Y=this.startDate.addMonths(-1).getMonth();var $0w=this.startDate.addMonths(1).getMonth();var $0x=this.startDate.getMonth();if(d.getUTCMonth()===$0x){$o.className=this.applyCssClass("cell");}else if(d.getUTCMonth()===$Y){$o.className=this.applyCssClass("cell")+" "+this.applyCssClass("previous");}else if(d.getUTCMonth()===$0w){$o.className=this.applyCssClass("cell")+" "+this.applyCssClass("next");}else{$a();};if($0v){$o.style.backgroundColor=$0v["BackColor"];$o.className+=" "+this.applyCssClass($0v["CssClass"]);if($0v["BackImage"]){$o.style.backgroundImage="url('"+$0v["BackImage"]+"')";};if($0v["BackRepeat"]){$o.style.backgroundRepeat=$0v["BackRepeat"];}}else{$o.style.backgroundColor=this.getCellBackColor(d);};if(x===0){$o.style.borderLeft='1px solid '+this.borderColor;}else{$o.style.borderLeft='1px solid '+this.innerBorderColor;};if(y===0){$o.style.borderTop='1px solid '+this.borderColor;}else{$o.style.borderTop='1px solid '+this.innerBorderColor;};$o.style.borderBottom='1px solid '+this.borderColor;if(x===this.getColCount()-1){$o.style.borderRight='1px solid '+this.borderColor;};$o.onmousedown=function(){if($d.timeRangeSelectedHandling!=='Disabled'){$d.clearShadow();DayPilotMonth.timeRangeSelecting={"root":$d,"x":x,"y":y,"from":{x:x,y:y},"width":1};}};$o.oncontextmenu=function(){var go=function(d){var $08=new DayPilot.Date(d);var end=$08.addDays(1);var $0y=new DayPilot.Selection($08,end,null,$d);if($d.contextMenuSelection){$d.contextMenuSelection.show($0y);}};go(d);};$o.onclick=function(){var $0z=function(d){var $08=new DayPilot.Date(d);var end=$08.addDays(1);$d.timeRangeSelectedDispatch($08,end);};if($d.timeRangeSelectedHandling!=='Disabled'&&$d.timeRangeDoubleClick==='Disabled'){$0z(d);return;};if(!$d.timeouts){$d.timeouts=[];};var $0A=function(d){return function(){$0z(d);};};$d.timeouts.push(window.setTimeout($0A(d),300));};$o.ondblclick=function(){if($d.timeouts){for(var $0B in $d.timeouts){window.clearTimeout($d.timeouts[$0B]);};$d.timeouts=null;};if($d.timeRangeDoubleClickHandling!=='Disabled'){var $08=new DayPilot.Date(d);var end=$08.addDays(1);$d.timeRangeDoubleClickDispatch($08,end);}};var $0C=document.createElement("div");if($0v&&$0v["HeaderBackColor"]){$0C.style.backgroundColor=$0v["HeaderBackColor"];}else if(this.cellHeaderBackColor){$0C.style.backgroundColor=this.cellHeaderBackColor;};$0C.style.paddingRight='2px';$0C.style.textAlign="right";$0C.style.fontFamily=this.cellHeaderFontFamily;$0C.style.fontSize=this.cellHeaderFontSize;$0C.style.color=this.cellHeaderFontColor;$0C.style.height=this.cellHeaderHeight+"px";$0C.unselectable="on";$0C.className=this.applyCssClass("cellheader");if($0v){$0C.innerHTML=$0v["HeaderText"];}else{var $U=d.getUTCDate();if($U===1){$0C.innerHTML=this.monthNames[d.getUTCMonth()]+' '+$U;}else{$0C.innerHTML=$U;}};$o.appendChild($0C);if($0v&&$0v["HTML"]){var $O=document.createElement("div");$O.style.height=($k.getHeight()-this.cellHeaderHeight)+'px';$O.style.overflow='hidden';$O.innerHTML=$0v["HTML"];$o.appendChild($O);};if(this.cellMode){var $0D=document.createElement("div");$0D.style.height=(this.cellHeight-this.cellHeaderHeight)+"px";$0D.style.overflow='auto';$0D.style.position='relative';var $O=document.createElement('div');$O.style.paddingTop="1px";$O.style.paddingBottom="1px";$0D.appendChild($O);$o.appendChild($0D);$o.body=$O;};this.cells[x][y]=$o;$0r.appendChild($o);};this.getWeekStart=function(){if(this.showWeekend){return this.weekStarts;}else{return 1;}};this.getColCount=function(){if(this.showWeekend){return 7;}else{return 5;}};this.getCellWidth=function(){if(this.showWeekend){return 14.285;}else{return 20;}};this.getCellBackColor=function(d){if(d.getUTCDay()===6||d.getUTCDay()===0){return this.nonBusinessBackColor;};return this.backColor;};this.getRowTop=function($07){var top=this.headerHeight;for(var i=0;i<$07;i++){top+=this.rows[i].getHeight();};return top;};this.postBack=function($0E){var $0F=[];for(var i=1;i<arguments.length;i++){$0F.push(arguments[i]);};__doPostBack($d.uniqueID,$0E+DayPilot.ea($0F));};this.postBack2=function($0G,$0H,$0I){var $0J={};$0J.action=$0G;$0J.parameters=$0I;$0J.data=$0H;$0J.header=this.getCallBackHeader();var $0K="JSON"+DayPilot.JSON.stringify($0J);__doPostBack($d.uniqueID,$0K);};this.callBack2=function($0G,$0H,$0I){var $0J={};$0J.action=$0G;$0J.parameters=$0I;$0J.data=$0H;$0J.header=this.getCallBackHeader();var $0K="JSON"+DayPilot.JSON.stringify($0J);if(this.backendUrl){DayPilot.request(this.backendUrl,this.callBackResponse,$0K,this.ajaxError);}else{WebForm_DoCallback(this.uniqueID,$0K,this.updateView,null,this.callbackError,true);}};this.callBackResponse=function($0L){$d.updateView($0L.responseText);};this.getCallBackHeader=function(){var h={};h.control="dpm";h.id=this.id;h.visibleStart=new DayPilot.Date(this.firstDate);h.visibleEnd=h.visibleStart.addDays(this.days);h.clientState=this.clientState;h.startDate=$d.startDate;h.showWeekend=this.showWeekend;h.headerBackColor=this.headerBackColor;h.backColor=this.backColor;h.nonBusinessBackColor=this.nonBusinessBackColor;h.locale=this.locale;h.timeFormat=this.timeFormat;h.weekStarts=this.weekStarts;h.viewType=this.viewType;h.weeks=this.weeks;h.selected=$d.multiselect.events();h.hashes=$d.hashes;return h;};this.bubbleCallBack=function($0F,$h){var $g=this.recordBubbleCall($h);var $0M={};$0M.args=$0F;$0M.guid=$g;this.callBack2("Bubble",null,$0M);};this.recordBubbleCall=function($h){var $g=DayPilot.guid();if(!this.bubbles){this.bubbles=[];};this.bubbles[$g]=$h;return $g;};this.eventClickPostBack=function(e,$0H){this.postBack2("EventClick",$0H,e);};this.eventClickCallBack=function(e,$0H){this.callBack2('EventClick',$0H,e);};this.eventClickDispatch=function(e){DayPilotMonth.movingEvent=null;var $p=this;var e=e||window.event;var $0N=e.ctrlKey;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($d.eventDoubleClickHandling==='Disabled'){$d.eventClickSingle($p,$0N);return;};if(!$d.timeouts){$d.timeouts=[];}else{for(var $0B in $d.timeouts){window.clearTimeout($d.timeouts[$0B]);};$d.timeouts=[];};var $0O=function($p,$0N){return function(){$d.eventClickSingle($p,$0N);};};$d.timeouts.push(window.setTimeout($0O(this,$0N),300));e.cancelBubble=true;};this.eventClickSingle=function($p,$0N){var e=$p.event;if(!e.clickingAllowed()){return;};switch($d.eventClickHandling){case 'PostBack':$d.eventClickPostBack(e);break;case 'CallBack':$d.eventClickCallBack(e);break;case 'JavaScript':$d.onEventClick(e);break;case 'Select':$d.eventSelect($p,e,$0N);break;case 'ContextMenu':var $0P=e.client.contextMenu();if($0P){$0P.show(e);}else{if($d.contextMenu){$d.contextMenu.show(e);}};break;}};this.eventDoubleClickPostBack=function(e,$0H){this.postBack2('EventDoubleClick',$0H,e);};this.eventDoubleClickCallBack=function(e,$0H){this.callBack2('EventDoubleClick',$0H,e);};this.eventDoubleClickDispatch=function(){if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($d.timeouts){for(var $0B in $d.timeouts){window.clearTimeout($d.timeouts[$0B]);};$d.timeouts=null;};var e=this.event;switch($d.eventDoubleClickHandling){case 'PostBack':$d.eventDoubleClickPostBack(e);break;case 'CallBack':$d.eventDoubleClickCallBack(e);break;case 'JavaScript':$d.onEventDoubleClick(e);break;case 'Select':$d.eventSelect(this,e);break;case 'Bubble':if($d.bubble){$d.bubble.showEvent(e);};break;}};this.eventSelect=function($p,e,$0N){var m=$d.multiselect;m.previous=m.events();m.toggleDiv($p,$0N);var $0Q=m.isSelected(e)?"selected":"deselected";$d.eventSelectDispatch(e,$0Q);};this.eventSelectPostBack=function(e,$0Q,$0H){var $0M={};$0M.e=e;$0M.change=$0Q;this.postBack2('EventSelect',$0H,$0M);};this.eventSelectCallBack=function(e,$0Q,$0H){var $0M={};$0M.e=e;$0M.change=$0Q;this.callBack2('EventSelect',$0H,$0M);};this.eventSelectDispatch=function(e,$0Q){switch($d.eventSelectHandling){case 'PostBack':$d.eventSelectPostBack(e,$0Q);break;case 'CallBack':__theFormPostData="";__theFormPostCollection=[];if(WebForm_InitCallback){WebForm_InitCallback();};$d.eventSelectCallBack(e,$0Q);break;case 'JavaScript':$d.onEventSelect(e,$0Q);break;}};this.eventRightClickPostBack=function(e,$0H){this.postBack2("EventRightClick",$0H,e);};this.eventRightClickCallBack=function(e,$0H){this.callBack2('EventRightClick',$0H,e);};this.eventRightClickDispatch=function(e){this.event=e;if(!e.rightClickingAllowed()){return false;};switch($d.eventRightClickHandling){case 'PostBack':$d.eventRightClickPostBack(e);break;case 'CallBack':$d.eventRightClickCallBack(e);break;case 'JavaScript':$d.onEventRightClick(e);break;case 'ContextMenu':var $0P=e.client.contextMenu();if($0P){$0P.show(e);}else{if($d.contextMenu){$d.contextMenu.show(e);}};break;};return false;};this.eventMenuClickPostBack=function(e,$0R,$0H){var $0M={};$0M.e=e;$0M.command=$0R;this.postBack2('EventMenuClick',$0H,$0M);};this.eventMenuClickCallBack=function(e,$0R,$0H){var $0M={};$0M.e=e;$0M.command=$0R;this.callBack2('EventMenuClick',$0H,$0M);};this.eventMenuClick=function($0R,e,$0S){switch($0S){case 'PostBack':$d.eventMenuClickPostBack(e,$0R);break;case 'CallBack':$d.eventMenuClickCallBack(e,$0R);break;}};this.eventMovePostBack=function(e,$0T,$0U,$0H){if(!$0T)throw 'newStart is null';if(!$0U)throw 'newEnd is null';var $0M={};$0M.e=e;$0M.newStart=$0T;$0M.newEnd=$0U;this.postBack2('EventMove',$0H,$0M);};this.eventMoveCallBack=function(e,$0T,$0U,$0H){if(!$0T)throw 'newStart is null';if(!$0U)throw 'newEnd is null';var $0M={};$0M.e=e;$0M.newStart=$0T;$0M.newEnd=$0U;this.callBack2('EventMove',$0H,$0M);};this.eventMoveDispatch=function(e,x,y,$y,ev){var $0V=DayPilot.Date.getTime(e.start().d);var $0e=DayPilot.Date.getDate(e.end().d);if($0e.getTime()!==e.end().d.getTime()){$0e=DayPilot.Date.addDays($0e,1);};var $0W=DayPilot.Date.diff(e.end().d,$0e);var $0X=this.getDateFromCell(x,y);$0X=DayPilot.Date.addDays($0X,-$y);var $x=DayPilot.Date.daysSpan(e.start().d,e.end().d)+1;var $0Y=DayPilot.Date.addDays($0X,$x);var $0T=new DayPilot.Date(DayPilot.Date.addTime($0X,$0V));var $0U=new DayPilot.Date(DayPilot.Date.addTime($0Y,$0W));switch($d.eventMoveHandling){case 'PostBack':$d.eventMovePostBack(e,$0T,$0U);break;case 'CallBack':$d.eventMoveCallBack(e,$0T,$0U);break;case 'JavaScript':$d.onEventMove(e,$0T,$0U,ev.ctrlKey,ev.shiftKey);break;}};this.eventResizePostBack=function(e,$0T,$0U,$0H){if(!$0T)throw 'newStart is null';if(!$0U)throw 'newEnd is null';var $0M={};$0M.e=e;$0M.newStart=$0T;$0M.newEnd=$0U;this.postBack2('EventResize',$0H,$0M);};this.eventResizeCallBack=function(e,$0T,$0U,$0H){if(!$0T)throw 'newStart is null';if(!$0U)throw 'newEnd is null';var $0M={};$0M.e=e;$0M.newStart=$0T;$0M.newEnd=$0U;this.callBack2('EventResize',$0H,$0M);};this.eventResizeDispatch=function(e,$08,$x){var $0V=DayPilot.Date.getTime(e.start().d);var $0e=DayPilot.Date.getDate(e.end().d);if(!DayPilot.Date.equals($0e,e.end().d)){$0e=DayPilot.Date.addDays($0e,1);};var $0W=DayPilot.Date.diff(e.end().d,$0e);var $0X=this.getDateFromCell($08.x,$08.y);var $0Y=DayPilot.Date.addDays($0X,$x);var $0T=new DayPilot.Date(DayPilot.Date.addTime($0X,$0V));var $0U=new DayPilot.Date(DayPilot.Date.addTime($0Y,$0W));switch($d.eventResizeHandling){case 'PostBack':$d.eventResizePostBack(e,$0T,$0U);break;case 'CallBack':$d.eventResizeCallBack(e,$0T,$0U);break;case 'JavaScript':$d.onEventResize(e,$0T,$0U);break;}};this.timeRangeSelectedPostBack=function($08,end,$0H){var $0Z={};$0Z.start=$08;$0Z.end=end;this.postBack2('TimeRangeSelected',$0H,$0Z);};this.timeRangeSelectedCallBack=function($08,end,$0H){var $0Z={};$0Z.start=$08;$0Z.end=end;this.callBack2('TimeRangeSelected',$0H,$0Z);};this.timeRangeSelectedDispatch=function($08,end){switch($d.timeRangeSelectedHandling){case 'PostBack':$d.timeRangeSelectedPostBack($08,end);break;case 'CallBack':$d.timeRangeSelectedCallBack($08,end);break;case 'JavaScript':$d.onTimeRangeSelected($08,end);break;}};this.timeRangeMenuClickPostBack=function(e,$0R,$0H){var $0M={};$0M.selection=e;$0M.command=$0R;this.postBack2("TimeRangeMenuClick",$0H,$0M);};this.timeRangeMenuClickCallBack=function(e,$0R,$0H){var $0M={};$0M.selection=e;$0M.command=$0R;this.callBack2("TimeRangeMenuClick",$0H,$0M);};this.timeRangeMenuClick=function($0R,e,$0S){switch($0S){case 'PostBack':$d.timeRangeMenuClickPostBack(e,$0R);break;case 'CallBack':$d.timeRangeMenuClickCallBack(e,$0R);break;}};this.headerClickPostBack=function(c,$0H){this.postBack2('HeaderClick',$0H,c);};this.headerClickCallBack=function(c,$0H){this.callBack2('HeaderClick',$0H,c);};this.headerClickDispatch=function(x){var $0H=this.data;var c={$0C:x};switch($d.headerClickHandling){case 'PostBack':$d.headerClickPostBack(c);break;case 'CallBack':$d.headerClickCallBack(c);break;case 'JavaScript':$d.onHeaderClick(c);break;}};this.timeRangeDoubleClickPostBack=function($08,end,$0H){var $0Z={};$0Z.start=$08;$0Z.end=end;this.postBack2('TimeRangeDoubleClick',$0H,$0Z);};this.timeRangeDoubleClickCallBack=function($08,end,$0H){var $0Z={};$0Z.start=$08;$0Z.end=end;this.callBack2('TimeRangeDoubleClick',$0H,$0Z);};this.timeRangeDoubleClickDispatch=function($08,end){switch($d.timeRangeDoubleClickHandling){case 'PostBack':$d.timeRangeDoubleClickPostBack($08,end);break;case 'CallBack':$d.timeRangeDoubleClickCallBack($08,end);break;case 'JavaScript':$d.onTimeRangeDoubleClick($08,end);break;}};this.commandCallBack=function($0R,$0H){this.stopAutoRefresh();var $0M={};$0M.command=$0R;this.callBack2('Command',$0H,$0M);};this.multiselect={};this.multiselect.initList=[];this.multiselect.list=[];this.multiselect.divs=[];this.multiselect.previous=[];this.multiselect.serialize=function(){var m=$d.multiselect;return DayPilot.JSON.stringify(m.events());};this.multiselect.events=function(){var m=$d.multiselect;var $10=[];$10.ignoreToJSON=true;for(var i=0;i<m.list.length;i++){$10.push(m.list[i]);};return $10;};this.multiselect.updateHidden=function(){};this.multiselect.toggleDiv=function($p,$11){var m=$d.multiselect;if(m.isSelected($p.event)){if($d.allowMultiSelect){if($11){m.remove($p.event);}else{var $03=m.list.length;m.clear(true);if($03>1){m.add($p.event);}}}else{m.clear(true);}}else{if($d.allowMultiSelect){if($11){m.add($p.event);}else{m.clear(true);m.add($p.event);}}else{m.clear(true);m.add($p.event);}};m.redraw();m.updateHidden();};this.multiselect.shouldBeSelected=function(e){if(!this.initList){return false;};for(var i=0;i<this.initList.length;i++){var ei=this.initList[i];if(ei.value!==null&&e.value()!==null&&ei.value===e.value()){return true;};if(ei.value===null&&e.value()===null&&ei.recurrentMasterId===e.recurrentMasterId()&&e.start().toStringSortable()===ei.start){return true;}};return false;};this.multiselect.alert=function(){var m=$d.multiselect;var $12=[];for(var i=0;i<m.list.length;i++){var event=m.list[i];$12.push(event.value());};alert($12.join("\n"));};this.multiselect.add=function(ev){var m=$d.multiselect;if(m.indexOf(ev)==-1){m.list.push(ev);}};this.multiselect.remove=function(ev){var m=$d.multiselect;var i=m.indexOf(ev);if(i!=-1){m.list.splice(i,1);}};this.multiselect.clear=function($13){var m=$d.multiselect;m.list=[];if($13){return;};m.redraw();};this.multiselect.redraw=function(){var m=$d.multiselect;for(var i=0;i<$d.elements.events.length;i++){var $p=$d.elements.events[i];if(m.isSelected($p.event)){m.divSelect($p);}else{m.divDeselect($p);}}};this.multiselect.divSelect=function($p){var m=$d.multiselect;var cn=$d.applyCssClass("selected");var c=m.findContentDiv($p);if(c){if(c.className){if(c.className.indexOf(cn)==-1){c.className+=" "+cn;}}else{c.className=cn;}};m.divs.push($p);};this.multiselect.findContentDiv=function($p){return $p.firstChild;};this.multiselect.divDeselectAll=function(){var m=$d.multiselect;for(var i=0;i<m.divs.length;i++){var $p=m.divs[i];m.divDeselect($p,true);};m.divs=[];};this.multiselect.divDeselect=function($p,$14){var m=$d.multiselect;var cn=$d.applyCssClass("selected");var c=m.findContentDiv($p);if(c&&c.className&&c.className.indexOf(cn)!=-1){c.className=c.className.replace(cn,"");};if($14){return;};var i=DayPilot.indexOf(m.divs,$p);if(i!=-1){m.divs.splice(i,1);}};this.multiselect.isSelected=function(ev){return $d.multiselect.indexOf(ev)!=-1;};this.multiselect.indexOf=function(ev){return DayPilot.indexOf($d.multiselect.list,ev);};this.startAutoRefresh=function($15){if($15){this.autoRefreshEnabled=true;};if(!this.autoRefreshEnabled){return;};if(this.autoRefreshCount>=this.autoRefreshMaxCount){return;};this.stopAutoRefresh();var $16=this.autoRefreshInterval;if(!$16||$16<10){throw "The minimum autoRefreshInterval is 10 seconds";};this.autoRefreshTimeout=window.setTimeout(function(){$d.doRefresh();},this.autoRefreshInterval*1000);};this.stopAutoRefresh=function(){if(this.autoRefreshTimeout){window.clearTimeout(this.autoRefreshTimeout);}};this.doRefresh=function(){if(!DayPilotMonth.eventResizing&&!DayPilotMonth.eventMoving&&!DayPilotMonth.timeRangeSelecting){this.autoRefreshCount++;this.commandCallBack(this.autoRefreshCommand);};if(this.autoRefreshCount<this.autoRefreshMaxCount){this.autoRefreshTimeout=window.setTimeout(function(){$d.doRefresh();},this.autoRefreshInterval*1000);}};this.registerGlobalHandlers=function(){if(!DayPilotMonth.globalHandlers){DayPilotMonth.globalHandlers=true;DayPilot.re(document,'mouseup',DayPilotMonth.gMouseUp);}};this.loadFromServer=function(){return(typeof this.events==='undefined')||(this.events===null);};this.initShort=function(){this.prepareRows();this.drawRelative();this.drawTable();this.registerGlobalHandlers();this.startAutoRefresh();this.callBack2('Init');};this.Init=function(){var $17=this.loadFromServer();if($17){this.initShort();return;};this.prepareRows();this.prepareEvents();this.drawRelative();this.drawTable();this.drawEvents();this.registerGlobalHandlers();if(this.messageHTML){this.message(this.messageHTML,5000);};this.afterRender(null,false);this.startAutoRefresh();};};DayPilotMonth.Event=function($d,$q,$k){this.root=$d;this.contextMenu=$q.event.ContextMenu;this.eventPart=$q;var ev=this;this.value=function(){return $q.event.Value;};this.text=function(){return $q.event.Text;};this.start=function(){return new DayPilot.Date($q.event.Start);};this.end=function(){return new DayPilot.Date($q.event.End);};this.recurrent=function(){return $q.event.Recurrent;};this.recurrentMasterId=function(){return $q.event.RecurrentMasterId;};this.staticBubbleHTML=function(){return $q.event.StaticBubbleHTML;};this.partStart=function(){return $d.rows[$k].getPartStart($q.event);};this.partEnd=function(){return $d.rows[$k].getPartEnd($q.event);};this.tag=function($18){var t=$q.event.Tag;if(!$18){return t;};var $19=$d.tagFields.split(",");var $07=-1;for(var i=0;i<$19.length;i++){if($18===$19[i])$07=i;};if($07===-1){throw "Field name not found.";};return t[$07];};this.clickingAllowed=function(){return true;};this.rightClickingAllowed=function(){return true;};this.client={};this.client.contextMenu=function($1a){if(typeof $1a==='undefined'){if(ev.oContextMenu){return ev.oContextMenu;};return($q.event.ContextMenu)?eval($q.event.ContextMenu):null;}else{ev.oContextMenu=$1a;}};this.toJSON=function($1b){var $1c={};$1c.value=this.value();$1c.text=this.text();$1c.start=this.start();$1c.end=this.end();$1c.resource=null;$1c.isAllDay=false;$1c.recurrentMasterId=this.recurrentMasterId();$1c.tag={};if($d.tagFields){var $19=$d.tagFields.split(",");for(var i=0;i<$19.length;i++){$1c.tag[$19[i]]=this.tag($19[i]);}};return $1c;};};DayPilotMonth.gMouseUp=function(ev){if(DayPilotMonth.movingEvent){var $1d=DayPilotMonth.movingEvent;if(!$1d.event){return;};if(!$1d.event.root){return;};if(!$1d.event.root.shadow){return;};if(!$1d.event.root.shadow.start){return;};var $d=DayPilotMonth.movingEvent.event.root;var e=DayPilotMonth.movingEvent.event;var $08=$d.shadow.start;var $y=DayPilotMonth.movingEvent.offset;$d.clearShadow();DayPilotMonth.movingEvent=null;var ev=ev||window.event;$d.eventMoveDispatch(e,$08.x,$08.y,$y,ev);ev.cancelBubble=true;if(ev.stopPropagation){ev.stopPropagation();};DayPilotMonth.movingEvent=null;return false;}else if(DayPilotMonth.resizingEvent){var $1d=DayPilotMonth.resizingEvent;if(!$1d.event){return;};if(!$1d.event.root){return;};if(!$1d.event.root.shadow){return;};if(!$1d.event.root.shadow.start){return;};var $d=DayPilotMonth.resizingEvent.event.root;var e=DayPilotMonth.resizingEvent.event;var $08=$d.shadow.start;var $x=$d.shadow.width;$d.clearShadow();DayPilotMonth.resizingEvent=null;$d.eventResizeDispatch(e,$08,$x);ev.cancelBubble=true;DayPilotMonth.resizingEvent=null;return false;}else if(DayPilotMonth.timeRangeSelecting){if(DayPilotMonth.timeRangeSelecting.moved){var $1e=DayPilotMonth.timeRangeSelecting;var $d=$1e.root;var $08=new DayPilot.Date($d.getDateFromCell($1e.from.x,$1e.from.y));var end=$08.addDays($1e.width);$d.timeRangeSelectedDispatch($08,end);$d.clearShadow();};DayPilotMonth.timeRangeSelecting=null;}};DayPilot.MonthVisible.Month=DayPilotMonth.Month;DayPilot.Month=DayPilotMonth.Month;})();

