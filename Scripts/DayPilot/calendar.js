
if(typeof DayPilot==='undefined'){var DayPilot={};};if(typeof DayPilotCalendar==='undefined'){var DayPilotCalendar=DayPilot.CalendarVisible={};};(function(){var $a=function(){};if(typeof DayPilot.Calendar!=='undefined'){return;};var DayPilotCalendar={};DayPilotCalendar.selectedCells=null;DayPilotCalendar.topSelectedCell=null;DayPilotCalendar.bottomSelectedCell=null;DayPilotCalendar.selecting=false;DayPilotCalendar.column=null;DayPilotCalendar.firstSelected=null;DayPilotCalendar.firstMousePos=null;DayPilotCalendar.originalMouse=null;DayPilotCalendar.originalHeight=null;DayPilotCalendar.originalTop=null;DayPilotCalendar.resizing=null;DayPilotCalendar.globalHandlers=false;DayPilotCalendar.moving=null;DayPilotCalendar.editing=false;DayPilotCalendar.originalText=null;DayPilotCalendar.register=function($b){if(!DayPilotCalendar.registered){DayPilotCalendar.registered=[];};var r=DayPilotCalendar.registered;for(var i=0;i<r.length;i++){if(r[i]===$b){return;}};r.push($b);};DayPilotCalendar.unregister=function($b){var a=DayPilotCalendar.registered;if(!a){return;};var i=DayPilot.indexOf(a,$b);if(i===-1){return;};a.splice(i,1);};DayPilotCalendar.getCellsAbove=function($c){var $d=[];var c=DayPilotCalendar.getColumn($c);var tr=$c.parentNode;var $e=null;while(tr&&$e!==DayPilotCalendar.firstSelected){$e=tr.getElementsByTagName("td")[c];$d.push($e);tr=tr.previousSibling;while(tr&&tr.tagName!=="TR"){tr=tr.previousSibling;}};return $d;};DayPilotCalendar.getCellsBelow=function($c){var $d=[];var c=DayPilotCalendar.getColumn($c);var tr=$c.parentNode;var $e=null;while(tr&&$e!==DayPilotCalendar.firstSelected){$e=tr.getElementsByTagName("td")[c];$d.push($e);tr=tr.nextSibling;while(tr&&tr.tagName!=="TR"){tr=tr.nextSibling;}};return $d;};DayPilotCalendar.getColumn=function($c){var i=0;while($c.previousSibling){$c=$c.previousSibling;if($c.tagName==="TD"){i++;}};return i;};DayPilotCalendar.getShadowColumn=function($f){if(!$f){return null;};var $g=$f.parentNode;while($g&&$g.tagName!=="TD"){$g=$g.parentNode;};return $g;};DayPilotCalendar.gMouseMove=function(ev){if(typeof(DayPilotCalendar)==='undefined'){return;};if(ev.insideMainD){return;}else if(ev.srcElement){if(ev.srcElement.inside){return;}};var $h=DayPilot.mc(ev);if(DayPilotCalendar.drag){document.body.style.cursor='move';if(!DayPilotCalendar.gShadow){DayPilotCalendar.gShadow=DayPilotCalendar.createGShadow(DayPilotCalendar.drag.shadowType);};var $i=DayPilotCalendar.gShadow;$i.style.left=$h.x+'px';$i.style.top=$h.y+'px';DayPilotCalendar.moving=null;DayPilotCalendar.deleteShadow(DayPilotCalendar.movingShadow);DayPilotCalendar.movingShadow=null;}};DayPilotCalendar.gUnload=function(ev){if(!DayPilotCalendar.registered){return;};var r=DayPilotCalendar.registered;for(var i=0;i<r.length;i++){var c=r[i];c.dispose();DayPilotCalendar.unregister(c);}};DayPilotCalendar.gMouseUp=function(e){if(DayPilotCalendar.resizing){if(!DayPilotCalendar.resizingShadow){DayPilotCalendar.resizing.style.cursor='default';document.body.style.cursor='default';DayPilotCalendar.resizing=null;return;};var $j=DayPilotCalendar.resizing.event;var $k=DayPilotCalendar.resizingShadow.clientHeight+4;var top=DayPilotCalendar.resizingShadow.offsetTop;var $l=DayPilotCalendar.resizing.dpBorder;DayPilotCalendar.deleteShadow(DayPilotCalendar.resizingShadow);DayPilotCalendar.resizingShadow=null;DayPilotCalendar.resizing.style.cursor='default';document.body.style.cursor='default';DayPilotCalendar.resizing=null;if($j.root.overlap){return;};$j.root.eventResizeDispatch($j,$k,top,$l);}else if(DayPilotCalendar.moving){if(!DayPilotCalendar.movingShadow){DayPilotCalendar.moving=null;document.body.style.cursor='default';return;};var $m=DayPilotCalendar.moving.helper.oldColumn;var top=DayPilotCalendar.movingShadow.offsetTop;DayPilotCalendar.deleteShadow(DayPilotCalendar.movingShadow);var $j=DayPilotCalendar.moving.event;var $n=DayPilotCalendar.movingShadow.column;var $o=DayPilotCalendar.drag;DayPilotCalendar.drag=null;DayPilotCalendar.moving=null;DayPilotCalendar.movingShadow=null;document.body.style.cursor='default';if($o){if(!$j.root.todo){$j.root.todo={};};$j.root.todo.del=$o.element;};if($j.root.overlap){return;};var ev=e||window.event;$j.root.eventMoveDispatch($j,$n,top,ev,$o);};if(DayPilotCalendar.drag){DayPilotCalendar.drag=null;document.body.style.cursor=null;};if(DayPilotCalendar.gShadow){document.body.removeChild(DayPilotCalendar.gShadow);DayPilotCalendar.gShadow=null;};DayPilotCalendar.moveOffsetY=null;};DayPilotCalendar.dragStart=function(element,$p,id,$q,$r){DayPilot.us(element);var $o=DayPilotCalendar.drag={};$o.element=element;$o.duration=$p;$o.text=$q;$o.id=id;$o.shadowType=$r?$r:'Fill';return false;};DayPilotCalendar.deleteShadow=function($i){if(!$i){return;};if(!$i.parentNode){return;};$i.parentNode.removeChild($i);};DayPilotCalendar.createShadow=function($f,$s,$r){var $g=$f.parentNode;while($g&&$g.tagName!=="TD"){$g=$g.parentNode;};var $i=document.createElement('div');$i.setAttribute('unselectable','on');$i.style.position='absolute';$i.style.width=($f.offsetWidth-4)+'px';$i.style.height=($f.offsetHeight-4)+'px';$i.style.left=($f.offsetLeft)+'px';$i.style.top=($f.offsetTop)+'px';$i.style.border='2px dotted #666666';$i.style.zIndex=101;if($r==='Fill'){$i.style.backgroundColor="#aaaaaa";$i.style.opacity=0.5;$i.style.filter="alpha(opacity=50)";$i.style.border='2px solid #aaaaaa';if($s){$i.style.overflow='hidden';$i.style.fontSize=$f.style.fontSize;$i.style.fontFamily=$f.style.fontFamily;$i.style.color=$f.style.color;$i.innerHTML=$f.data.InnerHTML;}};if($f.event&&$f.event.root&&$f.event.root.roundedCorners){$i.style.MozBorderRadius="5px";$i.style.webkitBorderRadius="5px";$i.style.borderRadius="5px";};$g.firstChild.appendChild($i);return $i;};DayPilotCalendar.createGShadow=function($r){var $i=document.createElement('div');$i.setAttribute('unselectable','on');$i.style.position='absolute';$i.style.width='100px';$i.style.height='20px';$i.style.border='2px dotted #666666';$i.style.zIndex=101;if($r==='Fill'){$i.style.backgroundColor="#aaaaaa";$i.style.opacity=0.5;$i.style.filter="alpha(opacity=50)";$i.style.border='2px solid #aaaaaa';};document.body.appendChild($i);return $i;};DayPilotCalendar.moveShadow=function($t){var $i=DayPilotCalendar.movingShadow;var parent=$i.parentNode;parent.style.display='none';$i.parentNode.removeChild($i);$t.firstChild.appendChild($i);$i.style.left='0px';parent.style.display='';$i.style.width=(DayPilotCalendar.movingShadow.parentNode.offsetWidth+1)+'px';};DayPilotCalendar.Calendar=function(id){var $u=false;if(this instanceof DayPilotCalendar.Calendar&&!this.$2M){$u=true;this.$2M=true;};if(!$u){throw "DayPilot.Calendar() is a constructor and must be called as 'var c = new DayPilot.Calendar(id);'";};var $b=this;this.uniqueID=null;this.id=id;this.clientName=id;this.clientState={};this.cache={};this.cache.pixels={};this.elements={};this.elements.events=[];this.nav={};this.afterRender=function(){};this.fasterDispose=true;this.allDayEventBorderColor="#000000";this.allDayEventFontFamily='Tahoma';this.allDayEventFontSize='8pt';this.allDayEventFontColor="#000000";this.allDayEventHeight=16;this.allowEventOverlap=true;this.allowMultiSelect=true;this.autoRefreshCommand='refresh';this.autoRefreshEnabled=false;this.autoRefreshInterval=60;this.autoRefreshMaxCount=20;this.borderColor="#000000";this.businessBeginsHour=9;this.businessEndsHour=18;this.cellBackColor="#FFFFD5";this.cellBackColorNonBusiness="#FFF4BC";this.cellBorderColor="#999999";this.cellHeight=20;this.cellDuration=30;this.columnMarginRight=5;this.cornerBackColor="#ECE9D8";this.dayBeginsHour=0;this.dayEndsHour=24;this.days=1;this.deleteImageUrl=null;this.durationBarColor='blue';this.durationBarVisible=true;this.durationBarWidth=5;this.durationBarImageUrl=null;this.eventArrangement="SideBySide";this.eventBackColor='#ffffff';this.eventBorderColor="#000000";this.eventFontFamily='Tahoma';this.eventFontSize='8pt';this.eventFontColor="#000000";this.eventSelectColor='blue';this.headerFontSize='10pt';this.headerFontFamily='Tahoma';this.headerFontColor="#000000";this.headerHeight=21;this.headerLevels=1;this.height=300;this.heightSpec='BusinessHours';this.hideFreeCells=false;this.hourHalfBorderColor="#F3E4B1";this.hourBorderColor="#EAD098";this.hourFontColor="#000000";this.hourFontFamily="Tahoma";this.hourFontSize="16pt";this.hourNameBackColor="#ECE9D8";this.hourNameBorderColor="#ACA899";this.hourWidth=45;this.initScrollPos=0;this.loadingLabelText="Loading...";this.loadingLabelVisible=true;this.loadingLabelBackColor="orange";this.loadingLabelFontColor="#ffffff";this.loadingLabelFontFamily="Tahoma";this.loadingLabelFontSize="10pt";this.moveBy="Left";this.numberFormat="0.00";this.roundedCorners=false;this.rtl=false;this.selectedColor="#316AC5";this.shadow='Fill';this.showToolTip=true;this.showAllDayEvents=false;this.showAllDayEventStartEnd=true;this.showHeader=true;this.showHours=true;this.startDate=new DayPilot.Date().getDatePart();this.timeFormat='Clock12Hours';this.useEventBoxes='Always';this.useEventSelectionBars=false;this.viewType='Days';this.timeRangeSelectedHandling='Disabled';this.eventClickHandling='Disabled';this.eventDoubleClickHandling='Disabled';this.eventRightClickHandling='Disabled';this.eventDeleteHandling='Disabled';this.eventEditHandling='Disabled';this.eventHoverHandling='Bubble';this.eventResizeHandling='Disabled';this.eventMoveHandling='Disabled';this.headerClickHandling='Disabled';this.transparent=false;this.bg=false;this.autoRefreshCount=0;this.clearSelection=function(){for(var j=0;j<DayPilotCalendar.selectedCells.length;j++){var $c=DayPilotCalendar.selectedCells[j];if($c){if($c.selected){$c.removeChild($c.selected);$c.firstChild.style.display='';$c.selected=null;}}}};this.ie=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("MSIE")!==-1);this.ff=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!==-1);this.opera105=(function(){if(/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var v=new Number(RegExp.$1);return v>=10.5;};return false;})();this.webkit522=(function(){if(/AppleWebKit[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var v=new Number(RegExp.$1);return v>=522;};return false;})();this.ie9=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("MSIE 9")!==-1);this.cleanSelection=this.clearSelection;this.postBack2=function($v,$w,$x){var $y={};$y.action=$v;$y.parameters=$x;$y.data=$w;$y.header=this.getCallBackHeader();var $z="JSON"+DayPilot.JSON.stringify($y);__doPostBack($b.uniqueID,$z);};this.callBack2=function($v,$w,$x){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};this.callbackTimeout=window.setTimeout(function(){$b.loadingStart();},100);var $y={};$y.action=$v;$y.parameters=$x;$y.data=$w;$y.header=this.getCallBackHeader();var $z="JSON"+DayPilot.JSON.stringify($y);if(this.backendUrl){DayPilot.request(this.backendUrl,this.callBackResponse,$z,this.ajaxError);}else{WebForm_DoCallback(this.uniqueID,$z,this.updateView,this.clientName,this.callbackError,true);}};this.dispose=function(){var c=$b;c.deleteEvents();if(c.nav.messageClose){c.nav.messageClose.onclick=null;};if(c.nav.hourTable)c.nav.hourTable.oncontextmenu=null;if(c.nav.header)c.nav.header.oncontextmenu=null;if(c.nav.header)c.nav.corner.oncontextmenu=null;c.nav.zoom.onmousemove=null;c.nav.scroll.onscroll=null;c.nav.scroll.root=null;DayPilot.pu(c.nav.loading);c.disposeMain();c.disposeHeader();c.nav.select=null;c.nav.cornerRight=null;c.nav.scrollable=null;c.nav.allday=null;c.nav.zoom=null;c.nav.loading=null;c.nav.header=null;c.nav.hourTable=null;c.nav.scrolltop=null;c.nav.scroll=null;c.nav.vsph=null;c.nav.main=null;c.nav.message=null;c.nav.messageClose=null;c.nav.top=null;DayPilot.ue(window,'resize',c.resize);DayPilotCalendar.unregister(c);};this.registerDispose=function(){var $A=document.getElementById(id);$A.dispose=this.dispose;};this.callBackResponse=function($B){$b.updateView($B.responseText);};this.getCallBackHeader=function(){var h={};h.control="dpc";h.id=this.id;h.clientState=$b.clientState;h.columns=this.getTreeState();h.days=$b.days;h.startDate=$b.startDate;h.cellDuration=$b.cellDuration;h.heightSpec=$b.heightSpec;h.businessBeginsHour=$b.businessBeginsHour;h.businessEndsHour=$b.businessEndsHour;h.viewType=$b.viewType;h.dayBeginsHour=$b.dayBeginsHour;h.dayEndsHour=$b.dayEndsHour;h.headerLevels=$b.headerLevels;h.backColor=$b.cellBackColor;h.nonBusinessBackColor=$b.cellBackColorNonBusiness;h.eventHeaderVisible=$b.eventHeaderVisible;h.timeFormat=$b.timeFormat;h.locale=$b.locale;h.showAllDayEvents=$b.showAllDayEvents;h.tagFields=$b.tagFields;h.hourNameBackColor=$b.hourNameBackColor;h.hourFontFamily=$b.hourFontFamily;h.hourFontSize=$b.hourFontSize;h.hourFontColor=$b.hourFontColor;h.selected=$b.multiselect.events();h.hashes=$b.hashes;return h;};this.getTreeState=function(){var $C=[];$C.ignoreToJSON=true;if(!this.columns){return $C;};for(var i=0;i<this.columns.length;i++){var $t=this.columns[i];var $D=this.getNodeState($t);$C.push($D);};return $C;};this.getNodeState=function($t){var $D={};$D.Value=$t.Value;$D.Name=$t.Name;$D.ToolTip=$t.ToolTip;$D.Date=$t.Start;$D.Children=this.getNodeChildren($t.Children);return $D;};this.getNodeChildren=function($d){var $E=[];$E.ignoreToJSON=true;if(!$d){return $E;};for(var i=0;i<$d.length;i++){$E.push(this.getNodeState($d[i]));};return $E;};this.listener=function($f){if(!this.listeners){this.listeners=[];};this.listeners.push($f);};this.callListeners=function($v,$w){if(!this.listeners){return;};for(var i=0;i<this.listeners.length;i++){this.listeners[i]();}};this.updateView=function($F,$G){var $F=eval("("+$F+")");if($F.BubbleGuid){var $H=$F.BubbleGuid;var $I=this.bubbles[$H];delete this.bubbles[$H];$b.loadingStop();$I.updateView($F.Result.BubbleHTML,$I);return;};if($F.UpdateType==="None"){$b.loadingStop();if($F.Message){$b.message($F.Message,5000);};return;};if($F.VsUpdate){var $J=document.createElement("input");$J.type='hidden';$J.name=$b.id+"_vsupdate";$J.id=$J.name;$J.value=$F.VsUpdate;$b.nav.vsph.innerHTML='';$b.nav.vsph.appendChild($J);};$b.deleteEvents();$b.multiselect.clear(true);$b.multiselect.initList=$F.SelectedEvents;if($F.UpdateType==="Full"){$b.colors=$F.Colors;$b.dirtyColors=$F.DirtyColors;$b.cellProperties=$F.CellProperties;$b.columns=$F.Columns;$b.days=$F.Days;$b.startDate=new DayPilot.Date($F.StartDate);$b.cellDuration=$F.CellDuration;$b.heightSpec=$F.HeightSpec?$F.HeightSpec:$b.heightSpec;$b.businessBeginsHour=$F.BusinessBeginsHour?$F.BusinessBeginsHour:$b.businessBeginsHour;$b.businessEndsHour=$F.BusinessEndsHour?$F.BusinessEndsHour:$b.businessEndsHour;$b.viewType=$F.ViewType;$b.headerLevels=$F.HeaderLevels;$b.backColor=$F.BackColor?$F.BackColor:$b.backColor;$b.nonBusinessBackColor=$F.NonBusinessBackColor?$F.NonBusinessBackColor:$b.nonBusinessBackColor;$b.eventHeaderVisible=$F.EventHeaderVisible?$F.EventHeaderVisible:$b.eventHeaderVisible;$b.timeFormat=$F.TimeFormat?$F.TimeFormat:$b.timeFormat;$b.locale=$F.Locale?$F.Locale:$b.locale;$b.dayBeginsHour=typeof $F.DayBeginsHour!='undefined'?$F.DayBeginsHour:$b.dayBeginsHour;$b.dayEndsHour=typeof $F.DayEndsHour!='undefined'?$F.DayEndsHour:$b.dayEndsHour;$b.cornerBackColor=$F.CornerBackColor;$b.cornerHTML=$F.CornerHTML;$b.hours=$F.Hours;$b.prepareColumns();};if($F.Hashes){for($K in $F.Hashes){$b.hashes[$K]=$F.Hashes[$K];}};$b.loadEvents($F.Events);$b.updateHeaderHeight();if($F.TagFields){$b.tagFields=$F.TagFields;};if($F.UpdateType==="Full"||$b.hideFreeCells){$b.deleteScrollLabels();$b.updateMessagePosition();$b.drawHeader();$b.drawMain();$b.drawHourTable();$b.updateHeight();};$b.drawEvents();$b.drawEventsAllDay();if($b.timeRangeSelectedHandling!=="HoldForever"){$b.clearSelection();};$b.updateScrollLabels();if($b.todo){if($b.todo.del){var $L=$b.todo.del;$L.parentNode.removeChild($L);$b.todo.del=null;}};$b.afterRender($F.CallBackData,true);$b.loadingStop();$b.startAutoRefresh();if($F.Message){$b.message($F.Message,20000);}};this.$=function($M){return document.getElementById(id+"_"+$M);};this.isOverlapping=function($t){var $i=DayPilotCalendar.movingShadow||DayPilotCalendar.resizingShadow;var $f=DayPilotCalendar.moving||DayPilotCalendar.resizing;if(!$i){return false;};if(!$t){$t=$f.data.DayIndex;};var $N=parseInt($i.style.top,10);var $O=parseInt($i.style.height,10);var $P=$N+$O;for(var i=0;i<this.events.length;i++){var $w=this.events[i];if($t!==$w.DayIndex){continue;};var pk=$f.event.value();if($w.Value===pk){continue;};var $Q=$w.Top+$w.Height;if($N>=$Q||$P<=$w.Top){continue;}else{return true;}};return false;};this.createShadow=function($p,$r){var $R=$b.nav.main;var $S=$R.clientWidth/$R.rows[0].cells.length;var i=Math.floor(($b.coords.x-45)/$S);if(i<0){i=0;};var $t=$R.rows[0].cells[i];var $k=$p*$b.cellHeight/(60*$b.cellDuration);var $T=1;var top=Math.floor((($b.coords.y-$T)+$b.cellHeight/2) / $b.cellHeight)*$b.cellHeight+$T;var $i=document.createElement('div');$i.setAttribute('unselectable','on');$i.style.position='absolute';$i.style.width=($t.offsetWidth-4)+'px';$i.style.height=($k-4)+'px';$i.style.left='0px';$i.style.top=top+'px';$i.style.border='2px dotted #666666';$i.style.zIndex=101;$i.exclude=true;if($r==='Fill'){$i.style.backgroundColor="#aaaaaa";$i.style.opacity=0.5;$i.style.filter="alpha(opacity=50)";$i.style.border='2px solid #aaaaaa';};if(this.roundedCorners){$i.style.MozBorderRadius="5px";$i.style.webkitBorderRadius="5px";$i.style.borderRadius="5px";};$t.firstChild.appendChild($i);return $i;};this.durationHours=function(){return this.duration()/(60*60*1000);};this.businessHoursSpan=function(){if(this.businessBeginsHour>this.businessEndsHour){return 24-this.businessBeginsHour+this.businessEndsHour;}else{return this.businessEndsHour-this.businessBeginsHour;}};this.dayHoursSpan=function(){if(this.dayBeginsHour>=this.dayEndsHour){return 24-this.dayBeginsHour+this.dayEndsHour;}else{return this.dayEndsHour-this.dayBeginsHour;}};this.duration=function($U){var $V=0;if(this.heightSpec==='BusinessHoursNoScroll'){$V=this.businessHoursSpan();}else if(this.hideFreeCells&&!$U){var $W=(this.maxEnd-1)*this.cellDuration/this.cellHeight;var $X=Math.ceil($W/60);$V=Math.max(this.dayBeginsHour+$X,this.businessEndsHour)-this.visibleStart();}else{$V=this.dayHoursSpan();};return $V*60*60*1000;};this.message=function($Y,$Z,$00,$01){if(!$Y){return;};var $Z=$Z||2000;var $00=$00||"#ffffff";var $01=$01||"#000000";var $02=0.8;var $03;if(!this.nav.message){$03=document.createElement("div");$03.style.position="absolute";$03.style.width="100%";$03.style.left="0px";$03.style.textAlign="left";$03.style.top=(this.totalHeaderHeight()+2)+"px";$03.style.opacity=$02;$03.style.filter="alpha(opacity="+($02*100)+")";$03.style.display='none';var $04=document.createElement("div");$04.style.marginLeft=(this.hourWidth+2)+"px";if(this.nav.cornerRight){$04.style.marginRight=DayPilot.sw($b.nav.scroll)+"px";};$04.style.padding="5px";$03.appendChild($04);var close=document.createElement("div");close.style.top="5px";close.style.right=(DayPilot.sw($b.nav.scroll)+5)+"px";close.style.color=$00;close.style.lineHeight="100%";close.style.position="absolute";close.style.cursor="pointer";close.style.fontWeight="bold";close.innerHTML="X";close.onclick=function(){$b.nav.message.style.display='none';};$03.appendChild(close);this.nav.top.insertBefore($03,this.nav.loading);this.nav.message=$03;this.nav.messageClose=close;}else{this.nav.message.style.top=(this.totalHeaderHeight()+2)+"px";};var $05=function(){$b.nav.message.style.opacity=$02;var $04=$b.nav.message.firstChild;$04.style.backgroundColor=$01;$04.style.color=$00;$04.innerHTML=$Y;var end=function(){$b.messageTimeout=setTimeout($b.hideMessage,$Z);};DayPilot.fade($b.nav.message,0.2,end);};if(this.nav.message.style.display!=='none'){clearTimeout($b.messageTimeout);DayPilot.fade($b.nav.message,-0.2,$05);}else{$05();}};this.hideMessage=function(){var end=function(){$b.nav.message.style.display='none';};DayPilot.fade($b.nav.message,-0.2,end);};this.hideMessageNow=function(){if(this.nav.message){this.nav.message.style.display='none';}};this.updateMessagePosition=function(){if(this.nav.message){this.nav.message.style.top=(this.totalHeaderHeight()+2)+"px";}};this.rowCount=function(){return this.duration()/(60*1000*this.cellDuration);};this.eventClickPostBack=function(e,$w){this.postBack2('EventClick',$w,e);};this.eventClickCallBack=function(e,$w){this.callBack2('EventClick',$w,e);};this.eventClickDispatch=function(e){var $03=this;var e=e||window.event;var $06=e.ctrlKey;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($b.eventDoubleClickHandling==='Disabled'){$b.eventClickSingle($03,$06);return;};if(!$b.timeouts){$b.timeouts=[];}else{for(var $07 in $b.timeouts){window.clearTimeout($b.timeouts[$07]);};$b.timeouts=[];};var $08=function($03,$06){return function(){$b.eventClickSingle($03,$06);};};$b.timeouts.push(window.setTimeout($08(this,$06),300));};this.eventClickSingle=function($09,$06){var e=$09.event;if(!e.clickingAllowed()){return;};switch($b.eventClickHandling){case 'PostBack':$b.eventClickPostBack(e);break;case 'CallBack':$b.eventClickCallBack(e);break;case 'JavaScript':$b.onEventClick(e);break;case 'Edit':if(!e.isAllDay()){$b.divEdit($09);};break;case 'Select':if(!e.isAllDay()){$b.eventSelect(e,$06);};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent(e);};break;case 'ContextMenu':var $0a=e.client.contextMenu();if($0a){$0a.show(e);}else{if($b.contextMenu){$b.contextMenu.show(e);}};break;}};this.eventDoubleClickPostBack=function(e,$w){this.postBack2('EventDoubleClick',$w,e);};this.eventDoubleClickCallBack=function(e,$w){this.callBack2('EventDoubleClick',$w,e);};this.eventDoubleClickDispatch=function(){if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($b.timeouts){for(var $07 in $b.timeouts){window.clearTimeout($b.timeouts[$07]);};$b.timeouts=null;};var e=this.event;switch($b.eventDoubleClickHandling){case 'PostBack':$b.eventDoubleClickPostBack(e);break;case 'CallBack':$b.eventDoubleClickCallBack(e);break;case 'JavaScript':$b.onEventDoubleClick(e);break;case 'Edit':if(!e.isAllDay()){$b.divEdit(this);};break;case 'Select':if(!e.isAllDay()){$b.eventSelect(e);};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent(e);};break;}};this.eventRightClickPostBack=function(e,$w){this.postBack2('EventRightClick',$w,e);};this.eventRightClickCallBack=function(e,$w){this.callBack2('EventRightClick',$w,e);};this.eventRightClickDispatch=function(){var e=this.event;if(!e.rightClickingAllowed()){return false;};switch($b.eventRightClickHandling){case 'PostBack':$b.eventRightClickPostBack(e);break;case 'CallBack':$b.eventRightClickCallBack(e);break;case 'JavaScript':$b.onEventRightClick(e);break;case 'ContextMenu':var $0a=e.client.contextMenu();if($0a){$0a.show(e);}else{if($b.contextMenu){$b.contextMenu.show(e);}};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent(e);};break;};return false;};this.headerClickPostBack=function(c,$w){this.postBack2('HeaderClick',$w,c);};this.headerClickCallBack=function(c,$w){this.callBack2('HeaderClick',$w,c);};this.headerClickDispatch=function($f){var $w=this.data;var c=new DayPilotCalendar.Column($w.Value,$w.Name,$w.Start);switch($b.headerClickHandling){case 'PostBack':$b.headerClickPostBack(c);break;case 'CallBack':$b.headerClickCallBack(c);break;case 'JavaScript':$b.onHeaderClick(c);break;}};this.headerMouseMove=function(){if(typeof(DayPilotBubble)!=='undefined'&&$b.columnBubble){if($b.viewType==="Resources"){var $0b={};$0b.calendar=$b;$0b.id=this.data.Value;$0b.toJSON=function(){var $0c={};$0c.id=this.id;return $0c;};$b.columnBubble.showResource($0b);}else{var $0d=new DayPilot.Date(this.data.Start);var end=$0d.addDays(1);var $0e={};$0e.calendar=$b;$0e.start=$0d;$0e.end=end;$0e.toJSON=function(){var $0c={};$0c.start=this.start;$0c.end=this.end;return $0c;};$b.columnBubble.showTime($0e);}}};this.headerMouseOut=function(){if(typeof(DayPilotBubble)!=='undefined'&&$b.columnBubble){$b.columnBubble.hideOnMouseOut();}};this.eventDeletePostBack=function(e,$w){this.postBack2('EventDelete',$w,e);};this.eventDeleteCallBack=function(e,$w){this.callBack2('EventDelete',$w,e);};this.eventDeleteDispatch=function($f){var e=$f.parentNode.parentNode.event;switch($b.eventDeleteHandling){case 'PostBack':$b.eventDeletePostBack(e);break;case 'CallBack':$b.eventDeleteCallBack(e);break;case 'JavaScript':$b.onEventDelete(e);break;}};this.eventResizePostBack=function(e,$0f,$0g,$w){if(!$0f)throw 'newStart is null';if(!$0g)throw 'newEnd is null';var $0h={};$0h.e=e;$0h.newStart=$0f;$0h.newEnd=$0g;this.postBack2('EventResize',$w,$0h);};this.eventResizeCallBack=function(e,$0f,$0g,$w){if(!$0f)throw 'newStart is null';if(!$0g)throw 'newEnd is null';var $0h={};$0h.e=e;$0h.newStart=$0f;$0h.newEnd=$0g;this.callBack2('EventResize',$w,$0h);};this.visibleStart=function($U){if(this.heightSpec==='BusinessHoursNoScroll'){return this.businessBeginsHour;}else if(this.hideFreeCells&&!$U){var $W=(this.minStart-1)*this.cellDuration/this.cellHeight;var $X=Math.floor($W/60);return Math.min(this.dayBeginsHour+$X,this.businessBeginsHour);}else{return this.dayBeginsHour;}};this.eventResizeDispatch=function(e,$O,$N,$l){var $T=1;var $0f=new Date();var $0g=new Date();var $0d=e.start();var end=e.end();var $0i=$b.cellDuration;var $0j=new Date();if($l==='top'){var $0k=$b.columnsBottom[e.div.data.DayIndex].Start;$0j=$0d.getDatePart();var $0l=Math.floor(($N-$T)/$b.cellHeight);var $0m=$0l*$0i;var ts=$0m*60*1000;var $0n=$b.visibleStart()*60*60*1000;$0f=$0k.addTime(ts+$0n);$0g=e.end();}else if($l==='bottom'){var $0k=$b.columnsBottom[e.div.data.DayIndex].Start;$0j=end.getDatePart();var $0l=Math.floor(($N+$O-$T)/$b.cellHeight);var $0m=$0l*$0i;var ts=$0m*60*1000;var $0n=$b.visibleStart()*60*60*1000;$0f=$0d;$0g=$0k.addTime(ts+$0n);};switch($b.eventResizeHandling){case 'PostBack':$b.eventResizePostBack(e,$0f,$0g);break;case 'CallBack':$b.eventResizeCallBack(e,$0f,$0g);break;case 'JavaScript':$b.onEventResize(e,$0f,$0g);break;}};this.eventMovePostBack=function(e,$0f,$0g,$0o,$w){if(!$0f)throw 'newStart is null';if(!$0g)throw 'newEnd is null';var $0h={};$0h.e=e;$0h.newStart=$0f;$0h.newEnd=$0g;$0h.newResource=$0o;this.postBack2('EventMove',$w,$0h);};this.eventMoveCallBack=function(e,$0f,$0g,$0o,$w){if(!$0f)throw 'newStart is null';if(!$0g)throw 'newEnd is null';var $0h={};$0h.e=e;$0h.newStart=$0f;$0h.newEnd=$0g;$0h.newResource=$0o;this.callBack2('EventMove',$w,$0h);};this.eventMoveDispatch=function(e,$n,$N,ev,$o){var $T=1;var $0l=Math.floor(($N-$T)/$b.cellHeight);var $0i=$b.cellDuration;var $0p=$0l*$0i*60*1000;var $0d=e.start();var end=e.end();var $0j=new Date();if($0d.isDayPilotDate){$0d=$0d.d;};$0j.setTime(Date.UTC($0d.getUTCFullYear(),$0d.getUTCMonth(),$0d.getUTCDate()));var $0q=($b.useEventBoxes!=='Never')?$0d.getTime()-($0j.getTime()+$0d.getUTCHours()*3600*1000+Math.floor($0d.getUTCMinutes()/$0i)*$0i*60*1000):0;var length=end.getTime()-$0d.getTime();var $0n=$b.visibleStart()*3600*1000;var $0r=this.columnsBottom[$n];var $0s=$0r.Start.getTime();var $0t=new Date();$0t.setTime($0s+$0p+$0q+$0n);var $0f=new DayPilot.Date($0t);var $0g=$0f.addTime(length);switch($b.eventMoveHandling){case 'PostBack':$b.eventMovePostBack(e,$0f,$0g,$0r.Value);break;case 'CallBack':$b.eventMoveCallBack(e,$0f,$0g,$0r.Value);break;case 'JavaScript':$b.onEventMove(e,$0f,$0g,$0r.Value,$o?true:false,ev.ctrlKey,ev.shiftKey);break;}};this.eventBubbleCallBack=function(e,$I){var $H=DayPilot.guid();if(!this.bubbles){this.bubbles=[];};this.bubbles[$H]=$I;var $0h={};$0h.e=e;$0h.guid=$H;this.callBack2("EventBubble",null,$0h);};this.bubbleCallBack=function($0u,$I){var $H=this.recordBubbleCall($I);var $0h={};$0h.args=$0u;$0h.guid=$H;this.callBack2("Bubble",null,$0h);};this.recordBubbleCall=function($I){var $H=DayPilot.guid();if(!this.bubbles){this.bubbles=[];};this.bubbles[$H]=$I;return $H;};this.eventMenuClickPostBack=function(e,$0v,$w){var $0h={};$0h.e=e;$0h.command=$0v;this.postBack2('EventMenuClick',$w,$0h);};this.eventMenuClickCallBack=function(e,$0v,$w){var $0h={};$0h.e=e;$0h.command=$0v;this.callBack2('EventMenuClick',$w,$0h);};this.eventMenuClick=function($0v,e,$0w){switch($0w){case 'PostBack':$b.eventMenuClickPostBack(e,$0v);break;case 'CallBack':$b.eventMenuClickCallBack(e,$0v);break;}};this.timeRangeMenuClickPostBack=function(e,$0v,$w){var $0h={};$0h.selection=e;$0h.command=$0v;this.postBack2("TimeRangeMenuClick",$w,$0h);};this.timeRangeMenuClickCallBack=function(e,$0v,$w){var $0h={};$0h.selection=e;$0h.command=$0v;this.callBack2("TimeRangeMenuClick",$w,$0h);};this.timeRangeMenuClick=function($0v,e,$0w){switch($0w){case 'PostBack':$b.timeRangeMenuClickPostBack(e,$0v);break;case 'CallBack':$b.timeRangeMenuClickCallBack(e,$0v);break;}};this.timeRangeSelectedPostBack=function($0d,end,$0x,$w){var $0y={};$0y.start=$0d;$0y.end=end;$0y.resource=$0x;this.postBack2('TimeRangeSelected',$w,$0y);};this.timeRangeSelectedCallBack=function($0d,end,$0x,$w){var $0y={};$0y.start=$0d;$0y.end=end;$0y.resource=$0x;this.callBack2('TimeRangeSelected',$w,$0y);};this.timeRangeSelectedDispatch=function($0d,end,$t){if(!$0d.isDayPilotDate){$0d=new DayPilot.Date($0d);};if(!end.isDayPilotDate){end=new DayPilot.Date(end);};switch($b.timeRangeSelectedHandling){case 'PostBack':$b.timeRangeSelectedPostBack($0d,end,$t);break;case 'CallBack':$b.timeRangeSelectedCallBack($0d,end,$t);break;case 'JavaScript':$b.onTimeRangeSelected($0d,end,$t);break;}};this.timeRangeDoubleClickPostBack=function($0d,end,$t,$w){var $0y={};$0y.start=$0d;$0y.end=end;$0y.resource=$t;this.postBack2('TimeRangeDoubleClick',$w,$0y);};this.timeRangeDoubleClickCallBack=function($0d,end,$t,$w){var $0y={};$0y.start=$0d;$0y.end=end;$0y.resource=$t;this.callBack2('TimeRangeDoubleClick',$w,$0y);};this.timeRangeDoubleClickDispatch=function($0d,end,$t){switch($b.timeRangeDoubleClickHandling){case 'PostBack':$b.timeRangeDoubleClickPostBack($0d,end,$t);break;case 'CallBack':$b.timeRangeDoubleClickCallBack($0d,end,$t);break;case 'JavaScript':$b.onTimeRangeDoubleClick($0d,end,$t);break;}};this.eventEditPostBack=function(e,$0z,$w){var $0h={};$0h.e=e;$0h.newText=$0z;this.postBack2("EventEdit",$w,$0h);};this.eventEditCallBack=function(e,$0z,$w){var $0h={};$0h.e=e;$0h.newText=$0z;this.callBack2("EventEdit",$w,$0h);};this.eventEditDispatch=function(e,$0z){switch($b.eventEditHandling){case 'PostBack':$b.eventEditPostBack(e,$0z);break;case 'CallBack':$b.eventEditCallBack(e,$0z);break;case 'JavaScript':$b.onEventEdit(e,$0z);break;}};this.eventSelectPostBack=function(e,$0A,$w){var $0h={};$0h.e=e;$0h.change=$0A;this.postBack2('EventSelect',$w,$0h);};this.eventSelectCallBack=function(e,$0A,$w){var $0h={};$0h.e=e;$0h.change=$0A;this.callBack2('EventSelect',$w,$0h);};this.eventSelectDispatch=function(e,$0A){switch($b.eventSelectHandling){case 'PostBack':$b.eventSelectPostBack(e,$0A);break;case 'CallBack':__theFormPostData="";__theFormPostCollection=[];if(WebForm_InitCallback){WebForm_InitCallback();};$b.eventSelectCallBack(e,$0A);break;case 'JavaScript':$b.onEventSelect(e,$0A);break;}};this.commandCallBack=function($0v,$w){this.stopAutoRefresh();var $0h={};$0h.command=$0v;this.callBack2('Command',$w,$0h);};this.onCellMousedown=function(ev){if(DayPilotCalendar.selecting){return;};if(DayPilotCalendar.editing){DayPilotCalendar.editing.blur();return;};if(DayPilotCalendar.selectedCells&&$b.timeRangeDoubleClickHandling!=='Disabled'){for(var i=0;i<DayPilotCalendar.selectedCells.length;i++){if(this===DayPilotCalendar.selectedCells[i]){return;}}};if($b.timeRangeSelectedHandling==="Disabled"){return;};var $0B=(window.event)?window.event.button:ev.which;if($0B!==1&&$0B!==0){return;};DayPilotCalendar.firstMousePos=DayPilot.mc(ev||window.event);DayPilotCalendar.selecting=true;if(DayPilotCalendar.selectedCells){$b.clearSelection();DayPilotCalendar.selectedCells=[];};DayPilotCalendar.column=DayPilotCalendar.getColumn(this);DayPilotCalendar.selectedCells.push(this);DayPilotCalendar.firstSelected=this;DayPilotCalendar.topSelectedCell=this;DayPilotCalendar.bottomSelectedCell=this;$b.activateSelection();};this.activateSelection=function(){var $0C=this.getSelection();for(var j=0;j<DayPilotCalendar.selectedCells.length;j++){var $c=DayPilotCalendar.selectedCells[j];if($c&&!$c.selected){var $03=document.createElement("div");$03.style.height=($b.cellHeight-1)+"px";$03.style.backgroundColor=$b.selectedColor;$c.firstChild.style.display="none";$c.insertBefore($03,$c.firstChild);$c.selected=$03;}}};this.cellMouseOut=function(ev){if(typeof(DayPilotBubble)!=='undefined'&&$b.cellBubble){$b.cellBubble.hideOnMouseOut();}};this.mousemove=function(ev){if(typeof(DayPilotCalendar)==='undefined'){return;};if(typeof(DayPilotBubble)!=='undefined'&&$b.cellBubble){var $t=DayPilotCalendar.getColumn(this);var $0b=$b.columnsBottom[$t].Value;var $c={};$c.calendar=$b;$c.start=this.start;$c.end=this.end;$c.resource=$0b;$c.toJSON=function(){var $0c={};$0c.start=this.start;$0c.end=this.end;$0c.resource=this.resource;return $0c;};$b.cellBubble.showCell($c);};if(!DayPilotCalendar.selecting){return;};var $h=DayPilot.mc(ev||window.event);var $0D=DayPilotCalendar.getColumn(this);if($0D!==DayPilotCalendar.column){return;};$b.clearSelection();if($h.y<DayPilotCalendar.firstMousePos.y){DayPilotCalendar.selectedCells=DayPilotCalendar.getCellsBelow(this);DayPilotCalendar.topSelectedCell=DayPilotCalendar.selectedCells[0];DayPilotCalendar.bottomSelectedCell=DayPilotCalendar.firstSelected;}else{DayPilotCalendar.selectedCells=DayPilotCalendar.getCellsAbove(this);DayPilotCalendar.topSelectedCell=DayPilotCalendar.firstSelected;DayPilotCalendar.bottomSelectedCell=DayPilotCalendar.selectedCells[0];};$b.activateSelection();};this.getSelection=function(){var $0d=DayPilotCalendar.topSelectedCell.start;var end=DayPilotCalendar.bottomSelectedCell.end;var $0E=DayPilotCalendar.topSelectedCell.resource;return new DayPilot.Selection($0d,end,$0E,$b);};this.mouseup=function(ev){if(DayPilotCalendar.selecting&&DayPilotCalendar.topSelectedCell!==null){DayPilotCalendar.selecting=false;var $0F=$b.getSelection();$b.timeRangeSelectedDispatch($0F.start,$0F.end,$0F.resource);if($b.timeRangeSelectedHandling!=="Hold"&&$b.timeRangeSelectedHandling!=="HoldForever"){$a();}}else{DayPilotCalendar.selecting=false;}};this.scroll=function(ev){if(!$b.initScrollPos)return;$b.scrollPos=$b.nav.scroll.scrollTop;$b.scrollHeight=$b.nav.scroll.clientHeight;$b.nav.scrollpos.value=$b.scrollPos;$b.updateScrollLabels();};this.updateScrollLabels=function(){if(!this.scrollLabelsVisible){return;};if(!this.scrollLabels){return;};var $0G=this.columnsBottom;var $0H=(this.showHours?this.hourWidth:0);var $S=(this.nav.scroll.clientWidth-$0H)/$0G.length;for(var i=0;i<$0G.length;i++){var $0I=this.nav.scrollUp[i];var $0J=this.nav.scrollDown[i];$0I.style.left=($0H+2+i*$S+$S/2)+"px";$0J.style.left=($0H+2+i*$S+$S/2)+"px";};var $0K=this.autoHiddenPixels();for(var i=0;i<this.nav.scrollUp.length;i++){var up=this.nav.scrollUp[i];var $0L=this.nav.scrollDown[i];var $0M=this.scrollLabels[i].minEnd-$0K;var $0N=this.scrollLabels[i].maxStart-$0K;if(up&&$0L){if($0M<=$b.scrollPos){up.style.top=(this.totalHeaderHeight()+2)+"px";up.style.display='';}else{up.style.display='none';};if($0N>=$b.scrollPos+$b.scrollHeight){$0L.style.top=(this.totalHeaderHeight()+this.scrollHeight-8)+"px";$0L.style.display='';}else{$0L.style.display='none';}}}};this.createEdit=function($f){var $g=$f.parentNode;while($g&&$g.tagName!=="TD"){$g=$g.parentNode;};var $0O=document.createElement('textarea');$0O.style.position='absolute';$0O.style.width=($f.parentNode.offsetWidth-2)+'px';$0O.style.height=($f.offsetHeight-2)+'px';var $0P=DayPilot.gs($f,'fontFamily');if(!$0P)$0P=DayPilot.gs($f,'font-family');$0O.style.fontFamily=$0P;var $0Q=DayPilot.gs($f,'fontSize');if(!$0Q)$0Q=DayPilot.gs($f,'font-size');$0O.style.fontSize=$0Q;$0O.style.left='0px';$0O.style.top=$f.offsetTop+'px';$0O.style.border='1px solid black';$0O.style.padding='0px';$0O.style.marginTop='0px';$0O.style.backgroundColor='white';$0O.value=DayPilot.tr($f.event.text());$0O.event=$f.event;$g.firstChild.appendChild($0O);return $0O;};this.clearEventSelection=function(){$b.divDeselectAll();$b.nav.select.value=null;};this.cleanEventSelection=this.clearEventSelection;this.eventSelect=function(e,$06){var m=$b.multiselect;m.previous=m.events();m.toggleDiv(e.div,$06);var $0A=m.isSelected(e)?"selected":"deselected";$b.eventSelectDispatch(e,$0A);};this.multiselect={};this.multiselect.initList=[];this.multiselect.list=[];this.multiselect.divs=[];this.multiselect.previous=[];this.multiselect.serialize=function(){var m=$b.multiselect;return DayPilot.JSON.stringify(m.events());};this.multiselect.events=function(){var m=$b.multiselect;var $0R=[];$0R.ignoreToJSON=true;for(var i=0;i<m.list.length;i++){$0R.push(m.list[i]);};return $0R;};this.multiselect.updateHidden=function(){var h=$b.nav.select;h.value=$b.multiselect.serialize();};this.multiselect.toggleDiv=function($03,$0S){var m=$b.multiselect;if(m.isSelected($03.event)){if($b.allowMultiSelect){if($0S){m.remove($03.event);}else{var $0T=m.list.length;m.clear(true);if($0T>1){m.add($03.event);}}}else{m.clear(true);}}else{if($b.allowMultiSelect){if($0S){m.add($03.event);}else{m.clear(true);m.add($03.event);}}else{m.clear(true);m.add($03.event);}};m.redraw();m.updateHidden();};this.multiselect.shouldBeSelected=function(e){if(!this.initList){return false;};for(var i=0;i<this.initList.length;i++){var ei=this.initList[i];if(ei.value!==null&&e.value()!==null&&ei.value===e.value()){return true;};if(ei.value===null&&e.value()===null&&ei.recurrentMasterId===e.recurrentMasterId()&&e.start().toStringSortable()===ei.start){return true;}};return false;};this.multiselect.alert=function(){var m=$b.multiselect;var $0U=[];for(var i=0;i<m.list.length;i++){var event=m.list[i];$0U.push(event.value());};alert($0U.join("\n"));};this.multiselect.add=function(ev){var m=$b.multiselect;if(m.indexOf(ev)==-1){m.list.push(ev);}};this.multiselect.remove=function(ev){var m=$b.multiselect;var i=m.indexOf(ev);if(i!=-1){m.list.splice(i,1);}};this.multiselect.clear=function($0V){var m=$b.multiselect;m.list=[];if($0V){return;};m.redraw();};this.multiselect.redraw=function(){var m=$b.multiselect;for(var i=0;i<$b.elements.events.length;i++){var $03=$b.elements.events[i];if(m.isSelected($03.event)){m.divSelect($03);}else{m.divDeselect($03);}}};this.multiselect.divSelect=function($03){var m=$b.multiselect;var cn=$b.applyCssClass("selected");var c=m.findContentDiv($03);if(c){if(c.className){if(c.className.indexOf(cn)==-1){c.className+=" "+cn;}}else{c.className=cn;}};if($b.useEventSelectionBars){m.divSelectTraditional($03);};m.divs.push($03);};this.multiselect.findContentDiv=function($03){for(var i=0;i<$03.childNodes.length;i++){var c=$03.childNodes[i];if(c.getAttribute("c")=="1"){return c;}};return null;};this.multiselect.divDeselectAll=function(){var m=$b.multiselect;for(var i=0;i<m.divs.length;i++){var $03=m.divs[i];m.divDeselect($03,true);};m.divs=[];};this.multiselect.divDeselect=function($03,$0W){var m=$b.multiselect;var cn=$b.applyCssClass("selected");var c=m.findContentDiv($03);if(c&&c.className&&c.className.indexOf(cn)!=-1){c.className=c.className.replace(cn,"");};if($b.useEventSelectionBars){m.divDeselectTraditional($03);};if($0W){return;};var i=DayPilot.indexOf(m.divs,$03);if(i!=-1){m.divs.splice(i,1);}};this.multiselect.isSelected=function(ev){return $b.multiselect.indexOf(ev)!=-1;};this.multiselect.indexOf=function(ev){return DayPilot.indexOf($b.multiselect.list,ev);};this.multiselect.divSelectTraditional=function($0X){var w=5;if(!$0X.top){var top=document.createElement("div");top.unselectable='on';top.style.position='absolute';top.style.left=$0X.offsetLeft+'px';top.style.width=$0X.offsetWidth+'px';top.style.top=($0X.offsetTop-w)+'px';top.style.height=w+'px';top.style.backgroundColor=$b.eventSelectColor;top.style.zIndex=100;$0X.parentNode.appendChild(top);$0X.top=top;};if(!$0X.bottom){var $0Y=document.createElement("div");$0Y.unselectable='on';$0Y.style.position='absolute';$0Y.style.left=$0X.offsetLeft+'px';$0Y.style.width=$0X.offsetWidth+'px';$0Y.style.top=($0X.offsetTop+$0X.offsetHeight)+'px';$0Y.style.height=w+'px';$0Y.style.backgroundColor=$b.eventSelectColor;$0Y.style.zIndex=100;$0X.parentNode.appendChild($0Y);$0X.bottom=$0Y;}};this.multiselect.divDeselectTraditional=function($0X){if($0X.top){$0X.parentNode.removeChild($0X.top);$0X.top=null;};if($0X.bottom){$0X.parentNode.removeChild($0X.bottom);$0X.bottom=null;}};this.selectedEvent=function(){var a=$b.multiselect.list;if(a.length<=0){return null;};if(a.length===1){return a[0];};return null;};this.divEdit=function($f){if(DayPilotCalendar.editing){DayPilotCalendar.editing.blur();return;};var $0O=this.createEdit($f);DayPilotCalendar.editing=$0O;$0O.onblur=function(){var id=$f.event.value();var $0Z=$f.event.tag();var $10=$f.event.text();var $0z=$0O.value;DayPilotCalendar.editing=null;$0O.parentNode.removeChild($0O);if($10===$0z){return;};$f.style.display='none';$b.eventEditDispatch($f.event,$0z);};$0O.onkeypress=function(e){var $11=(window.event)?event.keyCode:e.keyCode;if($11===13){this.onblur();return false;}else if($11===27){$0O.parentNode.removeChild($0O);DayPilotCalendar.editing=false;};return true;};$0O.select();$0O.focus();};this.prepareColumns=function(){if(!this.columns){this.createDaysViewColumns();};this.activateColumnCollection(this.columns);this.columnsBottom=this.columns.getColumns(this.headerLevels,true);};this.createDaysViewColumns=function(){this.columns=[];var $0d=this.startDate.getDatePart();if(this.heightSpec==='BusinessHoursNoScroll'){$0d=$0d.addHours(this.businessBeginsHour);};for(var i=0;i<this.days;i++){var $t={};$t.Start=$0d.addDays(i);$t.Name=$t.Start.toString();$t.InnerHTML=$t.Name;this.columns.push($t);}};this.activateColumn=function($t){$t.Start=new DayPilot.Date($t.Start);$t.getChildren=function($12,$13){var $0U=[];if($12<=1){$0U.push(this);return $0U;};if(!this.Children||this.Children.length===0){if($13){$0U.push(this);}else{$0U.push("empty");};return $0U;};for(var i=0;i<this.Children.length;i++){var $14=this.Children[i];var $15=$14.getChildren($12-1,$13);for(var j=0;j<$15.length;j++){$0U.push($15[j]);}};return $0U;};$t.getChildrenCount=function($12){var $0T=0;if(!this.Children||this.Children.length<=0||$12<=1){return 1;};for(var i=0;i<this.Children.length;i++){$0T+=this.Children[i].getChildrenCount($12-1);};return $0T;};$t.putIntoBlock=function(ep){for(var i=0;i<this.blocks.length;i++){var $16=this.blocks[i];if($16.overlapsWith(ep.Top,ep.Height)){$16.events.push(ep);$16.min=Math.min($16.min,ep.Top);$16.max=Math.max($16.max,ep.Top+ep.Height);return i;}};var $16=[];$16.lines=[];$16.events=[];$16.overlapsWith=function($0d,$17){var end=$0d+$17-1;if(!(end<this.min||$0d>this.max-1)){return true;};return false;};$16.putIntoLine=function(ep){var $18=this;for(var i=0;i<this.lines.length;i++){var $19=this.lines[i];if($19.isFree(ep.Top,ep.Height)){$19.push(ep);return i;}};var $19=[];$19.isFree=function($0d,$17){var end=$0d+$17-1;var $U=this.length;for(var i=0;i<$U;i++){var e=this[i];if(!(end<e.Top||$0d>e.Top+e.Height-1)){return false;}};return true;};$19.push(ep);this.lines.push($19);return this.lines.length-1;};$16.events.push(ep);$16.min=ep.Top;$16.max=ep.Top+ep.Height;this.blocks.push($16);return this.blocks.length-1;};$t.putIntoLine=function(ep){var $18=this;for(var i=0;i<this.lines.length;i++){var $19=this.lines[i];if($19.isFree(ep.Top,ep.Height)){$19.push(ep);return i;}};var $19=[];$19.isFree=function($0d,$17){var end=$0d+$17-1;var $U=this.length;for(var i=0;i<$U;i++){var e=this[i];if(!(end<e.Top||$0d>e.Top+e.Height-1)){return false;}};return true;};$19.push(ep);this.lines.push($19);return this.lines.length-1;};if($t.Children){this.activateColumnCollection($t.Children);}};this.activateColumnCollection=function(cc){for(var i=0;i<cc.length;i++){this.activateColumn(cc[i]);};cc.getColumns=function($12,$13){var $0U=[];for(var i=0;i<this.length;i++){var $E=this[i].getChildren($12,$13);for(var j=0;j<$E.length;j++){$0U.push($E[j]);}};return $0U;};cc.getColumnCount=function($12){var $0T=0;for(var i=0;i<this.length;i++){$0T+=this[i].getChildrenCount($12);};return $0T;};};this.drawEventsAllDay=function(){if(!this.showAllDayEvents){return;};var $1a=this.nav.header;$1a.style.display='none';var $0G=this.columnsBottom.length;for(var j=0;j<this.allDay.lines.length;j++){var $19=this.allDay.lines[j];for(var i=0;i<$19.length;i++){var $w=$19[i];var $03=document.createElement("div");$03.data=$w;$03.unselectable='on';$03.style.position='absolute';$03.style.left=(100.0*$w.ColStart/$0G)+"%";$03.style.width=(100.0*$w.ColWidth/$0G)+"%";$03.style.height=this.allDayEventHeight+'px';$03.style.top=(4+this.headerLevels*this.headerHeight+j*(this.allDayEventHeight+2))+"px";$03.style.textAlign='left';$03.style.lineHeight="1.2";if($w.ClickEnabled){$03.onclick=this.eventClickDispatch;};if($w.DoubleClickEnabled){$03.ondblclick=this.eventDoubleClickDispatch;};$03.oncontextmenu=this.eventRightClickDispatch;if(this.bubble){$03.onmouseout=function(){$b.bubble.hideOnMouseOut();};};if(this.showToolTip){$03.title=$w.ToolTip;};var back=$w.BackgroundColor;var $04=document.createElement("div");$04.unselectable='on';$04.style.marginLeft='2px';$04.style.marginRight='3px';$04.style.paddingLeft='2px';$04.style.height=(this.allDayEventHeight-2)+'px';$04.style.border='1px solid '+this.allDayEventBorderColor;$04.style.overflow='hidden';$04.style.position='relative';$04.style.backgroundColor=back;$04.className=this.applyCssClass("alldayevent");if(this.roundedCorners){$04.style.MozBorderRadius="5px";$04.style.webkitBorderRadius="5px";$04.style.borderRadius="5px";};var $1b=[];var $1c=true;var $1d=this.showAllDayEventStartEnd;var $1e=this.showAllDayEventStartEnd;var $1f="Center";var $1g=0;var $1h=$w.Start.getTime()===$w.PartStart.getTime();var $1i=$w.End.getTime()===$w.PartEnd.getTime();if($1d){if($1f==='Left'){$1b.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:8pt;color:gray;text-align:right;");$1b.push("width:");$1b.push($1g-4);$1b.push("px;");$1b.push("><span style='background-color:");}else{$1b.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:8pt;color:gray'><span style='background-color:");};$1b.push('transparent');$1b.push("' unselectable='on'>");if($1h){if($w.Start.getDatePart().getTime()!==$w.Start.getTime()){$1b.push(DayPilot.Date.hours($w.Start.d,this.timeFormat==='Clock12Hours'));}}else{$1b.push("~");};$1b.push("</span></div></div>");};if($1e){$1b.push("<div unselectable='on' style='position:absolute;text-align:right;height:1px;font-size:1px;width:100%'><div unselectable='on' style='margin-right:4px;font-size:8pt;color:gray'><span style='background-color:");$1b.push('transparent');$1b.push("' unselectable='on'>");if($1i){if($w.End.getDatePart().getTime()!==$w.End.getTime()){$1b.push(DayPilot.Date.hours($w.End.d,this.timeFormat==='Clock12Hours'));}}else{$1b.push("~");};$1b.push("</span></div></div>");};if($1f==='Left'){var $1j=$1d?$1g:0;$1b.push("<div style='margin-top:0px;height:");$1b.push(this.allDayEventHeight-2);$1b.push("px;");$1b.push(";overflow:hidden;text-align:left;padding-left:");$1b.push($1j);$1b.push("px;font-size:");$1b.push(this.allDayEventFontSize);$1b.push(";color:");$1b.push(this.allDayEventFontColor);$1b.push(";font-family:");$1b.push(this.eventFontFamily);$1b.push("' unselectable='on'>");if($w.InnerHTML){$1b.push($w.InnerHTML);}else{$1b.push($w.Text);};$1b.push("</div>");}else if($1f==='Center'){if($1c){$1b.push("<div style='position:absolute; text-align:center; width: 98%; height:1px;'>");$1b.push("<span style='background-color:");$1b.push('transparent');$1b.push(";font-size:");$1b.push(this.allDayEventFontSize);$1b.push(";color:");$1b.push(this.allDayEventFontColor);$1b.push(";font-family:");$1b.push(this.allDayEventFontFamily);$1b.push("' unselectable='on'>");if($w.InnerHTML){$1b.push($w.InnerHTML);}else{$1b.push($w.Text);};$1b.push("</span>");$1b.push("</div>");}else{$1b.push("<div style='margin-top:0px;height:");$1b.push(this.allDayEventHeight-2);$1b.push("px;");$1b.push(";overflow:hidden;text-align:center;font-size:");$1b.push(this.allDayEventFontSize);$1b.push(";color:");$1b.push(this.allDayEventFontColor);$1b.push(";font-family:");$1b.push(this.allDayEventFontFamily);$1b.push("' unselectable='on'>");if($w.InnerHTML){$1b.push($w.InnerHTML);}else{$1b.push($w.Text);};$1b.push("</div>");}};$04.innerHTML=$1b.join('');$03.appendChild($04);this.nav.allday.appendChild($03);new DayPilotCalendar.Event($03,$b);this.elements.events.push($03);}};$1a.style.display='';};this.deleteEvents=function(){$b.multiselect.divDeselectAll();if(this.elements.events){for(var i=0;i<this.elements.events.length;i++){var $03=this.elements.events[i];var $f=$03.event;if($f){$f.div=null;$f.root=null;};$03.onclick=null;$03.onclickSave=null;$03.ondblclick=null;$03.oncontextmenu=null;$03.onmouseover=null;$03.onmouseout=null;$03.onmousemove=null;$03.onmousedown=null;if($03.firstChild&&$03.firstChild.firstChild&&$03.firstChild.firstChild.tagName&&$03.firstChild.firstChild.tagName.toUpperCase()==='IMG'){var $1k=$03.firstChild.firstChild;$1k.onmousedown=null;$1k.onmousemove=null;$1k.onclick=null;};$03.helper=null;$03.data=null;$03.event=null;DayPilot.de($03);}};this.elements.events=[];};this.drawEvent=function($w){var $R=this.nav.main;var $1l=this.roundedCorners;var $1m=this.roundedCorners&&(this.ff||this.opera105||this.webkit522||this.ie9);var $1n=this.roundedCorners&&!$1m;var $1o=$w.BorderColor;var $03=document.createElement("div");$03.data=$w;$03.unselectable='on';$03.style.MozUserSelect='none';$03.style.KhtmlUserSelect='none';$03.style.position='absolute';$03.style.fontFamily=this.eventFontFamily;$03.style.fontSize=this.eventFontSize;$03.style.color=$w.FontColor;$03.style.left=$w.Left+'%';$03.style.top=($w.Top-this.autoHiddenPixels())+'px';$03.style.width=$w.Width+'%';$03.style.height=Math.max($w.Height,2)+'px';if(!$1l){$03.style.backgroundColor=$1o;};$03.style.overflow='hidden';if(this.transparent){$03.style.opacity=0.6;$03.style.filter="alpha(opacity=60)";};$03.isFirst=$w.PartStart.getTime()===$w.Start.getTime();$03.isLast=$w.PartEnd.getTime()===$w.End.getTime();if($w.ClickEnabled){$03.onclick=this.eventClickDispatch;};if($w.DoubleClickEnabled){$03.ondblclick=this.eventDoubleClickDispatch;};$03.oncontextmenu=this.eventRightClickDispatch;if(this.bubble){$03.onmouseout=function(){$b.bubble.hideOnMouseOut();};};var $1b=[];if(this.eventDeleteHandling!=='Disabled'&&$w.DeleteEnabled){$1b.push("<div unselectable='on' style='position:absolute; width:100%;text-align:right;'><div style='position:absolute; width:10px; height:10px; right:2px; top: 2px; cursor:pointer;");if(this.deleteImageUrl){$1b.push("background-image:url(\"" + this.deleteImageUrl + "\");");};$1b.push("' class='");$1b.push(this.applyCssClass("event_delete"));$1b.push("' onmousemove=\"if(typeof(DayPilotBubble)!=='undefined'&&");$1b.push(this.clientName);$1b.push(".bubble && ");$1b.push(this.clientName);$1b.push(".bubble.hideAfter > 0");$1b.push(") { DayPilotBubble.hideActive(); event.cancelBubble = true; };\" onmousedown=\"this.parentNode.parentNode.style.cursor='default';\" onclick='");$1b.push(this.clientName);$1b.push(".eventDeleteDispatch(this); event.cancelBubble = true; if (event.stopPropagation) event.stopPropagation();' ></div></div>");};if($1n){$1b.push("<div style='margin-right:2px;'>");$1b.push("<div style='height:1px;line-height:1px;font-size:0px; margin-left:2px; background-color:");$1b.push($1o);$1b.push(";'>&nbsp;</div>");$1b.push("</div>");$1b.push("<div unselectable='on' style='position:absolute;width:100%;margin-top:-1px;'>");$1b.push("<div style='height:1px;line-height:1px;font-size:0px;margin-left:1px;margin-top:1px; margin-right:1px;border-right:1px solid ");$1b.push($1o);$1b.push(";border-left:1px solid ");$1b.push($1o);$1b.push(";background-color:");$1b.push($w.Header?$1o:$w.BackgroundColor);$1b.push("'>");$1b.push("&nbsp;</div>");$1b.push("</div>");}else if(!$1m){$1b.push("<div style='height:1px;line-height:1px;font-size:0px; width:1px;'>&nbsp;</div>");};$1b.push("<div");if(this.showToolTip){$1b.push(" title='");$1b.push($w.ToolTip.replace(/'/g,"&apos;"));$1b.push("'");};var $k=Math.max($w.Height-2,0);$1b.push(" c='1'");$1b.push(" class='");$1b.push($w.CssClass?$w.CssClass:this.applyCssClass('event'));$1b.push("'");if($1n){$1b.push(" style='margin-top:1px;height:");$1b.push($k-2);}else{$1b.push(" style='margin-top:0px;height:");$1b.push($k);};$1b.push("px;background-color:");$1b.push($w.BackgroundColor);if($1m){$1b.push(";border:1px solid ");$1b.push($1o);$1b.push(";-moz-border-radius:5px;");$1b.push(";-webkit-border-radius:5px;");$1b.push(";border-radius:5px;");}else{$1b.push(";border-left:1px solid ");$1b.push($1o);$1b.push(";border-right:1px solid ");$1b.push($1o);};$1b.push(";");if($w.BackgroundImage){$1b.push("background-image:url(");$1b.push($w.BackgroundImage);$1b.push(");");if($w.BackgroundRepeat){$1b.push("background-repeat:");$1b.push($w.BackgroundRepeat);$1b.push(";");}};if($b.rtl){$1b.push("direction:rtl;");};$1b.push("' unselectable='on'>");if(this.durationBarVisible){$1b.push("<div style='position:absolute;left:1px;top:1px;width:");$1b.push($b.durationBarWidth-1);$1b.push("px;height:");$1b.push($w.BarTop);$1b.push("px;background-color:white;font-size:1px' unselectable='on'></div>");$1b.push("<div style='position:absolute;left:1px;top:");$1b.push($w.BarTop+$w.BarHeight);$1b.push("px;width:");$1b.push($b.durationBarWidth-1);$1b.push("px;height:");$1b.push($k-($w.BarTop+$w.BarHeight));$1b.push("px;background-color:white;font-size:1px' unselectable='on'></div>");$1b.push("<div style='position:absolute;left:1px;width:");$1b.push($b.durationBarWidth);$1b.push("px;height:");$1b.push($w.BarHeight);$1b.push("px;");if($w.DurationBarImageUrl){$1b.push("background-image:url(");$1b.push($w.DurationBarImageUrl);$1b.push(");");}else if($b.durationBarImageUrl){$1b.push("background-image:url(");$1b.push($b.durationBarImageUrl);$1b.push(");");};$1b.push("top:");$1b.push($w.BarTop+1);$1b.push("px;background-color:");$1b.push($w.BarColor);$1b.push(";font-size:1px' unselectable='on'></div><div style='position:absolute;left:");$1b.push($b.durationBarWidth);$1b.push("px;top:1px;width:1px;background-color:");$1b.push($1o);$1b.push(";height:100%' unselectable='on'></div>");};var $1p=$w.Header?this.eventHeaderHeight:0;if($w.Header){$1b.push("<div unselectable='on' style='overflow:hidden;height:");$1b.push(this.eventHeaderHeight);$1b.push("px; background-color:");$1b.push($1o);$1b.push(";font-size:");$1b.push(this.eventHeaderFontSize);$1b.push(";color:");$1b.push(this.eventHeaderFontColor);$1b.push("'>");$1b.push($w.Header);$1b.push("</div>");};if(this.durationBarVisible){$1b.push("<div unselectable='on' style='padding-left:");$1b.push($b.durationBarWidth+3);$1b.push("px;");$1b.push("'>");}else{$1b.push("<div unselectable='on' style='overflow:hidden;padding-left:2px;height:");$1b.push($k-$1p-1);$1b.push("px;'>");};$1b.push($w.InnerHTML);$1b.push("</div></div>");if($1n){$1b.push("<div unselectable='on' style='margin-right:2px;'>");$1b.push("<div unselectable='on' style='height:1px;line-height:1px;font-size:0px;margin-left:2px;margin-top:1px;background-color:");$1b.push($1o);$1b.push(";'><!-- --></div>");$1b.push("</div>");$1b.push("<div unselectable='on' style='margin-right:0px;margin-top:-3px;position:relative;'>");$1b.push("<div unselectable='on' style='margin-right:0px;position:relative;'>");$1b.push("<div unselectable='on' style='height:1px;line-height:1px;font-size:0px;margin-top:1px;margin-left:1px;margin-right:1px;border-right:1px solid ");$1b.push($1o);$1b.push(";border-left:1px solid ");$1b.push($1o);$1b.push(";background-color:");$1b.push($w.BackgroundColor);$1b.push("'>");$1b.push("<!-- --></div>");$1b.push("</div>");$1b.push("</div>");};$03.innerHTML=$1b.join('');if($R.rows[0].cells[$w.DayIndex]){var $1q=$R.rows[0].cells[$w.DayIndex].firstChild;$1q.appendChild($03);$b.makeChildrenUnselectable($03);var e=new DayPilotCalendar.Event($03,$b);if($b.multiselect.shouldBeSelected(e)){$b.multiselect.add($03.event);};if($b.afterEventRender){$b.afterEventRender(e,$03);}};$b.elements.events.push($03);};this.relativizeChildren=function(el){var c=(el&&el.childNodes)?el.childNodes.length:0;for(var i=0;i<c;i++){var $14=el.childNodes[i];if($14.style.position===''){$14.style.position='relative';};this.relativizeChildren($14);}};this.makeChildrenUnselectable=function(el){var c=(el&&el.childNodes)?el.childNodes.length:0;for(var i=0;i<c;i++){try{var $14=el.childNodes[i];if($14.nodeType===1){$14.unselectable='on';this.makeChildrenUnselectable($14);}}catch(e){}}};this.drawEvents=function(){this.multiselect.list=[];var $0d=new Date();for(var i=0;i<this.columnsBottom.length;i++){var $1r=this.columnsBottom[i];for(var m=0;m<$1r.blocks.length;m++){var $16=$1r.blocks[m];for(var j=0;j<$16.lines.length;j++){var $19=$16.lines[j];for(var k=0;k<$19.length;k++){var e=$19[k];e.Width=100/$16.lines.length;e.Left=e.Width*j;if(this.eventArrangement==='Cascade'){var $1s=(j===$16.lines.length-1);if(!$1s){e.Width=e.Width*1.5;}};if(this.eventArrangement==='Full'){e.Left=e.Left/2;e.Width=100-e.Left;};if(!e.AllDay){this.bg?this.drawEvent2(e):this.drawEvent(e);}}}}};this.multiselect.redraw();var end=new Date();var $1t=end.getTime()-$0d.getTime();};this.drawEventsFromLines=function(){this.multiselect.list=[];for(var i=0;i<this.columnsBottom.length;i++){var $1r=this.columnsBottom[i];for(var j=0;j<$1r.lines.length;j++){var $19=$1r.lines[j];for(var k=0;k<$19.length;k++){var e=$19[k];e.Width=100/$1r.lines.length;e.Left=e.Width*j;if(!e.AllDay){this.drawEvent(e);}}}}};this.applyCssClass=function($1u){if(this.cssClassPrefix){return this.cssClassPrefix+$1u;}else{return "";}};this.drawTop=function(){this.nav.top=document.getElementById(this.id);this.nav.top.innerHTML='';this.nav.top.style.MozUserSelect='none';this.nav.top.style.KhtmlUserSelect='none';this.nav.top.style.position='relative';this.nav.top.style.width=this.width?this.width:'100%';this.nav.top.style.lineHeight="1.2";this.nav.top.style.textAlign="left";if(this.heightSpec==="Parent100Pct"){this.nav.top.style.height="100%";};this.nav.scroll=document.createElement("div");this.nav.scroll.style.height=this.getScrollableHeight()+"px";if(this.heightSpec==="Fixed"){this.nav.scroll.style.overflowY="scroll";}else if(this.heightSpec==='BusinessHours'&&this.durationHours()<=this.businessEndsHour-this.businessBeginsHour){this.nav.scroll.style.overflow="hidden";}else if(this.heightSpec!=="Full"&&this.heightSpec!=="BusinessHoursNoScroll"){this.nav.scroll.style.overflow="auto";}else{this.nav.scroll.style.overflow="hidden";};this.nav.scroll.style.position="relative";this.nav.scroll.style.border="1px solid "+this.borderColor;this.nav.scroll.style.backgroundColor=this.hourNameBackColor;if(this.showHeader){var $1a=this.drawTopHeaderDiv();this.nav.top.appendChild($1a);};this.nav.scroll.style.zoom=1;var $1v=this.drawScrollable();this.nav.scrollable=$1v.firstChild;this.nav.scroll.appendChild($1v);this.nav.top.appendChild(this.nav.scroll);this.nav.vsph=document.createElement("div");this.nav.vsph.style.display="none";this.nav.top.appendChild(this.nav.vsph);this.nav.scrollpos=document.createElement("input");this.nav.scrollpos.type="hidden";this.nav.scrollpos.id=$b.id+"_scrollpos";this.nav.scrollpos.name=this.nav.scrollpos.id;this.nav.top.appendChild(this.nav.scrollpos);this.nav.select=document.createElement("input");this.nav.select.type="hidden";this.nav.select.id=$b.id+"_select";this.nav.select.name=this.nav.select.id;this.nav.select.value=null;this.nav.top.appendChild(this.nav.select);this.nav.scrollLayer=document.createElement("div");this.nav.scrollLayer.style.position='absolute';this.nav.scrollLayer.style.top='0px';this.nav.scrollLayer.style.left='0px';this.nav.top.appendChild(this.nav.scrollLayer);this.nav.scrollUp=[];this.nav.scrollDown=[];this.nav.loading=document.createElement("div");this.nav.loading.style.position='absolute';this.nav.loading.style.top='0px';this.nav.loading.style.left=(this.hourWidth+5)+"px";this.nav.loading.style.backgroundColor=this.loadingLabelBackColor;this.nav.loading.style.fontSize=this.loadingLabelFontSize;this.nav.loading.style.fontFamily=this.loadingLabelFontFamily;this.nav.loading.style.color=this.loadingLabelFontColor;this.nav.loading.style.padding='2px';this.nav.loading.innerHTML=this.loadingLabelText;this.nav.loading.style.display='none';this.nav.top.appendChild(this.nav.loading);};this.drawHourTable=function(){if(!this.fasterDispose)DayPilot.pu(this.nav.hourTable);this.nav.scrollable.rows[0].cells[0].innerHTML='';this.nav.hourTable=this.createHourTable();this.nav.scrollable.rows[0].cells[0].appendChild(this.nav.hourTable);};this.drawScrollable=function(){var $1w=document.createElement("div");$1w.style.zoom=1;$1w.style.position='relative';var $1x=document.createElement("table");$1x.cellSpacing="0";$1x.cellPadding="0";$1x.border="0";$1x.style.border="0px none";$1x.style.width="100%";$1x.style.position='absolute';var r=$1x.insertRow(-1);var c;if(this.showHours){c=r.insertCell(-1);c.valign="top";c.style.padding='0px';c.style.border='0px none';this.nav.hourTable=this.createHourTable();c.appendChild(this.nav.hourTable);};c=r.insertCell(-1);c.valign="top";c.width="100%";c.style.padding='0px';c.style.border='0px none';c.appendChild(this.createEventsAndCells());$1w.appendChild($1x);var $k=(this.duration()*this.cellHeight)/(60000*this.cellDuration);this.nav.zoom=$1w;return $1w;};this.createEventsAndCells=function(){var $1x=document.createElement("table");$1x.cellPadding="0";$1x.cellSpacing="0";$1x.border="0";$1x.style.width="100%";$1x.style.border="0px none";$1x.style.borderLeft="1px solid "+this.borderColor;this.nav.main=$1x;return $1x;};this.createHourTable=function(){var $1x=document.createElement("table");$1x.cellSpacing="0";$1x.cellPadding="0";$1x.border="0";$1x.style.border='0px none';$1x.style.width=this.hourWidth+"px";$1x.oncontextmenu=function(){return false;};var r=$1x.insertRow(-1);r.style.height="1px";r.style.backgroundColor="white";var c=r.insertCell(-1);c.style.padding='0px';c.style.border='0px none';var $1y=this.duration()/(60*60*1000);var $0d=this.visibleStart();for(var i=0;i<$1y;i++){this.createHourRow($1x,i);};return $1x;};this.autoHiddenRows=function(){return(this.visibleStart()-this.visibleStart(true))*(60/this.cellDuration);};this.autoHiddenHours=function(){return(this.visibleStart()-this.visibleStart(true));};this.autoHiddenPixels=function(){return this.autoHiddenRows()*this.cellHeight;};this.createHourRow=function($1x,i){var $k=(this.cellHeight*60/this.cellDuration);var r=$1x.insertRow(-1);r.style.height=$k+"px";var c=r.insertCell(-1);c.valign="bottom";c.unselectable="on";c.className=this.applyCssClass("rowheader");c.style.backgroundColor=this.hourNameBackColor;c.style.cursor="default";c.style.padding='0px';c.style.border='0px none';var $1z=document.createElement("div");$1z.style.width=this.hourWidth+"px";$1z.style.height=($k)+"px";$1z.style.overflow='hidden';$1z.unselectable='on';var $16=document.createElement("div");$16.style.display="block";$16.style.borderBottom="1px solid "+this.hourNameBorderColor;$16.style.height=($k-1)+"px";$16.style.textAlign="right";$16.unselectable="on";if(this.hours){$16.innerHTML=this.hours[i+this.autoHiddenHours()].HTML;}else{var $q=document.createElement("div");$q.style.padding="2px";$q.style.fontFamily=this.hourFontFamily;$q.style.fontSize=this.hourFontSize;$q.style.color=this.hourFontColor;$q.unselectable="on";var $0d=this.startDate.addHours(i+this.visibleStart());var $1A=$0d.getHours();var am=$1A<12;if(this.timeFormat==="Clock12Hours"){$1A=$1A%12;if($1A===0){$1A=12;}};$q.innerHTML=$1A;var $1B=document.createElement("span");$1B.style.fontSize="10px";$1B.style.verticalAlign="super";$1B.unselectable="on";var $1C;if(this.timeFormat==="Clock12Hours"){if(am){$1C="AM";}else{$1C="PM";}}else{$1C="00";};$1B.innerHTML="&nbsp;"+$1C;$q.appendChild($1B);$16.appendChild($q);};$1z.appendChild($16);c.appendChild($1z);};this.getScrollableHeight=function(){switch(this.heightSpec){case "Fixed":return this.height;case "Parent100Pct":return this.height;case "Full":return(this.duration()*this.cellHeight)/(60000*this.cellDuration);case "BusinessHours":case "BusinessHoursNoScroll":var $V=this.businessHoursSpan();return $V*this.cellHeight*60/this.cellDuration;default:throw "DayPilot.Calendar: Unexpected 'heightSpec' value.";}};this.totalHeaderHeight=function(){var $1D=this.headerLevels*this.headerHeight+this.headerLevels-1;if(this.showAllDayEvents&&this.allDayHeaderHeight){return $1D+this.allDayHeaderHeight+1;}else{return $1D;}};this.drawTopHeaderDiv=function(){var $1a=document.createElement("div");$1a.style.borderLeft="1px solid "+this.borderColor;$1a.style.borderRight="1px solid "+this.borderColor;$1a.style.overflow="auto";var $1x=document.createElement("table");$1x.cellPadding="0";$1x.cellSpacing="0";$1x.border="0";$1x.style.width="100%";$1x.style.borderCollapse='separate';$1x.style.border="0px none";var r=$1x.insertRow(-1);var c=r.insertCell(-1);c.style.padding='0px';c.style.border='0px none';if(this.showHours){var $1E=this.drawCorner();c.appendChild($1E);this.nav.corner=$1E;}else{var $1F=document.createElement("div");$1F.style.backgroundColor=this.hourNameBackColor;$1F.style.width="0px";$1F.style.height=this.totalHeaderHeight()+"px";$1F.style.borderTop="1px solid "+this.borderColor;$1F.unselectable="on";c.appendChild($1F);};c=r.insertCell(-1);c.style.width="100%";c.style.backgroundColor=this.hourNameBackColor;c.valign="top";c.style.position='relative';c.style.padding='0px';c.style.border='0px none';if(this.showAllDayEvents){var $1v=document.createElement("div");$1v.style.position='relative';$1v.style.height="0px";$1v.style.lineHeight="0px";$1v.style.fontSize="0px";var $1G=document.createElement("div");$1G.style.position='relative';$1G.style.height="0px";if(DayPilot.isKhtml){$1G.style.marginLeft="2px";};this.nav.allday=$1G;$1v.appendChild($1G);c.appendChild($1v);};this.nav.header=document.createElement("table");this.nav.header.cellPadding="0";this.nav.header.cellSpacing="0";this.nav.header.border="0";this.nav.header.width="100%";this.nav.header.style.borderBottom="0px none #000000";this.nav.header.style.borderRight="0px none #000000";this.nav.header.style.borderLeft="1px solid "+this.borderColor;this.nav.header.style.borderTop="1px solid "+this.borderColor;this.nav.header.oncontextmenu=function(){return false;};var $1H=this.nav.scroll.style.overflow!=='hidden';if($1H){this.nav.header.style.borderRight="1px solid "+this.borderColor;};c.appendChild(this.nav.header);if($1H){c=r.insertCell(-1);c.className=this.applyCssClass('cornerright');c.style.backgroundColor=this.hourNameBackColor;c.style.borderTop="1px solid "+this.borderColor;c.style.borderBottom="0px none";c.style.borderLeft="0px none";c.style.borderRight="0px none";c.style.padding='0px';c.style.verticalAlign='top';c.unselectable="on";c.innerHTML="&nbsp;";var $1b=document.createElement("div");$1b.unselectable="on";$1b.style.width="16px";$1b.style.height="1px";$1b.style.lineHeight="1px";$1b.style.fontSize="1px";c.appendChild($1b);this.nav.cornerRight=$1b;};$1a.appendChild($1x);return $1a;};this.drawCorner=function(){var $1v=document.createElement("div");$1v.style.position='relative';$1v.style.backgroundColor=this.cornerBackColor;$1v.style.fontFamily=this.headerFontFamily;$1v.style.fontSize=this.headerFontSize;$1v.style.color=this.headerFontColor;$1v.style.width=this.hourWidth+"px";$1v.style.height=this.totalHeaderHeight()+"px";$1v.style.borderTop="1px solid "+this.borderColor;$1v.className=this.applyCssClass("corner");$1v.oncontextmenu=function(){return false;};var $1E=document.createElement("div");$1E.unselectable="on";$1E.innerHTML=this.cornerHTML?this.cornerHTML:'';$1v.appendChild($1E);if(!this.numberFormat)return $1v;var $1I=document.createElement("div");$1I.style.position='absolute';$1I.style.padding='2px';$1I.style.top='0px';$1I.style.left='1px';$1I.style.backgroundColor="#FF6600";$1I.style.color="white";$1I.innerHTML="\u0044\u0045\u004D\u004F";$1I.unselectable="on";$1v.appendChild($1I);return $1v;};this.disposeMain=function(){var $1x=this.nav.main;$1x.root=null;$1x.onmouseup=null;for(var y=0;y<$1x.rows.length;y++){var r=$1x.rows[y];for(var x=0;x<r.cells.length;x++){var c=r.cells[x];c.root=null;c.onmousedown=null;c.onmousemove=null;c.onmouseout=null;c.onmouseup=null;c.onclick=null;c.ondblclick=null;c.oncontextmenu=null;}};if(!this.fasterDispose)DayPilot.pu($1x);};this.deleteScrollLabels=function(){for(var i=0;this.nav.scrollUp&&i<this.nav.scrollUp.length;i++){this.nav.scrollLayer.removeChild(this.nav.scrollUp[i]);};for(var i=0;this.nav.scrollDown&&i<this.nav.scrollDown.length;i++){this.nav.scrollLayer.removeChild(this.nav.scrollDown[i]);};this.nav.scrollUp=[];this.nav.scrollDown=[];};this.drawMain=function(){DayPilotCalendar.selectedCells=[];var $1J=[];var $1K=[];var $1x=this.nav.main;var $0l=this.cellDuration*60*1000;var $1L=this.rowCount();var $0G=$b.columnsBottom;var $1M=!this.tableCreated||$0G.length!==$1x.rows[0].cells.length||$1L!==$1x.rows.length;if($1x){this.disposeMain();}while($1x&&$1x.rows&&$1x.rows.length>0&&$1M){if(!this.fasterDispose)DayPilot.pu($1x.rows[0]);$1x.deleteRow(0);};this.tableCreated=true;var r=($1M)?$1x.insertRow(-1):$1x.rows[0];if($1M){r.style.backgroundColor='white';};if(this.scrollLabelsVisible){var $0G=this.columnsBottom;var $0H=(this.showHours?this.hourWidth:0);var $S=(this.nav.scroll.clientWidth-$0H)/$0G.length;for(var i=0;i<$0G.length;i++){var $0I=document.createElement("div");$0I.style.position='absolute';$0I.style.top='0px';$0I.style.left=($0H+2+i*$S+$S/2)+"px";$0I.style.display='none';var $1k=document.createElement("div");$1k.style.height='10px';$1k.style.width='10px';$1k.style.backgroundRepeat="no-repeat";if(this.scrollUpUrl){$1k.style.backgroundImage="url('"+this.scrollUpUrl+"')";};$1k.className=this.applyCssClass("scroll_up");$0I.appendChild($1k);this.nav.scrollLayer.appendChild($0I);this.nav.scrollUp.push($0I);var $0J=document.createElement("div");$0J.style.position='absolute';$0J.style.top='0px';$0J.style.left=($0H+2+i*$S+$S/2)+"px";$0J.style.display='none';var $1k=document.createElement("div");$1k.style.height='10px';$1k.style.width='10px';$1k.style.backgroundRepeat="no-repeat";if(this.scrollDownUrl){$1k.style.backgroundImage="url('"+this.scrollDownUrl+"')";};$1k.className=this.applyCssClass("scroll_down");$0J.appendChild($1k);this.nav.scrollLayer.appendChild($0J);this.nav.scrollDown.push($0J);}};var cl=$0G.length;for(var j=0;j<cl;j++){var c=($1M)?r.insertCell(-1):r.cells[j];if($1M){c.style.padding='0px';c.style.border='0px none';c.style.height='1px';c.style.overflow='visible';if(!$b.rtl){c.style.textAlign='left';};c.style.width=(100.0/$0G.length)+"%";var $03=document.createElement("div");$03.style.display='block';$03.style.marginRight=$b.columnMarginRight+"px";$03.style.position='relative';$03.style.height='1px';$03.style.fontSize='1px';$03.style.lineHeight='1.2';$03.style.marginTop='-1px';c.appendChild($03);}};for(var i=0;i<$1L;i++){var r=($1M)?$1x.insertRow(-1):$1x.rows[i+1];if($1M){r.style.MozUserSelect='none';r.style.KhtmlUserSelect='none';};for(var j=0;j<cl;j++){var $1r=this.columnsBottom[j];var c=($1M)?r.insertCell(-1):r.cells[j];c.start=$1r.Start.addTime(i*$0l).addHours(this.visibleStart());c.end=c.start.addTime($0l);c.resource=$1r.Value;var $1N=$b.getProperties(j,i);if($1M){c.root=this;c.style.padding='0px';c.style.border='0px none';c.style.verticalAlign='top';c.onmousedown=this.onCellMousedown;c.onmousemove=this.mousemove;c.onmouseout=this.cellMouseOut;c.onmouseup=function(){return false;};c.onclick=function(){return false;};c.ondblclick=function(){if($b.timeRangeDoubleClickHandling==='Disabled'){return;};var $0F=$b.getSelection();$b.timeRangeDoubleClickDispatch($0F.start,$0F.end,$0F.resource);};c.oncontextmenu=function(){if(!this.selected){if(DayPilotCalendar.selectedCells){$b.clearSelection();DayPilotCalendar.selectedCells=[];};DayPilotCalendar.column=DayPilotCalendar.getColumn(this);DayPilotCalendar.selectedCells.push(this);DayPilotCalendar.firstSelected=this;DayPilotCalendar.topSelectedCell=this;DayPilotCalendar.bottomSelectedCell=this;$b.activateSelection();};if($b.contextMenuSelection){$b.contextMenuSelection.show($b.getSelection());};return false;};if((!$b.rtl&&j!==cl-1)||$b.rtl){c.style.borderRight='1px solid '+$b.cellBorderColor;};c.style.height=$b.cellHeight+'px';c.style.overflow='hidden';c.unselectable='on';var $03=document.createElement("div");$03.unselectable='on';$03.style.fontSize='1px';$03.style.height='0px';var $1O=(c.end.getMinutes()+c.end.getSeconds()+c.end.getMilliseconds())>0;if($1O){if($b.hourHalfBorderColor!==''){$03.style.borderBottom='1px solid '+$b.hourHalfBorderColor;};$03.className=$b.applyCssClass("hourhalfcellborder");}else{if($b.hourBorderColor!==''){$03.style.borderBottom='1px solid '+$b.hourBorderColor;};$03.className=$b.applyCssClass("hourcellborder");};var $1P=document.createElement("div");$1P.style.height=($b.cellHeight-1)+"px";$1P.style.overflow='hidden';$1P.unselectable='on';c.appendChild($1P);c.appendChild($03);};c.originalColor=$b.getColor(j,i);c.className=$b.applyCssClass("cellbackground");c.style.backgroundColor=c.originalColor;$1P=c.firstChild;if($1N){if($1N.html){$1P.innerHTML=$1N.html;};if($1N.css){c.className+=' '+$b.applyCssClass($1N.css);};if($1N.image){c.style.backgroundImage="url('"+$1N.image+"')";};if($1N.repeat){c.style.backgroundRepeat=$1N.repeat;}}}};$1x.onmouseup=this.mouseup;$1x.root=this;var scroll=$b.nav.scroll;$b.nav.scrollable.onmousemove=function(ev){ev=ev||window.event;ev.insideMainD=true;if(window.event){window.event.srcElement.inside=true;};DayPilotCalendar.activeCalendar=this;var $1Q=$b.nav.scrollable;$b.coords=DayPilot.mo2($1Q,ev);var $h=DayPilot.mc(ev);if(DayPilotCalendar.resizing){if(!DayPilotCalendar.resizingShadow){DayPilotCalendar.resizingShadow=DayPilotCalendar.createShadow(DayPilotCalendar.resizing,false,$b.shadow);};var $1R=DayPilotCalendar.resizing.event.root.cellHeight;var $T=1;var $1S=($h.y-DayPilotCalendar.originalMouse.y);if(DayPilotCalendar.resizing.dpBorder==='bottom'){var $1T=Math.floor(((DayPilotCalendar.originalHeight+DayPilotCalendar.originalTop+$1S)+$1R/2) / $1R)*$1R-DayPilotCalendar.originalTop+$T;if($1T<$1R)$1T=$1R;var $U=DayPilotCalendar.resizing.event.root.nav.main.clientHeight;if(DayPilotCalendar.originalTop+$1T>$U)$1T=$U-DayPilotCalendar.originalTop;DayPilotCalendar.resizingShadow.style.height=($1T-4)+'px';}else if(DayPilotCalendar.resizing.dpBorder==='top'){var $1U=Math.floor(((DayPilotCalendar.originalTop+$1S-$T)+$1R/2) / $1R)*$1R+$T;if($1U<$T){$1U=$T;};var $1T=DayPilotCalendar.originalHeight-($1U-DayPilotCalendar.originalTop);if($1T<$1R){$1T=$1R;}else{DayPilotCalendar.resizingShadow.style.top=$1U+'px';};DayPilotCalendar.resizingShadow.style.height=($1T-4)+'px';};if(!$b.allowEventOverlap){$b.overlap=$b.isOverlapping();if($b.overlap){document.body.style.cursor='not-allowed';}else{document.body.style.cursor='n-resize';}}}else if(DayPilotCalendar.moving){if(!DayPilotCalendar.movingShadow){DayPilotCalendar.movingShadow=DayPilotCalendar.createShadow(DayPilotCalendar.moving,!$b.ie,$b.shadow);DayPilotCalendar.movingShadow.style.width=(DayPilotCalendar.movingShadow.parentNode.offsetWidth+1)+'px';};if(!$b.coords){return;};var $1R=$b.cellHeight;var $T=1;var $1V=DayPilotCalendar.moveOffsetY;if(!$1V){$1V=$1R/2;};var $1U=Math.floor((($b.coords.y-$1V-$T)+$1R/2) / $1R)*$1R+$T;if($1U<$T){$1U=$T;};var $R=$b.nav.main;var $U=$R.clientHeight;var $k=parseInt(DayPilotCalendar.movingShadow.style.height);if($1U+$k>$U){$1U=$U-$k;};DayPilotCalendar.movingShadow.parentNode.style.display='none';DayPilotCalendar.movingShadow.style.top=$1U+'px';DayPilotCalendar.movingShadow.parentNode.style.display='';var $S=$R.clientWidth/$R.rows[0].cells.length;var $t=Math.floor(($b.coords.x-45)/$S);if($t<0){$t=0;};if($t<$R.rows[0].cells.length&&$t>=0&&DayPilotCalendar.movingShadow.column!==$t){DayPilotCalendar.movingShadow.column=$t;DayPilotCalendar.moveShadow($R.rows[0].cells[$t]);};if(!$b.allowEventOverlap){$b.overlap=$b.isOverlapping($t);if($b.overlap){document.body.style.cursor='not-allowed';}else{document.body.style.cursor='move';}}};if(DayPilotCalendar.drag){if(DayPilotCalendar.gShadow){document.body.removeChild(DayPilotCalendar.gShadow);};DayPilotCalendar.gShadow=null;if(!DayPilotCalendar.movingShadow&&$b.coords){var $i=$b.createShadow(DayPilotCalendar.drag.duration,DayPilotCalendar.drag.shadowType);if($i){DayPilotCalendar.movingShadow=$i;var $1W=new DayPilot.Date().getDatePart();var ev={'value':DayPilotCalendar.drag.id,'start':$1W,'end':$1W.addSeconds(DayPilotCalendar.drag.duration),'text':DayPilotCalendar.drag.text};var event=new DayPilot.Event(ev);event.calendar=$b;event.root=$b;event.external=true;DayPilotCalendar.moving={};DayPilotCalendar.moving.event=event;DayPilotCalendar.moving.helper={};}};ev.cancelBubble=true;}};$b.nav.scrollable.style.display='';};this.findEventDiv=function(e){for(var i=0;i<this.elements.events.length;i++){var $03=this.elements.events[i];if($03.event==e){return $03;}};return null;};this.getProperties=function(x,y){if(!this.cellProperties){return null;};return this.cellProperties[x+"_"+y];};this.getColor=function(x,y){if(this.colors){if(this.dirtyColors){return this.colors[y+this.autoHiddenRows()][x];}else{return this.colors[this.autoHiddenRows()][x];}}else{var $c={};$c.resource=this.columnsBottom[x].Value;$c.start=new DayPilot.Date(this.columnsBottom[x].Start).addTime(y*this.cellDuration).addHours(this.autoHiddenHours());$c.backColor=this.isBusiness($c)?this.cellBackColor:this.cellBackColorNonBusiness;var $1X=this.beforeCellRender($c);if($1X){return $1X.backColor;}else{return this.cellBackColor;}}};this.isBusiness=function($c){if($c.start.dayOfWeek()===0||$c.start.dayOfWeek()===6){return false;};if(this.cellDuration<720){if($c.start.getHours()<this.businessBeginsHour||$c.start.getHours()>=this.businessEndsHour){return false;}else{return true;}};return true;};this.beforeCellRender=function($c){return $c;};this.disposeHeader=function(){var $1x=this.nav.header;if($1x&&$1x.rows){for(var y=0;y<$1x.rows.length;y++){var r=$1x.rows[y];for(var x=0;x<r.cells.length;x++){var c=r.cells[x];c.onclick=null;c.onmousemove=null;c.onmouseout=null;}}};if(!this.fasterDispose)DayPilot.pu($1x);};this.drawHeaderRow=function($12,$1M){var r=($1M)?this.nav.header.insertRow(-1):this.nav.header.rows[$12-1];var $0G=this.columns.getColumns($12);var $1Y=$0G.length;for(var i=0;i<$1Y;i++){var $w=$0G[i];var $1Z=$w.getChildren?true:false;var $c=($1M)?r.insertCell(-1):r.cells[i];$c.data=$w;if($12===$b.headerLevels){$c.style.width=(100.0/$0G.length)+"%";}else{var $20=1;if($1Z){$20=$w.getChildrenCount($b.headerLevels-$12+1);};$c.colSpan=$20;};if($1Z){$c.onclick=this.headerClickDispatch;$c.onmousemove=this.headerMouseMove;$c.onmouseout=this.headerMouseOut;if($w.ToolTip){$c.title=$w.ToolTip;}};$c.style.overflow='hidden';$c.style.padding='0px';$c.style.border='0px none';$c.style.height=(this.headerHeight)+"px";var $03=($1M)?document.createElement("div"):$c.firstChild;if($1M){$03.unselectable='on';$03.style.MozUserSelect='none';$03.style.backgroundColor=$w.BackColor;$03.className=$b.applyCssClass('colheader');$03.style.cursor='default';$03.style.position='relative';$03.style.fontFamily=this.headerFontFamily;$03.style.fontSize=this.headerFontSize;$03.style.color=this.headerFontColor;if($12!==1){$03.style.borderTop='1px solid '+this.borderColor;};if($b.rtl){if(i===$1Y-1){$03.style.borderLeft="1px solid "+$w.BackColor;}else{$03.style.borderLeft="1px solid "+this.borderColor;}}else{if(i===$1Y-1){$a();}else{$03.style.borderRight="1px solid "+this.borderColor;}};$03.style.height=this.headerHeight+"px";var $q=document.createElement("div");$q.style.position='absolute';$q.style.left='0px';$q.style.width='100%';$q.style.padding="2px";$03.style.textAlign='center';$q.unselectable='on';if(this.headerClickHandling!=="Disabled"){$q.style.cursor='pointer';};$03.appendChild($q);$c.appendChild($03);};if($1Z){var $q=$03.firstChild;$q.innerHTML=$w.InnerHTML;}}};this.widthUnit=function(){if(this.width&&this.width.indexOf("px")!=-1){return "Pixel";};return "Percentage";};this.drawHeader=function(){if(!this.showHeader){return;};var $1a=this.nav.header;var $1M=true;var $0G=this.columns.getColumns($b.headerLevels,true);var $1Y=$0G.length;if(this.headerCreated&&$1a&&$1a.rows&&$1a.rows.length>0){$1M=$1a.rows[$1a.rows.length-1].cells.length!==$1Y;}while(this.headerCreated&&$1a&&$1a.rows&&$1a.rows.length>0&&$1M){if(!this.fasterDispose)DayPilot.pu($1a.rows[0]);$1a.deleteRow(0);};this.headerCreated=true;if(!$1M){var $1E=$b.nav.corner;$1E.style.backgroundColor=$b.cornerBackColor;if(!this.fasterDispose)DayPilot.pu($1E.firstChild);$1E.firstChild.innerHTML=$b.cornerHTML?$b.cornerHTML:'';};for(var i=0;i<$b.headerLevels;i++){this.drawHeaderRow(i+1,$1M);};if(!this.showAllDayEvents){return;};var r=($1M)?$1a.insertRow(-1):$1a.rows[$b.headerLevels];var w=100/$1Y;for(var i=0;i<$1Y;i++){var $w=$0G[i];var $c=($1M)?r.insertCell(-1):r.cells[i];$c.data=$w;$c.style.width=w+"%";$c.style.padding='0px';$c.style.border='0px none';$c.style.overflow='hidden';$c.style.lineHeight='1.2';var $03=($1M)?document.createElement("div"):$c.firstChild;if($1M){$03.unselectable='on';$03.style.MozUserSelect='none';$03.style.display='block';$03.style.textAlign='center';$03.style.backgroundColor=$w.BackColor;$03.style.cursor='default';$03.style.borderTop='1px solid '+this.borderColor;$03.className=this.applyCssClass("alldayheader");if($b.rtl){if(i===$1Y-1){$03.style.borderLeft="1px solid "+$w.BackColor;}else{$03.style.borderLeft="1px solid "+this.borderColor;}}else{if(i===$1Y-1){$a();}else{$03.style.borderRight="1px solid "+this.borderColor;}};$03.style.overflow='hidden';var $q=document.createElement("div");$q.style.paddingLeft="2px";$q.style.paddingRight="2px";$q.style.paddingTop="2px";$q.unselectable='on';$03.appendChild($q);$c.appendChild($03);};$03.style.height=this.allDayHeaderHeight+"px";}};this.loadingStart=function(){if(this.loadingLabelVisible){this.nav.loading.innerHTML=this.loadingLabelText;this.nav.loading.style.top=(this.totalHeaderHeight()+5)+"px";this.nav.loading.style.display='';}};this.loadingStop=function($21){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};this.nav.loading.style.display='none';};this.enableScrolling=function(){var $22=this.nav.scroll;if(!this.initScrollPos)return;$22.root=this;$22.onscroll=this.scroll;if($22.scrollTop===0){$22.scrollTop=this.initScrollPos-this.autoHiddenPixels();}else{this.scroll();}};this.callbackError=function($F,$G){alert("Error!\r\nResult: "+$F+"\r\nContext:"+$G);};this.fixScrollHeader=function(){var w=DayPilot.sw(this.nav.scroll);var d=this.nav.cornerRight;if(d&&w>0){d.style.width=(w-1)+'px';}};this.startAutoRefresh=function($23){if($23){this.autoRefreshEnabled=true;};if(!this.autoRefreshEnabled){return;};if(this.autoRefreshCount>=this.autoRefreshMaxCount){return;};this.stopAutoRefresh();var $24=this.autoRefreshInterval;if(!$24||$24<10){throw "The minimum autoRefreshInterval is 10 seconds";};this.autoRefreshTimeout=window.setTimeout(function(){$b.doRefresh();},this.autoRefreshInterval*1000);};this.stopAutoRefresh=function(){if(this.autoRefreshTimeout){window.clearTimeout(this.autoRefreshTimeout);}};this.doRefresh=function(){if(!DayPilotCalendar.resizing&&!DayPilotCalendar.moving&&!DayPilotCalendar.drag&&!DayPilotCalendar.selecting){this.autoRefreshCount++;this.commandCallBack(this.autoRefreshCommand);};if(this.autoRefreshCount<this.autoRefreshMaxCount){this.autoRefreshTimeout=window.setTimeout(function(){$b.doRefresh();},this.autoRefreshInterval*1000);}};this.resize=function(){if($b.heightSpec==="Parent100Pct"){$b.setHeight(parseInt($b.nav.top.clientHeight,10));};$b.updateHeight();$b.updateScrollLabels();};this.registerGlobalHandlers=function(){if(!DayPilotCalendar.globalHandlers){DayPilotCalendar.globalHandlers=true;DayPilot.re(document,'mousemove',DayPilotCalendar.gMouseMove);DayPilot.re(document,'mouseup',DayPilotCalendar.gMouseUp);DayPilot.re(window,'unload',DayPilotCalendar.gUnload);};DayPilot.re(window,'resize',this.resize);};this.loadEvents=function($0R){if(!$0R){$0R=this.events;};this.allDay={};this.allDay.events=[];this.allDay.lines=[];var length=$0R.length;var $p=this.duration(true);this.cache.pixels={};var $25=[];this.scrollLabels=[];this.minStart=10000;this.maxEnd=0;if(!$0R){return;};for(var i=0;i<length;i++){var e=$0R[i];e.Start=new DayPilot.Date(e.Start);e.End=new DayPilot.Date(e.End);};var $26=this.viewType==='Resources';var $27=this.startDate;var $28=this.startDate.addDays(this.days);for(var i=0;i<this.columnsBottom.length;i++){var scroll={};scroll.minEnd=1000000;scroll.maxStart=-1;this.scrollLabels.push(scroll);var $1r=this.columnsBottom[i];$1r.events=[];$1r.lines=[];$1r.blocks=[];var $0k=new DayPilot.Date($1r.Start).addHours(this.visibleStart(true));var $29=$0k.getTime();var $2a=$0k.addTime($p);var $2b=$2a.getTime();if($26){$27=$0k.getDatePart();$28=$2a.getDatePart();};for(var j=0;j<length;j++){if($25[j]){continue;};var e=$0R[j];var $0d=e.Start;var end=e.End;var $2c=$0d.getTime();var $2d=end.getTime();if($2d<$2c){continue;};if(e.AllDay){var $2e=false;if($b.allDayEnd==='Date'){$2e=!($2d<$27.getTime()||$2c>=$28.getTime());}else{$2e=!($2d<=$27.getTime()||$2c>=$28.getTime());};if($26){$2e=$2e&&(e.Resource===$1r.Value||$1r.Value==="*");};if($2e){var ep={};ep.Text=e.Text;ep.Value=e.Value;ep.ToolTip=e.ToolTip?e.ToolTip:e.Text;ep.Start=$0d;ep.End=end;ep.DayIndex=i;ep.AllDay=e.AllDay;ep.PartStart=$27.getTime()<$2c?ep.Start:$27;ep.PartEnd=$28.getTime()>$2d?ep.End:$28;ep.BackgroundColor=e.BackColor?e.BackColor:this.eventBackColor;ep.InnerHTML=e.InnerHTML?e.InnerHTML:e.Text;ep.Tag=e.Tag;ep.BackgroundImage=e.BackgroundImage;ep.BackgroundRepeat=e.BackgroundRepeat;ep.StaticBubbleHTML=e.StaticBubbleHTML;ep.Recurrent=e.Recurrent;ep.RecurrentMasterId=e.RecurrentMasterId;ep.RightClickEnabled=this.rightClickHandling!=='Disabled'&&!e.RightClickDisabled;ep.ClickEnabled=this.eventClickHandling!=='Disabled'&&!e.ClickDisabled;ep.DoubleClickEnabled=this.eventDoubleClickHandling!=='Disabled'&&!e.DoubleClickDisabled;ep.ContextMenu=e.ContextMenu;ep.CssClass=e.CssClass;ep.ColStart=DayPilot.Date.daysDiff(this.startDate.d,ep.PartStart.d);ep.ColWidth=DayPilot.Date.daysSpan(ep.PartStart.d,ep.PartEnd.d)+1;if($26){ep.ColStart=i;ep.ColWidth=1;};this.allDay.events.push(ep);$25[j]=true;if($26&&(ep.PartStart.getTime()!==$2c||ep.PartEnd.getTime()!==$2d)){$25[j]=false;}};continue;};var $2e=false;if($26){$2e=($1r.Value===e.Resource)&&!($2d<=$29||$2c>=$2b);}else{$2e=!($2d<=$29||$2c>=$2b);};if($2e){var ep={};ep.Text=e.Text;ep.Value=e.Value;ep.ToolTip=e.ToolTip?e.ToolTip:e.Text;ep.Start=$0d;ep.End=end;ep.DayIndex=i;ep.AllDay=e.AllDay;ep.PartStart=$29<$2c?ep.Start:$0k;ep.PartEnd=$2b>$2d?ep.End:$2a;ep.BackgroundColor=e.BackColor?e.BackColor:this.eventBackColor;ep.InnerHTML=e.InnerHTML?e.InnerHTML:e.Text;ep.BarColor=e.BarColor?e.BarColor:this.durationBarColor;ep.Tag=e.Tag;ep.BackgroundImage=e.BackgroundImage;ep.BackgroundRepeat=e.BackgroundRepeat;ep.StaticBubbleHTML=e.StaticBubbleHTML;ep.Sort=e.Sort;ep.DurationBarImageUrl=e.DurationBarImageUrl;ep.Header=e.Header;ep.BorderColor=e.BorderColor?e.BorderColor:this.eventBorderColor;ep.FontColor=e.FontColor?e.FontColor:this.eventFontColor;ep.Recurrent=e.Recurrent;ep.RecurrentMasterId=e.RecurrentMasterId;ep.MoveEnabled=this.eventMoveHandling!=='Disabled'&&!e.MoveDisabled;ep.ResizeEnabled=this.eventResizeHandling!=='Disabled'&&!e.ResizeDisabled;ep.RightClickEnabled=this.rightClickHandling!=='Disabled'&&!e.RightClickDisabled;ep.ClickEnabled=this.eventClickHandling!=='Disabled'&&!e.ClickDisabled;ep.DoubleClickEnabled=this.eventDoubleClickHandling!=='Disabled'&&!e.DoubleClickDisabled;ep.DeleteEnabled=this.eventDeleteHandling!=='Disabled'&&!e.DeleteDisabled;ep.ContextMenu=e.ContextMenu;ep.CssClass=e.CssClass;var $2f=this.getPixels(ep.PartStart,$1r.Start);var $2g=this.getPixels(ep.PartEnd,$1r.Start);var top=$2f.top;var $0Y=$2g.top;if(top===$0Y&&($2f.cut||$2g.cut)){continue;};ep.Box=this.useBox($2d-$2c);if(ep.Box){var $2h=$2g.boxBottom;ep.Top=Math.floor(top/this.cellHeight)*this.cellHeight+1;ep.Height=Math.max(Math.ceil($2h/this.cellHeight)*this.cellHeight-ep.Top,this.cellHeight-1)+1;ep.BarTop=Math.max(top-ep.Top-1,0);ep.BarHeight=Math.max($0Y-top-2,1);}else{ep.Top=top+1;ep.Height=Math.max($0Y-top,0);ep.BarTop=0;ep.BarHeight=Math.max($0Y-top-2,1);};var $0d=ep.Top;var end=ep.Top+ep.Height;if($0d>scroll.maxStart){scroll.maxStart=$0d;};if(end<scroll.minEnd){scroll.minEnd=end;};if($0d<this.minStart){this.minStart=$0d;};if(end>this.maxEnd){this.maxEnd=end;};$1r.events.push(ep);if(ep.PartStart.getTime()===$2c&&ep.PartEnd.getTime()===$2d){$25[j]=true;}}}};for(var i=0;i<this.columnsBottom.length;i++){var $1r=this.columnsBottom[i];$1r.events.sort(this.eventComparer);for(var j=0;j<$1r.events.length;j++){var e=$1r.events[j];$1r.putIntoBlock(e);};for(var j=0;j<$1r.blocks.length;j++){var $16=$1r.blocks[j];$16.events.sort(this.eventComparerCustom);for(var k=0;k<$16.events.length;k++){var e=$16.events[k];$16.putIntoLine(e);}}};this.allDay.events.sort(this.eventComparerCustom);this.allDay.putIntoLine=function(ep){var $18=this;for(var i=0;i<this.lines.length;i++){var $19=this.lines[i];if($19.isFree(ep.ColStart,ep.ColWidth)){$19.push(ep);return i;}};var $19=[];$19.isFree=function($0d,$17){var end=$0d+$17-1;var $U=this.length;for(var i=0;i<$U;i++){var e=this[i];if(!(end<e.ColStart||$0d>e.ColStart+e.ColWidth-1)){return false;}};return true;};$19.push(ep);this.lines.push($19);return this.lines.length-1;};for(var i=0;i<this.allDay.events.length;i++){var e=this.allDay.events[i];this.allDay.putIntoLine(e);};var $2i=Math.max(this.allDay.lines.length,1);this.allDayHeaderHeight=$2i*(this.allDayEventHeight+2)+2;};this.eventComparer=function(a,b){if(!a||!b||!a.Start||!b.Start){return 0;};var $2j=a.Start.getTime()-b.Start.getTime();if($2j!==0){return $2j;};var $2k=b.End.getTime()-a.End.getTime();return $2k;};this.eventComparerCustom=function(a,b){if(!a||!b){return 0;};if(!a.Sort||!b.Sort||a.Sort.length===0||b.Sort.length===0){return $b.eventComparer(a,b);};var $F=0;var i=0;while($F===0&&a.Sort[i]&&b.Sort[i]){if(a.Sort[i]===b.Sort[i]){$F=0;}else{$F=$b.stringComparer(a.Sort[i],b.Sort[i],$b.sortDirections[i]);};i++;};return $F;};this.stringComparer=function(a,b,$2l){var $2m=($2l!=="desc");var $2n=$2m?-1:1;var $2o=-$2n;if(!a&&!b){return 0;};if(!b){return $2o;};if(!a){return $2n;};var ar=[];ar[0]=a;ar[1]=b;ar.sort();return a===ar[0]?$2n:$2o;};this.debug=function($21,$2p){if(!this.debuggingEnabled){return;};if(!$b.debugMessages){$b.debugMessages=[];};$b.debugMessages.push($21);if(typeof $2q!=='undefined'){$2q.log($21);}};this.useBox=function($2r){if(this.useEventBoxes==='Always'){return true;};if(this.useEventBoxes==='Never'){return false;};return $2r<this.cellDuration*60*1000;};this.getPixels=function($0s,$0d){if(!$0d)$0d=this.startDate;var $2c=$0d.getTime();var $2s=$0s.getTime();var $2t=this.cache.pixels[$2s+"_"+$2c];if($2t){return $2t;};$2c=$0d.addHours(this.visibleStart(true)).getTime();var $2u=this.cellDuration*60*1000;var $2v=$2s-$2c;var $2w=$2v%$2u;var $2x=$2v-$2w;var $2y=$2x+$2u;if($2w===0){$2y=$2x;};var $F={};$F.cut=false;$F.top=this.ticksToPixels($2v);$F.boxTop=this.ticksToPixels($2x);$F.boxBottom=this.ticksToPixels($2y);this.cache.pixels[$2s+"_"+$2c]=$F;return $F;};this.ticksToPixels=function($2s){return Math.floor((this.cellHeight*$2s)/(1000*60*this.cellDuration));};this.prepareVariables=function(){this.startDate=new DayPilot.Date(this.startDate);this.allDayHeaderHeight=this.allDayEventHeight+4;};this.updateHeaderHeight=function(){if(this.nav.corner){this.nav.corner.style.height=this.totalHeaderHeight()+"px";};if(this.showAllDayEvents){var $2z=this.nav.header.rows[this.nav.header.rows.length-1];for(var i=0;i<$2z.cells.length;i++){var $t=$2z.cells[i];$t.firstChild.style.height=this.allDayHeaderHeight+"px";}}};this.updateHeight=function(){var sh=this.getScrollableHeight();if(this.nav.scroll&&sh>0){this.nav.scroll.style.height=sh+"px";this.scrollHeight=$b.nav.scroll.clientHeight;}};this.setHeight=function($1n){if(this.heightSpec!=="Parent100Pct"){this.heightSpec="Fixed";};this.height=$1n-(this.totalHeaderHeight()+3);this.updateHeight();};this.loadFromServer=function(){return(typeof this.events==='undefined')||!this.events;};this.initShort=function(){this.prepareVariables();this.prepareColumns();this.drawTop();this.drawHeader();this.drawMain();this.fixScrollHeader();this.enableScrolling();this.registerGlobalHandlers();DayPilotCalendar.register(this);this.startAutoRefresh();this.callBack2('Init');};this.Init=function(){var $2A=this.loadFromServer();if($2A){this.initShort();return;};this.prepareVariables();this.prepareColumns();if(this.events){this.loadEvents();};this.drawTop();this.drawHeader();this.drawMain();this.fixScrollHeader();this.enableScrolling();this.registerGlobalHandlers();DayPilotCalendar.register(this);if(this.events){this.updateHeaderHeight();this.drawEvents();this.drawEventsAllDay();};this.resize();if(this.messageHTML){this.message(this.messageHTML,5000);};this.afterRender(null,false);this.startAutoRefresh();};};DayPilotCalendar.Cell=function($0d,end,$t){this.start=$0d;this.end=end;this.column=function(){};};DayPilotCalendar.Column=function($2B,name,$0s){this.value=$2B;this.name=name;this.date=new DayPilot.Date($0s);};DayPilotCalendar.Event=function($f,$b){$f.event=this;var ev=this;this.div=$f;this.root=$b;this.calendar=$b;this.value=function(){return $f.data.Value;};this.id=function(){return $f.data.Value;};this.text=function(){return $f.data.Text;};this.start=function(){return $f.data.Start;};this.end=function(){return $f.data.End;};this.partStart=function(){return $f.data.PartStart;};this.partEnd=function(){return $f.data.PartEnd;};this.recurrent=function(){return $f.data.Recurrent;};this.recurrentMasterId=function(){return $f.data.RecurrentMasterId;};this.column=function(){return this.resource();};this.resource=function(){return this.root.columnsBottom[$f.data.DayIndex].Value;};this.innerHTML=function(){var c=$f.getElementsByTagName("DIV");return c[c.length-1].innerHTML;};this.staticBubbleHTML=function(){return $f.data.StaticBubbleHTML;};this.tag=function($2C){var $2D=$f.data.Tag;if(!$2D){return null;};if(!$2C){return $f.data.Tag;};var $2E=$b.tagFields;var $2F=-1;for(var i=0;i<$2E.length;i++){if($2C===$2E[i])$2F=i;};if($2F===-1){throw "Field name not found.";};return $2D[$2F];};this.movingAllowed=function(){return $f.data.MoveEnabled&&$b.eventMoveHandling!=="Disabled";};this.resizingAllowed=function(){return $f.data.ResizeEnabled&&$b.eventResizeHandling!=="Disabled";};this.clickingAllowed=function(){return $f.data.ClickEnabled&&$b.eventClickHandling!=="Disabled";};this.rightClickingAllowed=function(){return $f.data.RightClickEnabled&&$b.rightClickHandling!=="Disabled";};this.isSelected=function(){return $b.selectedEvent()===this;};this.isAllDay=function(){return $f.data.AllDay;};this.client={};this.client.contextMenu=function($2G){if(typeof $2G==='undefined'){if(ev.oContextMenu){return ev.oContextMenu;};return($f.data.ContextMenu)?eval($f.data.ContextMenu):null;}else{ev.oContextMenu=$2G;}};this.toJSON=function($K){var $0c={};$0c.value=this.value();$0c.text=this.text();$0c.start=this.start();$0c.end=this.end();$0c.resource=this.resource();$0c.isAllDay=this.isAllDay()?true:false;$0c.isSelected=this.isSelected();$0c.recurrentMasterId=this.recurrentMasterId();$0c.tag={};if($b.tagFields){var $2E=$b.tagFields;for(var i=0;i<$2E.length;i++){$0c.tag[$2E[i]]=this.tag($2E[i]);}};return $0c;};$f.onmousemove=function(ev){var $2H=5;var $2I=Math.max($b.durationBarWidth,10);var w=5;var $1a=($b.moveBy==='Top');if(typeof(DayPilotCalendar)==='undefined'){return;};var $1V=DayPilot.mo2(this,ev);if(!$1V){return;};if(DayPilotCalendar.resizing||DayPilotCalendar.moving){return;};var $2J=this.isFirst;var $2K=this.isLast;if(!$1a&&$1V.x<=$2I&&$f.event.movingAllowed()){if($2J){this.style.cursor='move';}else{this.style.cursor='not-allowed';}}else if(!$1a&&$1V.y<=$2H&&$f.event.resizingAllowed()){if($2J){this.style.cursor="n-resize";this.dpBorder='top';}else{this.style.cursor='not-allowed';}}else if($1a&&$1V.y<=$2I&&$f.event.movingAllowed()){this.style.cursor="move";}else if(this.offsetHeight-$1V.y<=$2H&&$f.event.resizingAllowed()){if($2K){this.style.cursor="s-resize";this.dpBorder='bottom';}else{this.style.cursor='not-allowed';}}else if(!DayPilotCalendar.resizing&&!DayPilotCalendar.moving){if($f.event.clickingAllowed())this.style.cursor='pointer';else this.style.cursor='default';};if(typeof(DayPilotBubble)!=='undefined'&&$b.bubble&&$b.eventHoverHandling!=='Disabled'){if(this.style.cursor==='default'||this.style.cursor==='pointer'){$b.bubble.showEvent(this.event);}else{$a();}}};$f.onmousedown=function(ev){ev=ev||window.event;var $0B=ev.which||ev.button;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if((this.style.cursor==='n-resize'||this.style.cursor==='s-resize')&&$0B===1){DayPilotCalendar.resizing=this;DayPilotCalendar.originalMouse=DayPilot.mc(ev);DayPilotCalendar.originalHeight=this.offsetHeight;DayPilotCalendar.originalTop=this.offsetTop;}else if(this.style.cursor==='move'&&$0B===1){DayPilotCalendar.moving=this;DayPilotCalendar.moving.event=this.event;var $2L=DayPilotCalendar.moving.helper={};$2L.oldColumn=$b.columnsBottom[this.data.DayIndex].Value;DayPilotCalendar.originalMouse=DayPilot.mc(ev);DayPilotCalendar.originalTop=this.offsetTop;var $1V=DayPilot.mo2(this,ev);if($1V){DayPilotCalendar.moveOffsetY=$1V.y;}else{DayPilotCalendar.moveOffsetY=0;};document.body.style.cursor='move';}else{};return false;};};DayPilot.CalendarVisible.dragStart=DayPilotCalendar.dragStart;DayPilot.CalendarVisible.Calendar=DayPilotCalendar.Calendar;DayPilot.Calendar=DayPilotCalendar.Calendar;})();


